"use strict";(self.webpackChunktravel_plan=self.webpackChunktravel_plan||[]).push([[866],{74650:function(yn,we,b){b.r(we),b.d(we,{default:function(){return fn}});var je=b(48305),B=b.n(je),R=b(75271),Ce=b(56564),le=b(51555),F=b(3988),Ie=b(63092),ke=b(23297),Te=b(15558),de=b.n(Te),Le=b(26068),j=b.n(Le),he=b(26729),$=b(28375),ie=b(99546),ue=b(5574),H=b(92974),ze=b(90228),C=b.n(ze),Ze=b(87999),E=b.n(Ze),Pe=b(34329),Ne=b(79306),We=b(99247),Oe=b(64533),$e="ac47d45ec5e5e8ddf58b95e9e99ede62",Ke=function(){var y=E()(C()().mark(function n(t,a){var e,l;return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Oe.Z.get("https://restapi.amap.com/v5/place/text",{params:{key:$e,keywords:t,city:a,output:"json"}});case 3:if(e=i.sent,!(e.data&&e.data.status==="1"&&e.data.pois)){i.next=9;break}return l=e.data.pois.map(function(r){var c=r.location.split(","),o=B()(c,2),d=o[0],h=o[1];return{id:r.id,name:r.name,address:r.address,location:{lat:parseFloat(h),lng:parseFloat(d)},cityname:r.cityname,adname:r.adname}}),i.abrupt("return",l);case 9:return console.error("\u9AD8\u5FB7 API \u8FD4\u56DE\u9519\u8BEF:",e.data.info),i.abrupt("return",[]);case 11:i.next=17;break;case 13:return i.prev=13,i.t0=i.catch(0),console.error("\u641C\u7D22\u5730\u70B9\u8BF7\u6C42\u5931\u8D25:",i.t0),i.abrupt("return",[]);case 17:case"end":return i.stop()}},n,null,[[0,13]])}));return function(t,a){return y.apply(this,arguments)}}(),Ve=b(25298),q=b.n(Ve),He=b(17069),_=b.n(He),Ue=b(31759),Je=b.n(Ue),Ge=function(){function y(){q()(this,y)}return _()(y,[{key:"calculateSingleSegment",value:function(){var n=E()(C()().mark(function a(e,l,u,i){var r;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,o.t0=u,o.next=o.t0==="driving"?4:o.t0==="walking"?8:o.t0==="riding"?12:o.t0==="transfer"?16:20;break;case 4:return o.next=6,this.getDrivingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 6:return r=o.sent,o.abrupt("break",23);case 8:return o.next=10,this.getWalkingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 10:return r=o.sent,o.abrupt("break",23);case 12:return o.next=14,this.getRidingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 14:return r=o.sent,o.abrupt("break",23);case 16:return o.next=18,this.getTransferRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat],"\u676D\u5DDE");case 18:return r=o.sent,o.abrupt("break",23);case 20:return o.next=22,this.getDrivingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 22:r=o.sent;case 23:return o.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:l.name,position:[l.lng,l.lat]},distance:r.distance,duration:r.duration,mode:u,polyline:r.polyline||[],success:r.success,error:r.error});case 26:return o.prev=26,o.t1=o.catch(0),console.error("\u8DEF\u6BB5\u8BA1\u7B97\u5931\u8D25:",o.t1),o.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:l.name,position:[l.lng,l.lat]},distance:0,duration:0,mode:u,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 30:case"end":return o.stop()}},a,this,[[0,26]])}));function t(a,e,l,u){return n.apply(this,arguments)}return t}()},{key:"getDrivingRouteWithPolyline",value:function(){var n=E()(C()().mark(function a(e,l){var u=this;return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,J();case 3:r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(Y("driving")){r.next=10;break}return r.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return r.abrupt("return",new Promise(function(c){var o=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});o.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var p=h.routes[0],f=u.extractPolylineFromRoute(p);c({mode:"driving",distance:p.distance,duration:p.time,success:!0,polyline:f})}else c({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return r.stop()}},a,null,[[0,5]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getWalkingRouteWithPolyline",value:function(){var n=E()(C()().mark(function a(e,l){var u=this;return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,J();case 3:r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(Y("walking")){r.next=10;break}return r.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return r.abrupt("return",new Promise(function(c){var o=new window.AMap.Walking({map:null,autoFitView:!1});o.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var p=h.routes[0],f=u.extractPolylineFromRoute(p);c({mode:"walking",distance:p.distance,duration:p.time,success:!0,polyline:f})}else c({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return r.stop()}},a,null,[[0,5]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getRidingRouteWithPolyline",value:function(){var n=E()(C()().mark(function a(e,l){var u=this;return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,J();case 3:r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(Y("riding")){r.next=10;break}return r.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return r.abrupt("return",new Promise(function(c){var o=new window.AMap.Riding({map:null,autoFitView:!1});o.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var p=h.routes[0],f=u.extractPolylineFromRoute(p);c({mode:"riding",distance:p.distance,duration:p.time||p.duration,success:!0,polyline:f})}else c({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return r.stop()}},a,null,[[0,5]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getTransferRouteWithPolyline",value:function(){var n=E()(C()().mark(function a(e,l){var u=this,i,r=arguments;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=r.length>2&&r[2]!==void 0?r[2]:"\u676D\u5DDE",o.prev=1,o.next=4,J();case 4:o.next=9;break;case 6:return o.prev=6,o.t0=o.catch(1),o.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 9:if(Y("transfer")){o.next=11;break}return o.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 11:return o.abrupt("return",new Promise(function(d){var h=new window.AMap.Transfer({map:null,city:i,autoFitView:!1});h.search(e,l,function(p,f){if(p==="complete"&&f.plans&&f.plans.length>0){var g=f.plans[0],S=u.extractPolylineFromRoute(g);d({mode:"transfer",distance:g.distance,duration:g.time,success:!0,polyline:S})}else d({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 12:case"end":return o.stop()}},a,null,[[1,6]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"extractPolylineFromRoute",value:function(t){var a=this,e=[];if(t.rides&&Array.isArray(t.rides))return t.rides.forEach(function(u){u.path&&Array.isArray(u.path)&&u.path.forEach(function(i){var r=a.extractPosition(i);r&&e.push(r)})}),e;if(t.steps&&Array.isArray(t.steps))t.steps.forEach(function(u,i){if(u.polyline){var r=a.parsePolyline(u.polyline);e.push.apply(e,de()(r))}else if(u.path&&Array.isArray(u.path))u.path.forEach(function(d,h){if(d&&Je()(d)==="object"){var p,f;if(d.lng!==void 0&&d.lat!==void 0)p=d.lng,f=d.lat;else if(d.longitude!==void 0&&d.latitude!==void 0)p=d.longitude,f=d.latitude;else if(d.x!==void 0&&d.y!==void 0)p=d.x,f=d.y;else if(Array.isArray(d)&&d.length>=2)p=d[0],f=d[1];else if(d.getPosition&&typeof d.getPosition=="function"){var g=d.getPosition();p=g.getLng(),f=g.getLat()}p!==void 0&&f!==void 0&&!isNaN(p)&&!isNaN(f)&&e.push([p,f])}});else{if(u.start_location){var c=a.extractPosition(u.start_location);c&&e.push(c)}if(u.end_location){var o=a.extractPosition(u.end_location);o&&e.push(o)}}});else if(t.path&&Array.isArray(t.path))t.path.forEach(function(u,i){var r=a.extractPosition(u);r&&e.push(r)});else if(t.polyline){var l=this.parsePolyline(t.polyline);e.push.apply(e,de()(l))}return e}},{key:"extractPosition",value:function(t){if(!t)return null;var a,e;if(t.lng!==void 0&&t.lat!==void 0)a=t.lng,e=t.lat;else if(t.longitude!==void 0&&t.latitude!==void 0)a=t.longitude,e=t.latitude;else if(t.x!==void 0&&t.y!==void 0)a=t.x,e=t.y;else if(Array.isArray(t)&&t.length>=2)a=t[0],e=t[1];else if(t.getPosition&&typeof t.getPosition=="function"){var l=t.getPosition();a=l.getLng(),e=l.getLat()}else t.getLng&&typeof t.getLng=="function"&&(a=t.getLng(),e=t.getLat());return a!==void 0&&e!==void 0&&!isNaN(a)&&!isNaN(e)?[a,e]:null}},{key:"parsePolyline",value:function(t){if(!t||typeof t!="string")return[];try{var a;t.includes(";")?a=t.split(";"):t.includes("|")?a=t.split("|"):t.includes(" ")?a=t.split(" "):a=[t];for(var e=[],l=0;l<a.length;l++){var u=a[l].trim();if(u){var i=u.split(",");if(i.length>=2){var r=parseFloat(i[0]),c=parseFloat(i[1]);!isNaN(r)&&!isNaN(c)&&r>=-180&&r<=180&&c>=-90&&c<=90&&e.push([r,c])}}}return e}catch(o){return[]}}}]),y}(),Ye=new Ge,Xe=function(){var y=E()(C()().mark(function n(t,a,e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Ye.calculateSingleSegment(t,a,e,l));case 1:case"end":return i.stop()}},n)}));return function(t,a,e,l){return y.apply(this,arguments)}}(),Qe=function(){function y(){q()(this,y)}return _()(y,[{key:"getDrivingRoute",value:function(){var n=E()(C()().mark(function a(e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,J();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(r){var c=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(o,d){if(o==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];r({mode:"driving",distance:h.distance,duration:h.time,success:!0})}else r({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getWalkingRoute",value:function(){var n=E()(C()().mark(function a(e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,J();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(r){var c=new window.AMap.Walking({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(o,d){if(o==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];r({mode:"walking",distance:h.distance,duration:h.time,success:!0})}else r({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getRidingRoute",value:function(){var n=E()(C()().mark(function a(e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,J();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(r){var c=new window.AMap.Riding({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(o,d){if(o==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];r({mode:"riding",distance:h.distance,duration:h.time,success:!0})}else r({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getTransitRoute",value:function(){var n=E()(C()().mark(function a(e,l){var u,i=arguments;return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u=i.length>2&&i[2]!==void 0?i[2]:"\u676D\u5DDE",c.prev=1,c.next=4,J();case 4:c.next=9;break;case 6:return c.prev=6,c.t0=c.catch(1),c.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 9:return c.abrupt("return",new Promise(function(o){var d=new window.AMap.Transfer({map:null,city:u==="\u676D\u5DDE"?"\u5317\u4EAC":u,autoFitView:!1});d.search(e,l,function(h,p){if(h==="complete"&&p.plans&&p.plans.length>0){var f=p.plans[0];o({mode:"transfer",distance:f.distance,duration:f.time,success:!0})}else o({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 10:case"end":return c.stop()}},a,null,[[1,6]])}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"getAllRoutes",value:function(){var n=E()(C()().mark(function a(e,l){var u,i,r=arguments;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return u=r.length>2&&r[2]!==void 0?r[2]:"\u676D\u5DDE",o.next=3,Promise.all([this.getDrivingRoute(e,l),this.getWalkingRoute(e,l),this.getRidingRoute(e,l),this.getTransitRoute(e,l,u)]);case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}},a,this)}));function t(a,e){return n.apply(this,arguments)}return t}()},{key:"calculateCompleteRouteWithModes",value:function(){var n=E()(C()().mark(function a(e){var l,u,i,r,c,o,d,h,p;return C()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(e.length<2)){g.next=2;break}return g.abrupt("return",{segments:[],totalDistance:0,totalDuration:0,mode:"mixed",success:!1});case 2:l=[],u=0,i=0,r=0;case 6:if(!(r<e.length-1)){g.next=27;break}return c=e[r],o=e[r+1],d=c.mode||"driving",g.prev=10,console.log("\u8BA1\u7B97\u8DEF\u6BB5 ".concat(r+1,":"),c.name,"\u2192",o.name,"(".concat(d,")")),g.next=14,Xe(c,o,d,"segment-".concat(r));case 14:h=g.sent,console.log("\u8DEF\u6BB5 ".concat(r+1," \u8BA1\u7B97\u7ED3\u679C:"),h),l.push(h),h.success&&(u+=h.distance,i+=h.duration),g.next=24;break;case 20:g.prev=20,g.t0=g.catch(10),console.error("\u8DEF\u6BB5 ".concat(c.name," \u2192 ").concat(o.name," \u8BA1\u7B97\u5931\u8D25:"),g.t0),l.push({id:"segment-".concat(r),startPoint:{name:c.name,position:[c.lng,c.lat]},endPoint:{name:o.name,position:[o.lng,o.lat]},distance:0,duration:0,mode:d,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 24:r++,g.next=6;break;case 27:return p={segments:l,totalDistance:u,totalDuration:i,mode:"mixed",success:l.some(function(S){return S.success})},console.log("\u5B8C\u6574\u8DEF\u7EBF\u8BA1\u7B97\u7ED3\u679C:",p),g.abrupt("return",p);case 30:case"end":return g.stop()}},a,null,[[10,20]])}));function t(a){return n.apply(this,arguments)}return t}()}]),y}(),qe=b(82092),U=b.n(qe),ve=function(){function y(){q()(this,y),U()(this,"pluginsLoaded",!1),U()(this,"availablePlugins",new Set)}return _()(y,[{key:"loadPlugins",value:function(){var n=E()(C()().mark(function a(){var e=this;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.pluginsLoaded){u.next=2;break}return u.abrupt("return");case 2:return u.abrupt("return",new Promise(function(i,r){if(!window.AMap){r(new Error("AMap\u672A\u52A0\u8F7D"));return}var c=["AMap.Driving","AMap.Walking","AMap.Transfer","AMap.Riding"];window.AMap.plugin(c,function(){var o={"AMap.Driving":"driving","AMap.Walking":"walking","AMap.Transfer":"transfer","AMap.Riding":"riding"};c.forEach(function(d){var h=d.replace("AMap.","");if(window.AMap[h]){var p=o[d];p&&e.availablePlugins.add(p)}}),e.pluginsLoaded=!0,console.log("\u5DF2\u52A0\u8F7D\u7684\u63D2\u4EF6:",Array.from(e.availablePlugins)),i(void 0)})}));case 3:case"end":return u.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"ensurePluginsLoaded",value:function(){var n=E()(C()().mark(function a(){return C()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.pluginsLoaded){l.next=2;break}return l.abrupt("return");case 2:return l.next=4,this.loadPlugins();case 4:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"isPluginAvailable",value:function(t){return this.availablePlugins.has(t.toLowerCase())}},{key:"getAvailablePlugins",value:function(){return Array.from(this.availablePlugins)}},{key:"reset",value:function(){this.pluginsLoaded=!1,this.availablePlugins.clear()}}],[{key:"getInstance",value:function(){return y.instance||(y.instance=new y),y.instance}}]),y}();U()(ve,"instance",void 0);var J=function(){var y=E()(C()().mark(function n(){var t;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=ve.getInstance(),e.next=3,t.ensurePluginsLoaded();case 3:case"end":return e.stop()}},n)}));return function(){return y.apply(this,arguments)}}(),Y=function(n){var t=ve.getInstance();return t.isPluginAvailable(n)},W={driving:"\u9A7E\u8F66",walking:"\u6B65\u884C",riding:"\u9A91\u884C",transfer:"\u516C\u4EA4",mixed:"\u6DF7\u5408"},O={driving:"#1890ff",walking:"#52c41a",riding:"#faad14",transfer:"#f759ab",mixed:"#13c2c2"},_e=function(){function y(n){q()(this,y),U()(this,"map",void 0),U()(this,"currentRouteInstance",null),U()(this,"segmentInstances",[]),U()(this,"segmentOverlays",[]),this.map=n}return _()(y,[{key:"drawDrivingRoute",value:function(t,a){var e=this;return new Promise(function(l){if(!Y("driving")){l(!1);return}e.currentRouteInstance=new window.AMap.Driving({map:e.map,showTraffic:!1,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(t,a,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawWalkingRoute",value:function(t,a){var e=this;return new Promise(function(l){if(!Y("walking")){l(!1);return}e.currentRouteInstance=new window.AMap.Walking({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(t,a,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawRidingRoute",value:function(t,a){var e=this;return new Promise(function(l){if(!Y("riding")){l(!1);return}e.currentRouteInstance=new window.AMap.Riding({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(t,a,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawTransitRoute",value:function(t,a){var e=this;return new Promise(function(l){if(!Y("transfer")){l(!1);return}e.currentRouteInstance=new window.AMap.Transfer({map:e.map,city:"\u676D\u5DDE",autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(t,a,function(u,i){u==="complete"&&i.plans&&i.plans.length>0?(console.log("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawRoute",value:function(){var n=E()(C()().mark(function a(e,l,u){return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,J(),this.clearAllRoutes(),r.t0=u,r.next=r.t0==="driving"?6:r.t0==="walking"?7:r.t0==="riding"?8:r.t0==="transfer"?9:10;break;case 6:return r.abrupt("return",this.drawDrivingRoute(e,l));case 7:return r.abrupt("return",this.drawWalkingRoute(e,l));case 8:return r.abrupt("return",this.drawRidingRoute(e,l));case 9:return r.abrupt("return",this.drawTransitRoute(e,l));case 10:return r.abrupt("return",!1);case 11:r.next=17;break;case 13:return r.prev=13,r.t1=r.catch(0),console.error("\u7ED8\u5236\u8DEF\u7EBF\u5931\u8D25:",r.t1),r.abrupt("return",!1);case 17:case"end":return r.stop()}},a,this,[[0,13]])}));function t(a,e,l){return n.apply(this,arguments)}return t}()},{key:"clearAllRoutes",value:function(){var t=this;this.currentRouteInstance&&(this.currentRouteInstance.clear(),this.currentRouteInstance=null),this.segmentInstances.forEach(function(e){e&&e.clear&&e.clear()}),this.segmentInstances=[],this.segmentOverlays.forEach(function(e){e&&t.map.remove(e)}),this.segmentOverlays=[];var a=this.map.getAllOverlays("polyline");a.forEach(function(e){t.map.remove(e)})}},{key:"drawCompleteRoute",value:function(t){var a=this;if(console.log("\u5F00\u59CB\u7ED8\u5236\u5B8C\u6574\u8DEF\u7EBF:",t),this.clearAllRoutes(),!t.success||t.segments.length===0){console.log("\u6CA1\u6709\u6210\u529F\u7684\u8DEF\u7EBF\u6BB5\u53EF\u7ED8\u5236");return}var e=[];t.segments.forEach(function(l,u){if(l.success&&l.polyline&&l.polyline.length>1){console.log("\u7ED8\u5236\u8DEF\u6BB5 ".concat(u+1,":"),l.startPoint.name,"\u2192",l.endPoint.name,"polyline\u70B9\u6570:",l.polyline.length);var i=new window.AMap.Polyline({path:l.polyline,strokeColor:O[l.mode]||"#1890ff",strokeWeight:6,strokeOpacity:.8,strokeStyle:"solid",showDir:!0,extData:{segmentId:l.id,segmentIndex:u}});a.map.add(i),a.segmentOverlays.push(i),e.push(i);var r=new window.AMap.Marker({position:l.startPoint.position,content:'<div style="background: '.concat(O[l.mode],'; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">').concat(u===0?"\u8D77":u+1,"</div>"),title:l.startPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});if(a.map.add(r),a.segmentOverlays.push(r),e.push(r),u===t.segments.length-1){var c=new window.AMap.Marker({position:l.endPoint.position,content:'<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">\u7EC8</div>',title:l.endPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});a.map.add(c),a.segmentOverlays.push(c),e.push(c)}if(l.polyline.length>2){var o=Math.floor(l.polyline.length/2),d=l.polyline[o],h=new window.AMap.Marker({position:d,content:'<div style="background: '.concat(O[l.mode],'; color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; border: 1px solid white; opacity: 0.9;">').concat(a.getModeIcon(l.mode),"</div>"),anchor:"center",offset:new window.AMap.Pixel(0,-10),zIndex:200});a.map.add(h),a.segmentOverlays.push(h),e.push(h)}}else console.log("\u8DF3\u8FC7\u5931\u8D25\u7684\u8DEF\u6BB5 ".concat(u+1,":"),l.error)}),e.length>0&&(console.log("\u8C03\u6574\u5730\u56FE\u89C6\u91CE\uFF0C\u8986\u76D6\u7269\u6570\u91CF:",e.length),this.map.setFitView(e,!1,[50,50,50,50])),console.log("\u5B8C\u6574\u8DEF\u7EBF\u7ED8\u5236\u5B8C\u6210\uFF0C\u603B\u8986\u76D6\u7269\u6570\u91CF:",this.segmentOverlays.length)}},{key:"getModeIcon",value:function(t){var a={driving:"\u{1F697}",walking:"\u{1F6B6}",riding:"\u{1F6B4}",transfer:"\u{1F68C}"};return a[t]||"\u25CF"}},{key:"highlightSegment",value:function(t){console.log("\u9AD8\u4EAE\u8DEF\u6BB5:",t),this.segmentOverlays.forEach(function(a){if(a.CLASS_NAME==="AMap.Polyline"||a.getPath){var e=a.getExtData();e&&e.segmentId===t?a.setOptions({strokeWeight:10,strokeOpacity:1,zIndex:100}):a.setOptions({strokeWeight:4,strokeOpacity:.4,zIndex:1})}})}},{key:"resetSegmentHighlight",value:function(){console.log("\u91CD\u7F6E\u8DEF\u6BB5\u9AD8\u4EAE"),this.segmentOverlays.forEach(function(t){(t.CLASS_NAME==="AMap.Polyline"||t.getPath)&&t.setOptions({strokeWeight:6,strokeOpacity:.8,zIndex:10})})}}]),y}(),ea=function(){function y(n){q()(this,y),U()(this,"calculationService",void 0),U()(this,"drawingService",void 0),this.calculationService=new Qe,this.drawingService=new _e(n)}return _()(y,[{key:"getAllRoutes",value:function(){var n=E()(C()().mark(function a(e,l,u){return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.calculationService.getAllRoutes(e,l,u));case 1:case"end":return r.stop()}},a,this)}));function t(a,e,l){return n.apply(this,arguments)}return t}()},{key:"calculateCompleteRouteWithModes",value:function(){var n=E()(C()().mark(function a(e){return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.calculationService.calculateCompleteRouteWithModes(e));case 1:case"end":return u.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"drawRoute",value:function(){var n=E()(C()().mark(function a(e,l,u){return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.drawingService.drawRoute(e,l,u));case 1:case"end":return r.stop()}},a,this)}));function t(a,e,l){return n.apply(this,arguments)}return t}()},{key:"drawCompleteRoute",value:function(t){this.drawingService.drawCompleteRoute(t)}},{key:"clearAllRoutes",value:function(){this.drawingService.clearAllRoutes()}},{key:"highlightSegment",value:function(t){this.drawingService.highlightSegment(t)}},{key:"resetSegmentHighlight",value:function(){this.drawingService.resetSegmentHighlight()}}]),y}(),s=b(52676),aa=function(n){var t=n.value,a=t===void 0?"":t,e=n.onChange,l=n.onPlaceSelected,u=n.placeholder,i=u===void 0?"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22":u,r=n.city,c=r===void 0?"":r,o=(0,R.useState)(a),d=B()(o,2),h=d[0],p=d[1],f=(0,R.useState)([]),g=B()(f,2),S=g[0],k=g[1],w=(0,R.useState)(null),P=B()(w,2),v=P[0],A=P[1],x=(0,R.useState)(!1),M=B()(x,2),D=M[0],L=M[1],N=(0,R.useRef)(null);console.log("AMAP_KEY:",{NODE_ENV:"production",UMI_APP_AMAP_SECRET_KEY:"3e3153b7d6dec0cb487d2afde4795453",UMI_APP_AMAP_WEB_SERVICE_KEY:"ac47d45ec5e5e8ddf58b95e9e99ede62",UMI_APP_AMAP_JS_KEY:"c235c1e78c16464f41d866fe4c811c58",PUBLIC_PATH:"/TravelPlan/"}),(0,R.useEffect)(function(){p(a)},[a]);var m=function(X,re){var G=re.place;A(G),p(G.name),e==null||e(G.name),l(G)},I=function(){A(null),p(""),e==null||e(""),l(null)},be=function(X){if(p(X),e==null||e(X),!X.trim()){k([]);return}N.current&&window.clearTimeout(N.current),L(!0),N.current=window.setTimeout(E()(C()().mark(function re(){var G,ce;return C()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,Ke(X,c);case 2:G=Z.sent,ce=G.map(function(T){return{value:T.name,label:T.name,address:T.address,place:T}}),k(ce),L(!1);case 6:case"end":return Z.stop()}},re)})),300)};return(0,s.jsx)("div",{style:{width:"100%"},children:(0,s.jsxs)(Pe.Z,{allowClear:{clearIcon:(0,s.jsx)(We.Z,{})},value:h,options:S,onSelect:m,onSearch:be,onClear:I,placeholder:i,notFoundContent:D?"\u641C\u7D22\u4E2D...":"\u65E0\u5339\u914D\u7ED3\u679C",style:{width:"100%"},children:[S.map(function(K){return(0,s.jsx)(Pe.Z.Option,{value:K.value,"data-place":K.place,children:(0,s.jsxs)("div",{className:"search-option",children:[(0,s.jsx)("div",{style:{fontWeight:"bold"},children:K.label}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#999"},children:K.address})]})},K.value)}),v&&(0,s.jsx)(Ne.Z,{color:"blue",closable:!0,onClose:I,style:{marginTop:8},children:v.name})]})})},na=aa,ta=b(41448),ra=[{value:"zhejiang",label:"\u6D59\u6C5F",children:[{value:"hangzhou",label:"\u676D\u5DDE"},{value:"ningbo",label:"\u5B81\u6CE2"},{value:"wenzhou",label:"\u6E29\u5DDE"},{value:"shaoxing",label:"\u7ECD\u5174"},{value:"huzhou",label:"\u6E56\u5DDE"},{value:"jiaxing",label:"\u5609\u5174"},{value:"zhoushan",label:"\u821F\u5C71"},{value:"quzhou",label:"\u8862\u5DDE"},{value:"taizhou",label:"\u53F0\u5DDE"},{value:"lishui",label:"\u4E3D\u6C34"}]},{value:"jiangsu",label:"\u6C5F\u82CF",children:[{value:"nanjing",label:"\u5357\u4EAC"},{value:"suzhou",label:"\u82CF\u5DDE"},{value:"wuxi",label:"\u65E0\u9521"},{value:"changzhou",label:"\u5E38\u5DDE"},{value:"zhenjiang",label:"\u9547\u6C5F"},{value:"nantong",label:"\u5357\u901A"},{value:"yangzhou",label:"\u626C\u5DDE"},{value:"taizhou",label:"\u6CF0\u5DDE"},{value:"xuzhou",label:"\u5F90\u5DDE"},{value:"huai an",label:"\u6DEE\u5B89"},{value:"yancheng",label:"\u76D0\u57CE"},{value:"lianyungang",label:"\u8FDE\u4E91\u6E2F"},{value:"suqian",label:"\u5BBF\u8FC1"}]},{value:"beijing",label:"\u5317\u4EAC",children:[{value:"beijing",label:"\u5317\u4EAC"}]},{value:"shanghai",label:"\u4E0A\u6D77",children:[{value:"shanghai",label:"\u4E0A\u6D77"}]},{value:"guangdong",label:"\u5E7F\u4E1C",children:[{value:"guangzhou",label:"\u5E7F\u5DDE"},{value:"shenzhen",label:"\u6DF1\u5733"},{value:"zhuhai",label:"\u73E0\u6D77"},{value:"shantou",label:"\u6C55\u5934"},{value:"foshan",label:"\u4F5B\u5C71"},{value:"dongguan",label:"\u4E1C\u839E"},{value:"zhongshan",label:"\u4E2D\u5C71"},{value:"jiangmen",label:"\u6C5F\u95E8"},{value:"huizhou",label:"\u60E0\u5DDE"},{value:"maoming",label:"\u8302\u540D"},{value:"zhanjiang",label:"\u6E5B\u6C5F"},{value:"meizhou",label:"\u6885\u5DDE"},{value:"qingyuan",label:"\u6E05\u8FDC"},{value:"shaoguan",label:"\u97F6\u5173"},{value:"yunfu",label:"\u4E91\u6D6E"},{value:"chaozhou",label:"\u6F6E\u5DDE"},{value:"jieyang",label:"\u63ED\u9633"},{value:"heyuan",label:"\u6CB3\u6E90"}]},{value:"sichuan",label:"\u56DB\u5DDD",children:[{value:"chengdu",label:"\u6210\u90FD"},{value:"mianyang",label:"\u7EF5\u9633"},{value:"deyang",label:"\u5FB7\u9633"},{value:"nanchong",label:"\u5357\u5145"},{value:"ziyang",label:"\u8D44\u9633"},{value:"zigong",label:"\u81EA\u8D21"},{value:"panzhihua",label:"\u6500\u679D\u82B1"},{value:"luzhou",label:"\u6CF8\u5DDE"},{value:"dazhou",label:"\u8FBE\u5DDE"},{value:"guangyuan",label:"\u5E7F\u5143"},{value:"yibin",label:"\u5B9C\u5BBE"},{value:"neijiang",label:"\u5185\u6C5F"},{value:"leshan",label:"\u4E50\u5C71"},{value:"bazhong",label:"\u5DF4\u4E2D"},{value:"yaan",label:"\u96C5\u5B89"},{value:"ganzi",label:"\u7518\u5B5C"},{value:"liangshan",label:"\u51C9\u5C71"},{value:"abazhou",label:"\u963F\u575D"}]},{value:"yunnan",label:"\u4E91\u5357",children:[{value:"kunming",label:"\u6606\u660E"},{value:"dali",label:"\u5927\u7406"},{value:"lijiang",label:"\u4E3D\u6C5F"},{value:"xishuangbanna",label:"\u897F\u53CC\u7248\u7EB3"},{value:"baoshan",label:"\u4FDD\u5C71"},{value:"chuxiong",label:"\u695A\u96C4"},{value:"dehong",label:"\u5FB7\u5B8F"},{value:"nujiang",label:"\u6012\u6C5F"},{value:"diqing",label:"\u8FEA\u5E86"},{value:"zhaotong",label:"\u662D\u901A"},{value:"qujing",label:"\u66F2\u9756"},{value:"yuxi",label:"\u7389\u6EAA"},{value:"honghe",label:"\u7EA2\u6CB3"},{value:"wenchuan",label:"\u6587\u5C71"},{value:"puer",label:"\u666E\u6D31"},{value:"linfen",label:"\u4E34\u6CA7"}]},{value:"hainan",label:"\u6D77\u5357",children:[{value:"haikou",label:"\u6D77\u53E3"},{value:"sanya",label:"\u4E09\u4E9A"},{value:"danzhou",label:"\u510B\u5DDE"},{value:"wuzhishan",label:"\u4E94\u6307\u5C71"},{value:"qionghai",label:"\u743C\u6D77"},{value:"wanning",label:"\u4E07\u5B81"},{value:"wenchang",label:"\u6587\u660C"},{value:"dongfang",label:"\u4E1C\u65B9"}]},{value:"hunan",label:"\u6E56\u5357",children:[{value:"changsha",label:"\u957F\u6C99"},{value:"zhuzhou",label:"\u682A\u6D32"},{value:"xiangtan",label:"\u6E58\u6F6D"},{value:"hengyang",label:"\u8861\u9633"},{value:"shaoyang",label:"\u90B5\u9633"},{value:"yueyang",label:"\u5CB3\u9633"},{value:"changde",label:"\u5E38\u5FB7"},{value:"zhangjiajie",label:"\u5F20\u5BB6\u754C"},{value:"yiyang",label:"\u76CA\u9633"},{value:"chenzhou",label:"\u90F4\u5DDE"},{value:"yongzhou",label:"\u6C38\u5DDE"},{value:"huaihua",label:"\u6000\u5316"},{value:"loudi",label:"\u5A04\u5E95"},{value:"xiangxi",label:"\u6E58\u897F"}]},{value:"hubei",label:"\u6E56\u5317",children:[{value:"wuhan",label:"\u6B66\u6C49"},{value:"huangshi",label:"\u9EC4\u77F3"},{value:"shiyan",label:"\u5341\u5830"},{value:"yichang",label:"\u5B9C\u660C"},{value:"xiangyang",label:"\u8944\u9633"},{value:"ezhou",label:"\u9102\u5DDE"},{value:"jingmen",label:"\u8346\u95E8"},{value:"xiaogan",label:"\u5B5D\u611F"},{value:"jingzhou",label:"\u8346\u5DDE"},{value:"huanggang",label:"\u9EC4\u5188"},{value:"xianning",label:"\u54B8\u5B81"},{value:"suizhou",label:"\u968F\u5DDE"},{value:"enshi",label:"\u6069\u65BD"}]},{value:"shandong",label:"\u5C71\u4E1C",children:[{value:"jinan",label:"\u6D4E\u5357"},{value:"qingdao",label:"\u9752\u5C9B"},{value:"zibo",label:"\u6DC4\u535A"},{value:"zaozhuang",label:"\u67A3\u5E84"},{value:"dongying",label:"\u4E1C\u8425"},{value:"yantai",label:"\u70DF\u53F0"},{value:"weifang",label:"\u6F4D\u574A"},{value:"jining",label:"\u6D4E\u5B81"},{value:"taian",label:"\u6CF0\u5B89"},{value:"weihai",label:"\u5A01\u6D77"},{value:"rizhao",label:"\u65E5\u7167"},{value:"laiwu",label:"\u83B1\u829C"},{value:"linyi",label:"\u4E34\u6C82"},{value:"dezhou",label:"\u5FB7\u5DDE"},{value:"liaocheng",label:"\u804A\u57CE"},{value:"binzhou",label:"\u6EE8\u5DDE"},{value:"heze",label:"\u83CF\u6CFD"}]}],Re={\u676D\u5DDE:[120.153576,30.287459],\u5B81\u6CE2:[121.549792,29.870244],\u6E29\u5DDE:[120.699374,27.994207],\u7ECD\u5174:[120.580045,30.023551],\u6E56\u5DDE:[120.097547,30.872655],\u5609\u5174:[120.756608,30.750483],\u821F\u5C71:[122.207217,30.025551],\u8862\u5DDE:[118.876444,28.946588],\u53F0\u5DDE:[121.420711,28.656387],\u4E3D\u6C34:[119.921033,28.451379],\u5357\u4EAC:[118.767413,32.041544],\u82CF\u5DDE:[120.585316,31.29888],\u65E0\u9521:[120.299393,31.573885],\u5E38\u5DDE:[119.955045,31.795574],\u9547\u6C5F:[119.452783,32.204402],\u5357\u901A:[120.864688,32.016175],\u626C\u5DDE:[119.421009,32.393152],\u6CF0\u5DDE:[119.915173,32.484882],\u5F90\u5DDE:[117.184811,34.261792],\u6DEE\u5B89:[119.015305,33.581511],\u76D0\u57CE:[120.139998,33.377631],\u8FDE\u4E91\u6E2F:[119.221617,34.576476],\u5BBF\u8FC1:[118.276837,33.939688],\u5317\u4EAC:[116.397428,39.90923],\u4E0A\u6D77:[121.473701,31.230416],\u5E7F\u5DDE:[113.280637,23.125178],\u6DF1\u5733:[114.085947,22.547],\u73E0\u6D77:[113.576726,22.270703],\u6C55\u5934:[116.683828,23.355818],\u4F5B\u5C71:[113.122717,23.028595],\u4E1C\u839E:[113.75179,23.020748],\u4E2D\u5C71:[113.382333,22.521112],\u6C5F\u95E8:[113.094175,22.589016],\u60E0\u5DDE:[114.412605,23.07942],\u8302\u540D:[110.919231,21.659752],\u6E5B\u6C5F:[110.359377,21.270679],\u6885\u5DDE:[116.119268,24.299056],\u6E05\u8FDC:[113.04789,24.325153],\u97F6\u5173:[113.598407,24.809434],\u4E91\u6D6E:[112.044382,22.927393],\u6F6E\u5DDE:[116.632303,23.661951],\u63ED\u9633:[116.355529,23.543716],\u6CB3\u6E90:[114.697808,23.746275],\u6210\u90FD:[104.065735,30.659462],\u7EF5\u9633:[104.741657,31.455295],\u5FB7\u9633:[104.394943,31.128142],\u5357\u5145:[106.082976,30.795771],\u8D44\u9633:[104.641797,30.123222],\u81EA\u8D21:[104.778442,29.359089],\u6500\u679D\u82B1:[101.718636,26.582347],\u6CF8\u5DDE:[105.443737,28.878649],\u8FBE\u5DDE:[107.502627,31.209818],\u5E7F\u5143:[105.828737,32.433767],\u5B9C\u5BBE:[104.569279,28.763023],\u5185\u6C5F:[105.052014,29.582056],\u4E50\u5C71:[103.761017,29.563017],\u5DF4\u4E2D:[106.753537,31.857465],\u96C5\u5B89:[103.001858,29.98289],\u7518\u5B5C:[100.233394,30.050591],\u51C9\u5C71:[102.266365,27.902191],\u963F\u575D:[102.22435,31.898394],\u6606\u660E:[102.832892,24.880095],\u5927\u7406:[100.228445,25.616545],\u4E3D\u6C5F:[100.226146,26.864494],\u897F\u53CC\u7248\u7EB3:[100.799647,22.003307],\u4FDD\u5C71:[99.166606,25.111631],\u695A\u96C4:[101.543757,25.036331],\u5FB7\u5B8F:[98.577494,24.439671],\u6012\u6C5F:[98.854247,26.648914],\u8FEA\u5E86:[99.708255,27.825172],\u662D\u901A:[103.717158,27.318388],\u66F2\u9756:[103.797387,25.496423],\u7389\u6EAA:[102.539095,24.350431],\u7EA2\u6CB3:[102.818658,23.369552],\u6587\u5C71:[104.24427,23.369998],\u666E\u6D31:[100.973858,22.775479],\u4E34\u6CA7:[100.089039,23.885899],\u6D77\u53E3:[110.33119,20.031971],\u4E09\u4E9A:[109.731928,18.249575],\u510B\u5DDE:[109.340454,19.517126],\u4E94\u6307\u5C71:[109.517624,18.773724],\u743C\u6D77:[110.466989,19.256953],\u4E07\u5B81:[110.389319,18.798578],\u6587\u660C:[110.77781,19.810778],\u4E1C\u65B9:[108.653813,19.09708],\u957F\u6C99:[112.973895,28.196059],\u682A\u6D32:[113.132898,27.831873],\u6E58\u6F6D:[112.944048,27.829724],\u8861\u9633:[112.580162,26.898242],\u90B5\u9633:[111.467124,27.237843],\u5CB3\u9633:[113.089684,29.363969],\u5E38\u5FB7:[111.691585,29.030896],\u5F20\u5BB6\u754C:[110.479298,29.127356],\u76CA\u9633:[112.339719,28.567383],\u90F4\u5DDE:[113.032259,25.774173],\u6C38\u5DDE:[111.608017,26.430765],\u6000\u5316:[109.959052,27.537304],\u5A04\u5E95:[112.003673,27.728183],\u6E58\u897F:[109.739779,28.312699],\u6B66\u6C49:[114.298572,30.584355],\u9EC4\u77F3:[115.096794,30.185835],\u5341\u5830:[110.788111,32.646473],\u5B9C\u660C:[111.290804,30.693176],\u8944\u9633:[112.14414,32.042451],\u9102\u5DDE:[114.888993,30.390928],\u8346\u95E8:[112.203958,31.035758],\u5B5D\u611F:[113.917078,30.916557],\u8346\u5DDE:[112.239204,30.329688],\u9EC4\u5188:[114.879454,30.436752],\u54B8\u5B81:[113.868505,29.839171],\u968F\u5DDE:[113.364104,31.708469],\u6069\u65BD:[109.489134,30.274575],\u6D4E\u5357:[117.020048,36.667524],\u9752\u5C9B:[120.382602,36.064357],\u6DC4\u535A:[118.047644,36.788883],\u67A3\u5E84:[117.323134,34.818489],\u4E1C\u8425:[118.492963,37.461484],\u70DF\u53F0:[121.391446,37.539289],\u6F4D\u574A:[119.160833,36.649827],\u6D4E\u5B81:[116.587269,35.389439],\u6CF0\u5B89:[117.087156,36.184069],\u5A01\u6D77:[122.121559,37.51284],\u65E5\u7167:[119.477875,35.417796],\u83B1\u829C:[117.659763,36.211577],\u4E34\u6C82:[118.356384,35.065087],\u5FB7\u5DDE:[116.357594,37.455084],\u804A\u57CE:[115.975435,36.456405],\u6EE8\u5DDE:[117.971797,37.38421],\u83CF\u6CFD:[115.469381,35.246531],\u5168\u56FD:[104.195397,35.86166]},la=function(n){var t=n.value,a=t===void 0?"":t,e=n.onChange;return(0,s.jsx)(ta.Z,{defaultValue:["\u6D59\u6C5F","\u676D\u5DDE"],options:ra,onChange:e})},ia=la,ua=function(n){var t=n.handleAddNewItem,a=n.isSubmitted,e=n.isModalOpen,l=n.handleOk,u=n.handleCancel,i=n.setCity,r=n.setSelectedPlace,c=n.selectedPlace,o=n.city,d=n.handleEdit,h=n.handleSubmit;return(0,s.jsxs)($.Z,{justify:"space-between",style:{padding:"16px 0",flexShrink:0},children:[(0,s.jsx)($.Z,{gap:"middle",children:(0,s.jsx)(H.ZP,{type:"primary",onClick:t,disabled:a,children:"\u65B0\u589E"})}),(0,s.jsxs)(he.Z,{title:"\u65B0\u589E",open:e,onOk:l,onCancel:u,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",zIndex:1e4,getContainer:function(){return document.body},children:[(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u57CE\u5E02\u8303\u56F4"}),(0,s.jsx)(ia,{onChange:function(f,g){if(g&&g.length>0){var S=g[g.length-1].label;i(S)}else i("\u676D\u5DDE")}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u9009\u62E9\u666F\u70B9"}),(0,s.jsx)(na,{onPlaceSelected:r,placeholder:"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22",city:o==="\u676D\u5DDE"?"":o},o),c&&(0,s.jsxs)("div",{style:{marginTop:8,padding:8,background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4},children:[(0,s.jsx)("div",{style:{fontWeight:"bold"},children:c.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:c.address})]})]})]}),(0,s.jsx)($.Z,{gap:"middle",style:{marginRight:20},children:a?(0,s.jsx)(H.ZP,{onClick:d,children:"\u8FD4\u56DE\u7F16\u8F91"}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(H.ZP,{type:"primary",onClick:h,children:"\u63D0\u4EA4\u884C\u7A0B"})})})]})},oa=ua,sa=b(67825),ca=b.n(sa),da=b(49319),ha=b(78434),va=["data-row-key"],ga=function(n){var t=n["data-row-key"],a=ca()(n,va),e=(0,ie.nB)({id:t}),l=e.attributes,u=e.listeners,i=e.setNodeRef,r=e.transform,c=e.transition,o=e.isDragging,d=j()(j()({},a.style),{},{transform:ha.ux.Translate.toString(r),transition:c,cursor:"move"},o?{position:"relative",zIndex:999,background:"#fafafa"}:{});return(0,s.jsx)("tr",j()(j()(j()(j()({},a),{},{ref:i,style:d},l),u),{},{"data-row-key":t}))},fa=function(n){var t=n.onDragEnd,a=n.sensors,e=n.dataSource,l=n.columns,u=n.isSubmitted,i=n.rowSelection;return(0,s.jsx)(ue.LB,{sensors:a,onDragEnd:t,children:(0,s.jsx)(ie.Fo,{items:e.map(function(r){return r.id}),strategy:ie.qw,children:(0,s.jsx)(da.Z,{components:{body:{row:ga}},rowKey:"id",columns:l,dataSource:e,pagination:!1,scroll:{y:"calc(100vh - 260px)"},rowSelection:u?void 0:i,style:{background:"#fff",flex:1,position:"relative",zIndex:1},locale:{emptyText:(0,s.jsxs)("div",{style:{padding:"60px 20px",textAlign:"center",color:"#999"},children:[(0,s.jsx)("div",{style:{fontSize:"16px",marginBottom:"8px"},children:"\u6682\u65E0\u666F\u70B9\u6570\u636E"}),(0,s.jsx)("div",{style:{fontSize:"14px"},children:'\u70B9\u51FB\u4E0B\u65B9"\u65B0\u589E\u666F\u70B9"\u6309\u94AE\u6DFB\u52A0\u60A8\u60F3\u53BB\u7684\u5730\u65B9'})]})}})})})},pa=fa,ee=b(11778),ae={orderNumber:"orderNumber___UuufS",startPoint:"startPoint___tPvL9",endPoint:"endPoint___GqI3G",location:"location___s6Y6N",selectionStatus:"selectionStatus___weOuT"},ma=function(n,t,a,e,l,u){return[{title:a?"\u884C\u7A0B\u987A\u5E8F":"\u666F\u70B9",dataIndex:"name",width:200,render:function(r,c,o){return(0,s.jsxs)($.Z,{gap:"middle",align:"center",children:[a&&c.checked&&(0,s.jsx)("div",{className:ae.orderNumber,children:n.filter(function(d){return d.checked}).findIndex(function(d){return d.id===c.id})+1}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{fontWeight:c.isStart||c.isEnd?"bold":"normal"},children:[c.isStart&&(0,s.jsx)("span",{className:ae.startPoint,children:"[\u8D77\u70B9]"}),c.isEnd&&(0,s.jsx)("span",{className:ae.endPoint,children:"[\u7EC8\u70B9]"}),r]}),(0,s.jsx)("div",{className:ae.location,children:c.location})]})]})}},{title:"\u51FA\u884C\u65B9\u5F0F",dataIndex:"mode",width:100,render:function(r,c){return(0,s.jsxs)(ee.default,{value:r,style:{width:70},disabled:a,onChange:function(d){t(function(h){return h.map(function(p){return p.id===c.id?j()(j()({},p),{},{mode:d}):p})})},children:[(0,s.jsx)(ee.default.Option,{value:"driving",children:"\u9A7E\u8F66"}),(0,s.jsx)(ee.default.Option,{value:"walking",children:"\u6B65\u884C"}),(0,s.jsx)(ee.default.Option,{value:"riding",children:"\u9A91\u884C"}),(0,s.jsx)(ee.default.Option,{value:"transfer",children:"\u516C\u4EA4"})]})}},{title:"\u64CD\u4F5C",key:"action",width:150,render:function(r,c){return(0,s.jsxs)($.Z,{gap:4,wrap:!0,children:[!a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H.ZP,{size:"small",type:c.isStart?"primary":"default",onClick:function(){return l(c.id)},children:c.isStart?"\u8D77\u70B9":"\u8BBE\u4E3A\u8D77\u70B9"}),(0,s.jsx)(H.ZP,{size:"small",type:c.isEnd?"primary":"default",onClick:function(){return u(c.id)},children:c.isEnd?"\u7EC8\u70B9":"\u8BBE\u4E3A\u7EC8\u70B9"}),(0,s.jsx)(H.ZP,{size:"small",variant:"link",color:"danger",onClick:function(){return e(c.id)},children:"\u5220\u9664"})]}),a&&(0,s.jsx)("div",{className:ae.selectionStatus,children:c.checked?"\u5DF2\u9009\u62E9":"\u672A\u9009\u62E9"})]})}}]},ya=b(73648),ba=function(n,t,a){return{type:"checkbox",selectedRowKeys:n.filter(function(e){return e.checked}).map(function(e){return e.id}),onChange:function(l){t(n.map(function(u){return j()(j()({},u),{},{checked:l.includes(u.id)})}))},onSelect:function(l,u){t(n.map(function(i){return i.id===l.id?j()(j()({},i),{},{checked:u}):i}))},onSelectAll:function(l){t(n.map(function(u){return j()(j()({},u),{},{checked:l})}))},getCheckboxProps:function(l){return{disabled:a,name:l.name}},columnTitle:a?"\u9009\u62E9\u72B6\u6001":(0,s.jsx)(ya.Z,{indeterminate:n.some(function(e){return e.checked})&&!n.every(function(e){return e.checked}),checked:n.length>0&&n.every(function(e){return e.checked}),disabled:a||n.length===0,onChange:function(l){var u=l.target.checked;t(n.map(function(i){return j()(j()({},i),{},{checked:u})}))}}),columnWidth:60}},Sa=function(n){var t=n.items,a=n.setItems,e=n.isSubmitted,l=e===void 0?!1:e,u=n.onSubmit,i=n.onEdit,r=(0,R.useState)(t),c=B()(r,2),o=c[0],d=c[1],h=(0,R.useState)(!1),p=B()(h,2),f=p[0],g=p[1],S=(0,R.useState)(null),k=B()(S,2),w=k[0],P=k[1],v=(0,R.useState)("\u676D\u5DDE"),A=B()(v,2),x=A[0],M=A[1],D=ba(t,a,l);R.useEffect(function(){d(t)},[t]);var L=(0,ue.Dy)((0,ue.VT)(ue.we,{activationConstraint:{distance:5}})),N=function(T){var V=T.active,z=T.over;if(V.id!==(z==null?void 0:z.id)){var pn=o.findIndex(function(Se){return Se.id===V.id}),mn=o.findIndex(function(Se){return Se.id===z.id}),Fe=(0,ie.Rp)(o,pn,mn);d(Fe),a(Fe)}},m=(0,R.useCallback)(function(){var Z=t.filter(function(T){return T.checked});if(Z.length<2){he.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u81F3\u5C11\u9009\u62E92\u4E2A\u666F\u70B9\u624D\u80FD\u63D0\u4EA4\u884C\u7A0B"});return}u==null||u()},[t,u]),I=function(){i==null||i()},be=function(T){a(function(V){return V.map(function(z){return j()(j()({},z),{},{isStart:z.id===T,isEnd:z.isEnd&&z.id!==T})})})},K=function(T){a(function(V){return V.map(function(z){return j()(j()({},z),{},{isEnd:z.id===T,isStart:z.isStart&&z.id!==T})})})},X=function(T){a(function(V){return V.filter(function(z){return z.id!==T})})},re=(0,R.useCallback)(function(){P(null),g(!0),M("\u676D\u5DDE")},[]),G=function(){if(!w){he.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u666F\u70B9"});return}var T={id:"pois-".concat(Date.now()),name:w.name,location:w.address,region:w.cityname||x,lat:w==null?void 0:w.location.lat,lng:w==null?void 0:w.location.lng,isStart:!1,isEnd:!1,mode:"driving",checked:!1};a(function(V){return[].concat(de()(V),[T])}),g(!1),P(null)},ce=function(){g(!1),P(null)},Be=ma(t,a,l,X,be,K);return(0,s.jsxs)($.Z,{vertical:!0,style:{height:"100%"},children:[(0,s.jsx)(pa,{onDragEnd:N,sensors:L,dataSource:o,columns:Be,isSubmitted:l,rowSelection:l?void 0:D}),(0,s.jsx)(oa,{handleAddNewItem:re,isModalOpen:f,isSubmitted:l,handleOk:G,handleCancel:ce,setCity:M,setSelectedPlace:P,selectedPlace:w,city:x,handleSubmit:m,handleEdit:I})]})},wa=Sa,Ca={mapContainer:"mapContainer___vtLAG"},ka=function(n){var t=n.mapContainerRef;return(0,s.jsx)("div",{ref:t,className:Ca.mapContainer})},Pa=ka,Ae=b(8520),ge=b(87263),oe=b(62826),Ra=b(87056),Aa=b(86422),xa=function(n){var t=n.planItems,a=n.completeRoute,e=n.isSubmitted,l=n.onImportData,u=function(){if(!e||!a)return"";var g=t.filter(function(k){return k.checked}),S=`\u65C5\u884C\u884C\u7A0B\u8BA1\u5212
`;return S+="\u751F\u6210\u65F6\u95F4: ".concat(new Date().toLocaleString(),`
`),S+=`=====================================

`,S+=`\u884C\u7A0B\u6982\u89C8:
`,S+="\u666F\u70B9\u6570\u91CF: ".concat(g.length,`\u4E2A
`),S+="\u8DEF\u6BB5\u6570\u91CF: ".concat(a.segments.length,`\u6BB5
`),S+="\u603B\u8DDD\u79BB: ".concat((a.totalDistance/1e3).toFixed(1),`km
`),S+="\u603B\u65F6\u95F4: ".concat(Math.ceil(a.totalDuration/60),`\u5206\u949F
`),S+="\u6210\u529F\u8DEF\u6BB5: ".concat(a.segments.filter(function(k){return k.success}).length,"/").concat(a.segments.length,`\u6BB5

`),S+=`\u666F\u70B9\u5217\u8868:
`,g.forEach(function(k,w){S+="".concat(w+1,". ").concat(k.name,`
`),S+="   \u4F4D\u7F6E: ".concat(k.location,`
`),S+="   \u5750\u6807: ".concat(k.lat,", ").concat(k.lng,`
`),S+="   \u51FA\u884C\u65B9\u5F0F: ".concat(W[k.mode],`

`)}),S+=`\u8DEF\u7EBF\u8BE6\u60C5:
`,a.segments.forEach(function(k,w){S+="\u8DEF\u6BB5 ".concat(w+1,": ").concat(k.startPoint.name," \u2192 ").concat(k.endPoint.name,`
`),k.success?(S+="   \u8DDD\u79BB: ".concat((k.distance/1e3).toFixed(1),`km
`),S+="   \u65F6\u95F4: ".concat(Math.ceil(k.duration/60),`\u5206\u949F
`),S+="   \u65B9\u5F0F: ".concat(W[k.mode],`
`)):S+="   \u72B6\u6001: \u8BA1\u7B97\u5931\u8D25 - ".concat(k.error,`
`),S+=`
`}),S},i=function(){try{var g=u(),S=new Blob([g],{type:"text/plain;charset=utf-8"}),k=URL.createObjectURL(S),w=document.createElement("a");w.href=k,w.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(k),F.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6")}catch(P){console.error("\u5BFC\u51FA\u6587\u672C\u6587\u4EF6\u5931\u8D25:",P),F.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},r=function(){try{var g=t.filter(function(v){return v.checked}),S={metadata:{title:"\u65C5\u884C\u884C\u7A0B\u8BA1\u5212",exportTime:new Date().toISOString(),version:"1.0"},summary:{totalSpots:g.length,totalSegments:(a==null?void 0:a.segments.length)||0,totalDistance:(a==null?void 0:a.totalDistance)||0,totalDuration:(a==null?void 0:a.totalDuration)||0,successSegments:(a==null?void 0:a.segments.filter(function(v){return v.success}).length)||0},spots:g.map(function(v,A){return{order:A+1,id:v.id,name:v.name,location:v.location,region:v.region,coordinates:{latitude:v.lat,longitude:v.lng},transportMode:v.mode,transportModeName:W[v.mode]}}),routes:(a==null?void 0:a.segments.map(function(v,A){var x;return{segmentId:v.id,order:A+1,from:{name:v.startPoint.name,coordinates:v.startPoint.position},to:{name:v.endPoint.name,coordinates:v.endPoint.position},distance:v.distance,duration:v.duration,mode:v.mode,modeName:W[v.mode],success:v.success,error:v.error,polylinePoints:((x=v.polyline)===null||x===void 0?void 0:x.length)||0}}))||[]},k=new Blob([JSON.stringify(S,null,2)],{type:"application/json;charset=utf-8"}),w=URL.createObjectURL(k),P=document.createElement("a");P.href=w,P.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(w),F.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6")}catch(v){console.error("\u5BFC\u51FAJSON\u6587\u4EF6\u5931\u8D25:",v),F.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},c=function(){try{var g=t.filter(function(v){return v.checked}),S="\uFEFF";S+=`\u5E8F\u53F7,\u666F\u70B9\u540D\u79F0,\u4F4D\u7F6E,\u5730\u533A,\u7EAC\u5EA6,\u7ECF\u5EA6,\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0
`,g.forEach(function(v,A){S+="".concat(A+1,',"').concat(v.name,'","').concat(v.location,'","').concat(v.region,'",').concat(v.lat,",").concat(v.lng,',"').concat(v.mode,'","').concat(W[v.mode],`"
`)}),a&&a.segments.length>0&&(S+=`
\u8DEF\u6BB5\u5E8F\u53F7,\u8D77\u70B9,\u7EC8\u70B9,\u8DDD\u79BB(\u7C73),\u65F6\u95F4(\u79D2),\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0,\u72B6\u6001,\u9519\u8BEF\u4FE1\u606F
`,a.segments.forEach(function(v,A){S+="".concat(A+1,',"').concat(v.startPoint.name,'","').concat(v.endPoint.name,'",').concat(v.distance,",").concat(v.duration,',"').concat(v.mode,'","').concat(W[v.mode],'","').concat(v.success?"\u6210\u529F":"\u5931\u8D25",'","').concat(v.error||"",`"
`)}));var k=new Blob([S],{type:"text/csv;charset=utf-8"}),w=URL.createObjectURL(k),P=document.createElement("a");P.href=w,P.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(w),F.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6")}catch(v){console.error("\u5BFC\u51FACSV\u6587\u4EF6\u5931\u8D25:",v),F.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},o=function(){var g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=function(S){var k,w=(k=S.target.files)===null||k===void 0?void 0:k[0];if(w){var P=new FileReader;P.onload=function(v){try{var A,x=JSON.parse((A=v.target)===null||A===void 0?void 0:A.result);if(x.spots&&Array.isArray(x.spots)){var M=x.spots.map(function(D,L){var N,m;return{id:"imported-".concat(Date.now(),"-").concat(L),name:D.name,location:D.location||D.name,region:D.region||"\u672A\u77E5",lat:((N=D.coordinates)===null||N===void 0?void 0:N.latitude)||D.lat,lng:((m=D.coordinates)===null||m===void 0?void 0:m.longitude)||D.lng,isStart:L===0,isEnd:L===x.spots.length-1,mode:D.transportMode||D.mode||"driving",checked:!0}});l?(l(M),F.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(M.length," \u4E2A\u666F\u70B9"))):F.ZP.error("\u5BFC\u5165\u529F\u80FD\u4E0D\u53EF\u7528")}else F.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u6B63\u786E\u7684JSON\u6587\u4EF6")}catch(D){console.error("\u5BFC\u5165\u6587\u4EF6\u89E3\u6790\u5931\u8D25:",D),F.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5JSON\u683C\u5F0F")}},P.readAsText(w)}},g.click()},d=function(){var f=E()(C()().mark(function g(){var S;return C()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,S=u(),w.next=4,navigator.clipboard.writeText(S);case 4:F.ZP.success("\u884C\u7A0B\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"),w.next=11;break;case 7:w.prev=7,w.t0=w.catch(0),console.error("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25:",w.t0),F.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236");case 11:case"end":return w.stop()}},g,null,[[0,7]])}));return function(){return f.apply(this,arguments)}}(),h=function(){try{var g=t.filter(function(P){return P.checked}),S={spots:g.map(function(P){return{name:P.name,lat:P.lat,lng:P.lng,mode:P.mode}})},k=encodeURIComponent(JSON.stringify(S)),w="".concat(window.location.origin).concat(window.location.pathname,"?share=").concat(k);navigator.clipboard.writeText(w),F.ZP.success("\u5206\u4EAB\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch(P){console.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",P),F.ZP.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25")}},p=[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,s.jsx)(ge.Z,{}),onClick:o},{key:"txt",label:"\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6",icon:(0,s.jsx)(oe.Z,{}),onClick:i},{key:"json",label:"\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6",icon:(0,s.jsx)(oe.Z,{}),onClick:r},{key:"csv",label:"\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6",icon:(0,s.jsx)(Ra.Z,{}),onClick:c},{key:"copy",label:"\u590D\u5236\u5230\u526A\u8D34\u677F",icon:(0,s.jsx)(oe.Z,{}),onClick:d},{key:"share",label:"\u751F\u6210\u5206\u4EAB\u94FE\u63A5",icon:(0,s.jsx)(oe.Z,{}),onClick:h}];return!e||!a||a.segments.length===0?(0,s.jsx)(Ae.Z,{menu:{items:[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,s.jsx)(ge.Z,{}),onClick:o}]},placement:"bottomRight",trigger:["click"],children:(0,s.jsx)(H.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(ge.Z,{}),title:"\u5BFC\u5165\u884C\u7A0B\u6570\u636E",children:"\u5BFC\u5165"})}):(0,s.jsx)(Ae.Z,{menu:{items:p},placement:"bottomRight",trigger:["click"],children:(0,s.jsx)(H.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(Aa.Z,{}),children:"\u5BFC\u51FA"})})},Da=xa,ne={mapHeader:"mapHeader___ZfXdw",headerTitle:"headerTitle___iBoRP",selectedMode:"selectedMode___VlGSk",routeInfo:"routeInfo___UvkLb",routeDetails:"routeDetails___IVH1j"},Ea=function(n){var t=n.planItems,a=n.routes,e=n.completeRoute,l=n.isSubmitted,u=n.selectedMode,i=n.routeDrawing,r=n.loading,c=n.mapLoading,o=n.onImportData;return(0,s.jsx)("div",{className:ne.mapHeader,children:(0,s.jsxs)("div",{className:ne.headerTitle,children:[(0,s.jsxs)("div",{children:[c?"\u5730\u56FE\u52A0\u8F7D\u4E2D...":r?l?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u8DEF\u7EBF\u4E2D...":i?"\u6B63\u5728\u7ED8\u5236".concat(W[u],"\u8DEF\u7EBF..."):l?e&&e.success?"\u5B8C\u6574\u884C\u7A0B\u8DEF\u7EBF (".concat(e.segments.filter(function(d){return d.success}).length,"/").concat(e.segments.length," \u6BB5\u6210\u529F)"):"\u5B8C\u6574\u8DEF\u5F84\u8BA1\u7B97":a.length>0?"\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4 (".concat(a.filter(function(d){return d.success}).length,"/").concat(a.length," \u79CD\u53EF\u7528)"):"\u8DEF\u7EBF\u9884\u89C8",(l?e:a.length>0)&&!r&&(0,s.jsxs)("div",{className:ne.routeInfo,children:["\u5F53\u524D\u663E\u793A: ",(0,s.jsx)("span",{style:{color:O[u]},className:ne.selectedMode,children:W[u]||u})," \u8DEF\u7EBF",l&&e&&(0,s.jsxs)("span",{className:ne.routeDetails,children:["\u603B\u8DDD\u79BB: ",(e.totalDistance/1e3).toFixed(1),"km | \u603B\u65F6\u95F4: ",Math.ceil(e.totalDuration/60),"\u5206\u949F"]})]})]}),(0,s.jsx)(Da,{planItems:t,completeRoute:e,isSubmitted:l,onImportData:o})]})})},Ma=Ea,Ba=b(35937),fe={spin:"spin___H6Z9A",detailContainer:"detailContainer___UnJZd",emptyState:"emptyState___GJe_C"},Fa=function(n){var t=n.loading,a=n.mapLoading,e=n.isSubmitted,l=n.completeRoute,u=n.routes,i=le.Z.useToken(),r=i.token;return t||a||e&&l||!e&&u.length>0?null:(0,s.jsx)("div",{className:fe.emptyState,style:{color:r.colorTextDescription},children:e?"\u8BF7\u9009\u62E9\u81F3\u5C112\u4E2A\u666F\u70B9\u8BA1\u7B97\u8DEF\u5F84":"\u8BF7\u8BBE\u7F6E\u8D77\u70B9\u548C\u7EC8\u70B9\u67E5\u770B\u8DEF\u7EBF"})},ja=Fa,xe=b(72504),te=b(60980),De=b(4422),Ia=function(n){var t=n.isSubmitted,a=n.loading,e=n.routes,l=n.selectedMode,u=n.routeDrawing,i=n.handleModeChange,r=le.Z.useToken(),c=r.token,o=xe.Z.Text;return t||a||e.length<=0?null:(0,s.jsxs)($.Z,{vertical:!0,gap:"small",children:[(0,s.jsx)(o,{strong:!0,style:{fontSize:"13px",marginTop:"8px"},children:"\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4\uFF1A"}),(0,s.jsx)(te.Z,{size:"small",dataSource:e,split:!1,renderItem:function(h){return(0,s.jsx)(te.Z.Item,{onClick:function(){return h.success&&!u&&i(h.mode)},style:{background:h.success?l===h.mode?c.colorInfoBg:"#f5f5f5":c.colorErrorBg,border:"none",borderRadius:c.borderRadiusSM,cursor:h.success?"pointer":"not-allowed",opacity:h.success?1:.6,transition:"all 0.3s ease",padding:"6px 12px",marginBottom:"5px",alignItems:"center",boxShadow:l===h.mode?"0 0 0 1px ".concat(O[h.mode],"40"):"none"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,s.jsx)(De.Z,{dot:!0,offset:[-2,8],style:{backgroundColor:O[h.mode],boxShadow:l===h.mode&&h.success?"0 0 0 2px ".concat(O[h.mode],"40"):"none",marginRight:8}}),(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:(0,s.jsxs)($.Z,{align:"center",gap:8,children:[(0,s.jsxs)(o,{strong:!0,style:{fontSize:c.fontSizeSM,color:l===h.mode&&h.success?O[h.mode]:void 0},children:[W[h.mode],l===h.mode&&h.success]}),h.success?(0,s.jsxs)(o,{type:"secondary",style:{fontSize:"11px"},children:["\u8DDD\u79BB: ",(h.distance/1e3).toFixed(1),"km | \u65F6\u95F4:"," ",Math.ceil(h.duration/60),"\u5206\u949F",h.mode==="transfer"&&" | \u542B\u6362\u4E58"]}):(0,s.jsx)(o,{type:"danger",style:{fontSize:"11px"},children:h.error||"\u8DEF\u7EBF\u4E0D\u53EF\u7528"})]})})]})},h.mode)}})]})},Ta=Ia,La=b(96761),za=function(n){var t=n.isSubmitted,a=n.completeRoute,e=n.selectedSegment,l=n.handleSegmentClick,u=le.Z.useToken(),i=u.token,r=xe.Z.Text;return!t||!a?null:(0,s.jsxs)($.Z,{vertical:!0,gap:"small",children:[(0,s.jsx)(r,{strong:!0,style:{fontSize:"13px",marginTop:"8px"},children:"\u884C\u7A0B\u8DEF\u7EBF\u8BE6\u60C5:"}),(0,s.jsx)(te.Z,{size:"small",dataSource:a.segments,split:!1,renderItem:function(o){return(0,s.jsx)(te.Z.Item,{onClick:function(){return o.success&&l(o.id)},style:{background:o.success?e===o.id?i.colorInfoBg:"#f5f5f5":i.colorErrorBg,border:"none",borderRadius:i.borderRadiusSM,cursor:o.success?"pointer":"not-allowed",opacity:o.success?1:.6,transition:"all 0.3s ease",padding:"0px 0px 0px 5px",marginBottom:"5px",boxShadow:e===o.id?"0 0 0 1px ".concat(O[o.mode],"40"):"none"},children:(0,s.jsx)(te.Z.Item.Meta,{avatar:(0,s.jsx)(De.Z,{dot:!0,offset:[8,5],style:{backgroundColor:O[o.mode],boxShadow:e===o.id?"0 0 0 2px ".concat(O[o.mode],"40"):"none"}}),title:(0,s.jsxs)(r,{strong:!0,style:{fontSize:i.fontSizeSM,color:e===o.id?O[o.mode]:void 0},children:[o.startPoint.name," \u2192 ",o.endPoint.name,e===o.id]}),description:o.success?(0,s.jsxs)(r,{type:"secondary",style:{fontSize:i.fontSizeSM},children:["\u8DDD\u79BB: ",(o.distance/1e3).toFixed(1),"km | \u65F6\u95F4:"," ",Math.ceil(o.duration/60),"\u5206\u949F | \u65B9\u5F0F:"," ",W[o.mode]]}):(0,s.jsx)(r,{type:"danger",style:{fontSize:i.fontSizeSM},children:o.error})})},o.id)}}),a.segments.some(function(c){return c.success})&&(0,s.jsxs)(La.Z,{type:"inner",size:"small",style:{fontSize:i.fontSizeSM,background:i.colorInfoBg,borderColor:i.colorInfoBorder},children:[(0,s.jsx)(r,{style:{fontSize:i.fontSizeSM},strong:!0,children:"\u603B\u8BA1\uFF1A"}),(0,s.jsxs)("span",{children:["\u8DDD\u79BB ",(a.totalDistance/1e3).toFixed(1),"km | \u65F6\u95F4"," ",Math.ceil(a.totalDuration/60),"\u5206\u949F"]})]})]})},Za=za,Na=function(n){var t=n.loading,a=n.isSubmitted,e=n.completeRoute,l=n.routes,u=n.selectedMode,i=n.selectedSegment,r=n.routeDrawing,c=n.mapLoading,o=n.handleSegmentClick,d=n.handleModeChange;return t?(0,s.jsxs)("div",{children:[(0,s.jsx)(Ba.Z,{size:"small",className:fe.spin})," ",a?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u4E2D..."]}):(0,s.jsxs)("div",{className:fe.detailContainer,children:[(0,s.jsx)(Za,{isSubmitted:a,completeRoute:e,selectedSegment:i,handleSegmentClick:o}),(0,s.jsx)(Ta,{isSubmitted:a,loading:t,routes:l,selectedMode:u,routeDrawing:r,handleModeChange:d}),(0,s.jsx)(ja,{loading:t,mapLoading:c,isSubmitted:a,completeRoute:e,routes:l})]})},Wa=Na,Oa="c235c1e78c16464f41d866fe4c811c58",$a="3e3153b7d6dec0cb487d2afde4795453",Ka=function(){return new Promise(function(n,t){if(window.AMap){n();return}window._AMapSecurityConfig={securityJsCode:$a};var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src="https://webapi.amap.com/maps?v=2.0&key=".concat(Oa),a.onload=function(){console.log("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u6210\u529F"),n()},a.onerror=function(e){console.error("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u5931\u8D25:",e),t(e)},document.head.appendChild(a)})},Va=function(n){var t=(0,R.useRef)(null),a=(0,R.useRef)(null),e=(0,R.useRef)(null),l=(0,R.useState)(!0),u=B()(l,2),i=u[0],r=u[1];return(0,R.useEffect)(function(){var c=function(){var o=E()(C()().mark(function d(){var h;return C()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(t.current){f.next=2;break}return f.abrupt("return");case 2:return f.prev=2,f.next=5,Ka();case 5:return h=Re[n]||Re.\u676D\u5DDE,a.current=new window.AMap.Map(t.current,{zoom:n==="\u676D\u5DDE"?4:11,center:h,mapStyle:"amap://styles/normal",showLabel:!0,showBuildingBlock:!0,viewMode:"2D",pitch:0,skyColor:"#ffffff",features:["bg","point","road","building"],resizeEnable:!0,rotateEnable:!0,pitchEnable:!0,zoomEnable:!0,dragEnable:!0,keyboardEnable:!0,doubleClickZoom:!0,scrollWheel:!0,touchZoom:!0,touchZoomCenter:1,animateEnable:!0}),e.current=new ea(a.current),f.prev=8,f.next=11,new Promise(function(g){window.AMap.plugin(["AMap.Scale","AMap.ToolBar","AMap.ControlBar"],function(){window.AMap.Scale&&a.current.addControl(new window.AMap.Scale({position:"LB"})),window.AMap.ToolBar&&a.current.addControl(new window.AMap.ToolBar({locate:!0,position:"LT",direction:!0,autoPosition:!1,locationMarker:!0,useNative:!0})),window.AMap.ControlBar&&a.current.addControl(new window.AMap.ControlBar({position:"RT"})),g()})});case 11:f.next=16;break;case 13:f.prev=13,f.t0=f.catch(8),console.warn("\u5730\u56FE\u63A7\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u4F46\u4E0D\u5F71\u54CD\u4E3B\u8981\u529F\u80FD:",f.t0);case 16:r(!1),f.next=23;break;case 19:f.prev=19,f.t1=f.catch(2),console.error("\u5730\u56FE\u521D\u59CB\u5316\u5931\u8D25:",f.t1),r(!1);case 23:case"end":return f.stop()}},d,null,[[2,19],[8,13]])}));return function(){return o.apply(this,arguments)}}();return c(),function(){a.current&&(a.current.destroy(),a.current=null)}},[n]),{mapContainerRef:t,mapInstanceRef:a,mapLoading:i,routeServiceRef:e}},Ha=function(n,t,a){(0,R.useEffect)(function(){if(!(!n.current||t.length===0)){var e=n.current.getAllOverlays("marker");e.forEach(function(u){n.current.remove(u)});var l=[];t.forEach(function(u,i){if(!(!u.lat||!u.lng)){var r="";if(a&&u.checked){var c=t.filter(function(h){return h.checked}),o=c.findIndex(function(h){return h.id===u.id});r='<div style="background: #1890ff; color: white; padding: 6px 10px; border-radius: 50%; font-size: 14px; font-weight: bold; min-width: 28px; text-align: center;">'.concat(o+1,"</div>")}else u.isStart?r='<div style="background: #52c41a; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u8D77\u70B9</div>':u.isEnd?r='<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u7EC8\u70B9</div>':r='<div style="background: #1890ff; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">'.concat(i+1,"</div>");var d=new window.AMap.Marker({position:[u.lng,u.lat],content:r,title:u.name,anchor:"center",offset:new window.AMap.Pixel(0,-15),label:{content:u.name,direction:"top",offset:new window.AMap.Pixel(0,-10),style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"}}});l.push(d),n.current.add(d)}}),l.length>0&&n.current.setFitView(l,!1,[20,20,20,20])}},[n,t,a])},Ua=function(n,t,a,e,l){var u=(0,R.useState)([]),i=B()(u,2),r=i[0],c=i[1],o=(0,R.useState)(null),d=B()(o,2),h=d[0],p=d[1],f=(0,R.useState)(!1),g=B()(f,2),S=g[0],k=g[1];return(0,R.useEffect)(function(){var w=function(){var P=E()(C()().mark(function v(){var A,x,M,D,L;return C()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(!n.current||l)){m.next=2;break}return m.abrupt("return");case 2:if(k(!0),m.prev=3,!a){m.next=16;break}if(A=t.filter(function(I){return I.checked}),!(A.length<2)){m.next=9;break}return p(null),m.abrupt("return");case 9:return m.next=11,n.current.calculateCompleteRouteWithModes(A);case 11:x=m.sent,p(x),x.success&&x.segments.length>0&&n.current.drawCompleteRoute(x),m.next=25;break;case 16:if(M=t.find(function(I){return I.isStart}),D=t.find(function(I){return I.isEnd}),!(!M||!D)){m.next=21;break}return c([]),m.abrupt("return");case 21:return m.next=23,n.current.getAllRoutes([M.lng,M.lat],[D.lng,D.lat],e);case 23:L=m.sent,c(L);case 25:m.next=31;break;case 27:m.prev=27,m.t0=m.catch(3),console.error("\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25:",m.t0),a?p(null):c([]);case 31:return m.prev=31,k(!1),m.finish(31);case 34:case"end":return m.stop()}},v,null,[[3,27,31,34]])}));return function(){return P.apply(this,arguments)}}();w()},[t,a,e,l,n]),{routes:r,completeRoute:h,loading:S,setRoutes:c,setCompleteRoute:p}},Ja=function(n,t,a,e){var l=(0,R.useState)("driving"),u=B()(l,2),i=u[0],r=u[1],c=(0,R.useState)(null),o=B()(c,2),d=o[0],h=o[1],p=(0,R.useState)(!1),f=B()(p,2),g=f[0],S=f[1],k=function(){var P=E()(C()().mark(function v(A){var x,M,D,L;return C()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(!n.current||g||e)){m.next=2;break}return m.abrupt("return");case 2:if(x=a.find(function(I){return I.isStart}),M=a.find(function(I){return I.isEnd}),!(!x||!M)){m.next=6;break}return m.abrupt("return");case 6:if(D=t.find(function(I){return I.mode===A}),!(!D||!D.success)){m.next=9;break}return m.abrupt("return");case 9:return S(!0),r(A),m.prev=11,m.next=14,n.current.drawRoute([x.lng,x.lat],[M.lng,M.lat],A);case 14:L=m.sent,L||F.ZP.error("".concat(W[A],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25")),m.next=22;break;case 18:m.prev=18,m.t0=m.catch(11),console.error("\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",m.t0),F.ZP.error("".concat(W[A],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25"));case 22:return m.prev=22,S(!1),m.finish(22);case 25:case"end":return m.stop()}},v,null,[[11,18,22,25]])}));return function(A){return P.apply(this,arguments)}}(),w=function(v){if(!n.current){console.error("routeService \u672A\u521D\u59CB\u5316");return}d===v?(h(null),n.current.resetSegmentHighlight()):(h(v),n.current.highlightSegment(v))};return{selectedMode:i,selectedSegment:d,routeDrawing:g,handleModeChange:k,handleSegmentClick:w,setSelectedMode:r}},Ga=function(n){var t=n.planItems,a=n.isSubmitted,e=a===void 0?!1:a,l=n.city,u=l===void 0?"\u676D\u5DDE":l,i=n.onImportData,r=Va(u),c=r.mapContainerRef,o=r.mapInstanceRef,d=r.mapLoading,h=r.routeServiceRef;Ha(o,t,e);var p=Ua(h,t,e,u,d),f=p.routes,g=p.completeRoute,S=p.loading,k=Ja(h,f,t,e),w=k.selectedMode,P=k.selectedSegment,v=k.routeDrawing,A=k.handleModeChange,x=k.handleSegmentClick,M=function(L){i==null||i(L)};return(0,s.jsxs)($.Z,{vertical:!0,style:{height:"100%",overflow:"auto",border:"1px solid #f0f0f0",borderRadius:8},children:[(0,s.jsx)(Ma,{planItems:t,routes:f,completeRoute:g,isSubmitted:e,selectedMode:w,routeDrawing:v,loading:S,mapLoading:d,onImportData:M}),(0,s.jsx)("div",{style:{flex:1,minHeight:"40vh"},children:(0,s.jsx)(Pa,{mapContainerRef:c})}),(0,s.jsx)(Wa,{loading:S,isSubmitted:e,completeRoute:g,routes:f,selectedMode:w,selectedSegment:P,routeDrawing:v,mapLoading:d,handleSegmentClick:x,handleModeChange:A})]})},Ee=Ga,Ya=function(n){var t=n.planItems,a=n.setPlanItems,e=n.isSubmitted,l=n.onImportData,u=n.onSubmit,i=n.onEdit;return(0,s.jsxs)(Ie.Z,{gutter:[16,16],style:{height:"100%"},children:[(0,s.jsx)(ke.Z,{xs:24,lg:14,style:{height:"100%"},children:(0,s.jsx)(wa,{items:t,setItems:a,isSubmitted:e,onSubmit:u,onEdit:i})}),(0,s.jsx)(ke.Z,{xs:24,lg:10,style:{height:"100%"},children:(0,s.jsx)(Ee,{planItems:t,isSubmitted:e,city:t.length>0?t[0].region:"\u676D\u5DDE",onImportData:l})})]})},Xa=Ya,pe={layout:"layout___F0kCh",contentContainer:"contentContainer___G9f2i",content:"content___nGCOl"},Qa=b(43559),Q={header:"header___gCFwP",logo:"logo___aO8oL",menu:"menu___n76AM",planInfo:"planInfo___Bb004",clearButton:"clearButton___VhSxa",planCount:"planCount___N3KCR"},qa=b(57705),_a=b(38913),en=function(n){var t=n.selectedKey,a=n.planItems,e=n.onMenuSelect,l=n.onClearAll,u=function(r){var c=r.key;e(c)};return(0,s.jsxs)(Qa.h4,{className:Q.header,children:[(0,s.jsx)("div",{className:Q.logo,children:"\u81EA\u5B9A\u4E49\u65C5\u884C\u8BA1\u5212"}),(0,s.jsx)(qa.Z,{theme:"dark",mode:"horizontal",selectedKeys:[t],onClick:u,items:[{key:"1",label:"\u613F\u671B\u666F\u70B9\u5355"},{key:"2",label:"\u5728\u7EBF\u8BB0\u4E8B\u672C"}],className:Q.menu}),a.length>0&&(0,s.jsxs)("div",{className:Q.planInfo,children:[(0,s.jsxs)("span",{className:Q.planCount,children:["\u5DF2\u4FDD\u5B58 ",a.length," \u4E2A\u666F\u70B9"]}),(0,s.jsx)(H.ZP,{type:"text",size:"small",icon:(0,s.jsx)(_a.Z,{}),onClick:l,className:Q.clearButton,title:"\u6E05\u9664\u6240\u6709\u6570\u636E",children:"\u6E05\u9664"})]})]})},an=en,me="travel_plan_items",ye="travel_plan_submitted",nn=function(n,t){try{localStorage.setItem(me,JSON.stringify(n)),localStorage.setItem(ye,JSON.stringify(t)),console.log("\u6570\u636E\u5DF2\u4FDD\u5B58\u5230localStorage")}catch(a){console.error("\u4FDD\u5B58\u5230localStorage\u5931\u8D25:",a)}},tn=function(){try{var n=localStorage.getItem(me),t=localStorage.getItem(ye),a=n?JSON.parse(n):[],e=t?JSON.parse(t):!1;return console.log("\u4ECElocalStorage\u52A0\u8F7D\u6570\u636E:",{planItems:a.length,isSubmitted:e}),{planItems:a,isSubmitted:e}}catch(l){return console.error("\u4ECElocalStorage\u52A0\u8F7D\u5931\u8D25:",l),{planItems:[],isSubmitted:!1}}},rn=function(){try{localStorage.removeItem(me),localStorage.removeItem(ye),console.log("localStorage\u5DF2\u6E05\u9664")}catch(n){console.error("\u6E05\u9664localStorage\u5931\u8D25:",n)}},ln=function(n,t,a){(0,R.useEffect)(function(){var e=new URLSearchParams(window.location.search),l=e.get("share");if(l)try{var u=JSON.parse(decodeURIComponent(l));if(u.spots&&Array.isArray(u.spots)){var i=u.spots.map(function(r,c){return{id:"shared-".concat(Date.now(),"-").concat(c),name:r.name,location:r.name,region:"\u672A\u77E5",lat:r.lat,lng:r.lng,isStart:c===0,isEnd:c===u.spots.length-1,mode:r.mode||"driving",checked:!0}});n(i),t("2"),a(!0),F.ZP.success("\u5DF2\u5BFC\u5165\u5206\u4EAB\u7684\u884C\u7A0B\u8BA1\u5212"),window.history.replaceState({},document.title,window.location.pathname)}}catch(r){console.error("\u89E3\u6790\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",r),F.ZP.error("\u5206\u4EAB\u94FE\u63A5\u683C\u5F0F\u4E0D\u6B63\u786E")}},[])},un=b(92275),on=b.n(un),bn=b(56628);function sn(){var y=(0,R.useState)(""),n=B()(y,2),t=n[0],a=n[1],e={toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]};return(0,s.jsx)(on(),{theme:"snow",value:t,onChange:a,modules:e,placeholder:"\u5F00\u59CB\u8BB0\u5F55\u4F60\u7684\u65C5\u6E38\u7B14\u8BB0\u5427~"})}var cn=sn,Me=b(49418),se={label:"label___e_oPN",children:"children___BnC17",collapseItems:"collapseItems___Ohcid"},dn=function(n){var t=n.planItems,a=n.isSubmitted,e=n.activeKeys,l=n.onActiveKeysChange,u=n.onImportData,i=t.length>0?t[0].region:"\u676D\u5DDE",r=[{key:"note",label:(0,s.jsx)("span",{className:se.label,children:"\u{1F4DD} \u65C5\u884C\u7B14\u8BB0"}),children:(0,s.jsx)(cn,{})},{key:"map",label:(0,s.jsx)("span",{className:se.label,children:"\u{1F5FA}\uFE0F \u65C5\u884C\u5730\u56FE"}),children:(0,s.jsx)("div",{className:se.children,children:(0,s.jsx)(Ee,{planItems:t,isSubmitted:a,city:i,onImportData:u})})}];return(0,s.jsx)($.Z,{gap:"middle",vertical:!0,children:(0,s.jsx)(Me.Z,{activeKey:e,onChange:function(o){return l(o)},bordered:!1,expandIconPosition:"end",className:se.collapseItems,collapsible:"header",children:r.map(function(c){return(0,s.jsx)(Me.Z.Panel,{header:c.label,children:c.children},String(c.key))})})})},hn=dn,vn=Ce.Z.Content,gn=function(){var n=(0,R.useState)([]),t=B()(n,2),a=t[0],e=t[1],l=(0,R.useState)("1"),u=B()(l,2),i=u[0],r=u[1],c=(0,R.useState)(!1),o=B()(c,2),d=o[0],h=o[1],p=(0,R.useState)(["map"]),f=B()(p,2),g=f[0],S=f[1],k=le.Z.useToken(),w=k.token,P=w.colorBgContainer,v=w.borderRadiusLG;ln(e,r,h),(0,R.useEffect)(function(){var m=tn();m.planItems.length>0&&(e(m.planItems),h(m.isSubmitted),F.ZP.success("\u5DF2\u6062\u590D ".concat(m.planItems.length," \u4E2A\u666F\u70B9\u7684\u65C5\u884C\u8BA1\u5212")))},[]),(0,R.useEffect)(function(){a.length>0&&nn(a,d)},[a,d]);var A=function(){e([]),h(!1),rn(),F.ZP.success("\u5DF2\u6E05\u9664\u6240\u6709\u6570\u636E")},x=function(I){r(I)},M=function(I){e(I),h(!1),r("2")},D=function(){h(!0)},L=function(){h(!1)},N=function(){switch(i){case"1":return(0,s.jsx)(Xa,{planItems:a,setPlanItems:e,isSubmitted:d,onSubmit:D,onEdit:L,onImportData:M});case"2":return(0,s.jsx)(hn,{planItems:a,isSubmitted:d,activeKeys:g,onActiveKeysChange:S,onImportData:M});default:return null}};return(0,s.jsxs)(Ce.Z,{className:pe.layout,children:[(0,s.jsx)(an,{selectedKey:i,planItems:a,onMenuSelect:x,onClearAll:A}),(0,s.jsx)(vn,{className:pe.contentContainer,children:(0,s.jsx)("div",{className:pe.content,style:{backgroundColor:P,borderRadius:v},children:N()})})]})},fn=gn}}]);
