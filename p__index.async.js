"use strict";(self.webpackChunktravel_plan=self.webpackChunktravel_plan||[]).push([[866],{66320:function(Ha,De,g){g.r(De),g.d(De,{default:function(){return Ka}});var Le=g(48305),U=g.n(Le),j=g(75271),Pe=g(13273),We=g(51555),N=g(3988),he=g(28375),je=g(49418),Ne=g(37294),ne=g(92974),Oe=g(64921),Me=g(47083),$e=g(15558),ve=g.n($e),Ve=g(26068),K=g.n(Ve),Ue=g(67825),Je=g.n(Ue),Re=g(29153),Ke=g(73648),ge=g(11778),He=g(54637),ye=g(99546),be=g(5574),Ye=g(78434),Ge=g(90228),w=g.n(Ge),Qe=g(87999),z=g.n(Qe),Ie=g(34329),Xe=g(79306),qe=g(99247),_e=g(64533),ea={NODE_ENV:"production",PUBLIC_PATH:"/TravelPlan/"}.UMI_APP_AMAP_WEB_SERVICE_KEY,aa=function(){var C=z()(w()().mark(function u(n,a){var e,t;return w()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,_e.Z.get("https://restapi.amap.com/v5/place/text",{params:{key:ea,keywords:n,city:a,output:"json"}});case 3:if(e=i.sent,!(e.data&&e.data.status==="1"&&e.data.pois)){i.next=9;break}return t=e.data.pois.map(function(r){var d=r.location.split(","),s=U()(d,2),h=s[0],v=s[1];return{id:r.id,name:r.name,address:r.address,location:{lat:parseFloat(v),lng:parseFloat(h)},cityname:r.cityname,adname:r.adname}}),i.abrupt("return",t);case 9:return console.error("\u9AD8\u5FB7 API \u8FD4\u56DE\u9519\u8BEF:",e.data.info),i.abrupt("return",[]);case 11:i.next=17;break;case 13:return i.prev=13,i.t0=i.catch(0),console.error("\u641C\u7D22\u5730\u70B9\u8BF7\u6C42\u5931\u8D25:",i.t0),i.abrupt("return",[]);case 17:case"end":return i.stop()}},u,null,[[0,13]])}));return function(n,a){return C.apply(this,arguments)}}(),na=g(25298),pe=g.n(na),ra=g(17069),me=g.n(ra),ta=g(31759),la=g.n(ta),ia=function(){function C(){pe()(this,C)}return me()(C,[{key:"calculateSingleSegment",value:function(){var u=z()(w()().mark(function a(e,t,o,i){var r;return w()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:s.prev=0,s.t0=o,s.next=s.t0==="driving"?4:s.t0==="walking"?8:s.t0==="riding"?12:s.t0==="transfer"?16:20;break;case 4:return s.next=6,this.getDrivingRouteWithPolyline([e.lng,e.lat],[t.lng,t.lat]);case 6:return r=s.sent,s.abrupt("break",23);case 8:return s.next=10,this.getWalkingRouteWithPolyline([e.lng,e.lat],[t.lng,t.lat]);case 10:return r=s.sent,s.abrupt("break",23);case 12:return s.next=14,this.getRidingRouteWithPolyline([e.lng,e.lat],[t.lng,t.lat]);case 14:return r=s.sent,s.abrupt("break",23);case 16:return s.next=18,this.getTransferRouteWithPolyline([e.lng,e.lat],[t.lng,t.lat],"\u676D\u5DDE");case 18:return r=s.sent,s.abrupt("break",23);case 20:return s.next=22,this.getDrivingRouteWithPolyline([e.lng,e.lat],[t.lng,t.lat]);case 22:r=s.sent;case 23:return s.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:t.name,position:[t.lng,t.lat]},distance:r.distance,duration:r.duration,mode:o,polyline:r.polyline||[],success:r.success,error:r.error});case 26:return s.prev=26,s.t1=s.catch(0),console.error("\u8DEF\u6BB5\u8BA1\u7B97\u5931\u8D25:",s.t1),s.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:t.name,position:[t.lng,t.lat]},distance:0,duration:0,mode:o,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 30:case"end":return s.stop()}},a,this,[[0,26]])}));function n(a,e,t,o){return u.apply(this,arguments)}return n}()},{key:"getDrivingRouteWithPolyline",value:function(){var u=z()(w()().mark(function a(e,t){var o=this;return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,ce();case 3:r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(de("driving")){r.next=10;break}return r.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return r.abrupt("return",new Promise(function(d){var s=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});s.search(e,t,function(h,v){if(h==="complete"&&v.routes&&v.routes.length>0){var p=v.routes[0],R=o.extractPolylineFromRoute(p);d({mode:"driving",distance:p.distance,duration:p.time,success:!0,polyline:R})}else d({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return r.stop()}},a,null,[[0,5]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getWalkingRouteWithPolyline",value:function(){var u=z()(w()().mark(function a(e,t){var o=this;return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,ce();case 3:r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(de("walking")){r.next=10;break}return r.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return r.abrupt("return",new Promise(function(d){var s=new window.AMap.Walking({map:null,autoFitView:!1});s.search(e,t,function(h,v){if(h==="complete"&&v.routes&&v.routes.length>0){var p=v.routes[0],R=o.extractPolylineFromRoute(p);d({mode:"walking",distance:p.distance,duration:p.time,success:!0,polyline:R})}else d({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return r.stop()}},a,null,[[0,5]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getRidingRouteWithPolyline",value:function(){var u=z()(w()().mark(function a(e,t){var o=this;return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,ce();case 3:r.next=8;break;case 5:return r.prev=5,r.t0=r.catch(0),r.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(de("riding")){r.next=10;break}return r.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return r.abrupt("return",new Promise(function(d){var s=new window.AMap.Riding({map:null,autoFitView:!1});s.search(e,t,function(h,v){if(h==="complete"&&v.routes&&v.routes.length>0){var p=v.routes[0],R=o.extractPolylineFromRoute(p);d({mode:"riding",distance:p.distance,duration:p.time||p.duration,success:!0,polyline:R})}else d({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return r.stop()}},a,null,[[0,5]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getTransferRouteWithPolyline",value:function(){var u=z()(w()().mark(function a(e,t){var o=this,i,r=arguments;return w()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=r.length>2&&r[2]!==void 0?r[2]:"\u676D\u5DDE",s.prev=1,s.next=4,ce();case 4:s.next=9;break;case 6:return s.prev=6,s.t0=s.catch(1),s.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 9:if(de("transfer")){s.next=11;break}return s.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 11:return s.abrupt("return",new Promise(function(h){var v=new window.AMap.Transfer({map:null,city:i,autoFitView:!1});v.search(e,t,function(p,R){if(p==="complete"&&R.plans&&R.plans.length>0){var b=R.plans[0],m=o.extractPolylineFromRoute(b);h({mode:"transfer",distance:b.distance,duration:b.time,success:!0,polyline:m})}else h({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 12:case"end":return s.stop()}},a,null,[[1,6]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"extractPolylineFromRoute",value:function(n){var a=this,e=[];if(n.rides&&Array.isArray(n.rides))return n.rides.forEach(function(o){o.path&&Array.isArray(o.path)&&o.path.forEach(function(i){var r=a.extractPosition(i);r&&e.push(r)})}),e;if(n.steps&&Array.isArray(n.steps))n.steps.forEach(function(o,i){if(o.polyline){var r=a.parsePolyline(o.polyline);e.push.apply(e,ve()(r))}else if(o.path&&Array.isArray(o.path))o.path.forEach(function(h,v){if(h&&la()(h)==="object"){var p,R;if(h.lng!==void 0&&h.lat!==void 0)p=h.lng,R=h.lat;else if(h.longitude!==void 0&&h.latitude!==void 0)p=h.longitude,R=h.latitude;else if(h.x!==void 0&&h.y!==void 0)p=h.x,R=h.y;else if(Array.isArray(h)&&h.length>=2)p=h[0],R=h[1];else if(h.getPosition&&typeof h.getPosition=="function"){var b=h.getPosition();p=b.getLng(),R=b.getLat()}p!==void 0&&R!==void 0&&!isNaN(p)&&!isNaN(R)&&e.push([p,R])}});else{if(o.start_location){var d=a.extractPosition(o.start_location);d&&e.push(d)}if(o.end_location){var s=a.extractPosition(o.end_location);s&&e.push(s)}}});else if(n.path&&Array.isArray(n.path))n.path.forEach(function(o,i){var r=a.extractPosition(o);r&&e.push(r)});else if(n.polyline){var t=this.parsePolyline(n.polyline);e.push.apply(e,ve()(t))}return e}},{key:"extractPosition",value:function(n){if(!n)return null;var a,e;if(n.lng!==void 0&&n.lat!==void 0)a=n.lng,e=n.lat;else if(n.longitude!==void 0&&n.latitude!==void 0)a=n.longitude,e=n.latitude;else if(n.x!==void 0&&n.y!==void 0)a=n.x,e=n.y;else if(Array.isArray(n)&&n.length>=2)a=n[0],e=n[1];else if(n.getPosition&&typeof n.getPosition=="function"){var t=n.getPosition();a=t.getLng(),e=t.getLat()}else n.getLng&&typeof n.getLng=="function"&&(a=n.getLng(),e=n.getLat());return a!==void 0&&e!==void 0&&!isNaN(a)&&!isNaN(e)?[a,e]:null}},{key:"parsePolyline",value:function(n){if(!n||typeof n!="string")return[];try{var a;n.includes(";")?a=n.split(";"):n.includes("|")?a=n.split("|"):n.includes(" ")?a=n.split(" "):a=[n];for(var e=[],t=0;t<a.length;t++){var o=a[t].trim();if(o){var i=o.split(",");if(i.length>=2){var r=parseFloat(i[0]),d=parseFloat(i[1]);!isNaN(r)&&!isNaN(d)&&r>=-180&&r<=180&&d>=-90&&d<=90&&e.push([r,d])}}}return e}catch(s){return[]}}}]),C}(),ua=new ia,sa=function(){var C=z()(w()().mark(function u(n,a,e,t){return w()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",ua.calculateSingleSegment(n,a,e,t));case 1:case"end":return i.stop()}},u)}));return function(n,a,e,t){return C.apply(this,arguments)}}(),oa=function(){function C(){pe()(this,C)}return me()(C,[{key:"getDrivingRoute",value:function(){var u=z()(w()().mark(function a(e,t){return w()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,ce();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(r){var d=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});d.search(e,t,function(s,h){if(s==="complete"&&h.routes&&h.routes.length>0){var v=h.routes[0];r({mode:"driving",distance:v.distance,duration:v.time,success:!0})}else r({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getWalkingRoute",value:function(){var u=z()(w()().mark(function a(e,t){return w()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,ce();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(r){var d=new window.AMap.Walking({map:null,showTraffic:!1,autoFitView:!1});d.search(e,t,function(s,h){if(s==="complete"&&h.routes&&h.routes.length>0){var v=h.routes[0];r({mode:"walking",distance:v.distance,duration:v.time,success:!0})}else r({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getRidingRoute",value:function(){var u=z()(w()().mark(function a(e,t){return w()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,ce();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(r){var d=new window.AMap.Riding({map:null,showTraffic:!1,autoFitView:!1});d.search(e,t,function(s,h){if(s==="complete"&&h.routes&&h.routes.length>0){var v=h.routes[0];r({mode:"riding",distance:v.distance,duration:v.time,success:!0})}else r({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getTransitRoute",value:function(){var u=z()(w()().mark(function a(e,t){var o,i=arguments;return w()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=i.length>2&&i[2]!==void 0?i[2]:"\u676D\u5DDE",d.prev=1,d.next=4,ce();case 4:d.next=9;break;case 6:return d.prev=6,d.t0=d.catch(1),d.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 9:return d.abrupt("return",new Promise(function(s){var h=new window.AMap.Transfer({map:null,city:o==="\u676D\u5DDE"?"\u5317\u4EAC":o,autoFitView:!1});h.search(e,t,function(v,p){if(v==="complete"&&p.plans&&p.plans.length>0){var R=p.plans[0];s({mode:"transfer",distance:R.distance,duration:R.time,success:!0})}else s({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 10:case"end":return d.stop()}},a,null,[[1,6]])}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"getAllRoutes",value:function(){var u=z()(w()().mark(function a(e,t){var o,i,r=arguments;return w()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=r.length>2&&r[2]!==void 0?r[2]:"\u676D\u5DDE",s.next=3,Promise.all([this.getDrivingRoute(e,t),this.getWalkingRoute(e,t),this.getRidingRoute(e,t),this.getTransitRoute(e,t,o)]);case 3:return i=s.sent,s.abrupt("return",i);case 5:case"end":return s.stop()}},a,this)}));function n(a,e){return u.apply(this,arguments)}return n}()},{key:"calculateCompleteRouteWithModes",value:function(){var u=z()(w()().mark(function a(e){var t,o,i,r,d,s,h,v,p;return w()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(e.length<2)){b.next=2;break}return b.abrupt("return",{segments:[],totalDistance:0,totalDuration:0,mode:"mixed",success:!1});case 2:t=[],o=0,i=0,r=0;case 6:if(!(r<e.length-1)){b.next=27;break}return d=e[r],s=e[r+1],h=d.mode||"driving",b.prev=10,console.log("\u8BA1\u7B97\u8DEF\u6BB5 ".concat(r+1,":"),d.name,"\u2192",s.name,"(".concat(h,")")),b.next=14,sa(d,s,h,"segment-".concat(r));case 14:v=b.sent,console.log("\u8DEF\u6BB5 ".concat(r+1," \u8BA1\u7B97\u7ED3\u679C:"),v),t.push(v),v.success&&(o+=v.distance,i+=v.duration),b.next=24;break;case 20:b.prev=20,b.t0=b.catch(10),console.error("\u8DEF\u6BB5 ".concat(d.name," \u2192 ").concat(s.name," \u8BA1\u7B97\u5931\u8D25:"),b.t0),t.push({id:"segment-".concat(r),startPoint:{name:d.name,position:[d.lng,d.lat]},endPoint:{name:s.name,position:[s.lng,s.lat]},distance:0,duration:0,mode:h,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 24:r++,b.next=6;break;case 27:return p={segments:t,totalDistance:o,totalDuration:i,mode:"mixed",success:t.some(function(m){return m.success})},console.log("\u5B8C\u6574\u8DEF\u7EBF\u8BA1\u7B97\u7ED3\u679C:",p),b.abrupt("return",p);case 30:case"end":return b.stop()}},a,null,[[10,20]])}));function n(a){return u.apply(this,arguments)}return n}()}]),C}(),ca=g(82092),oe=g.n(ca),xe=function(){function C(){pe()(this,C),oe()(this,"pluginsLoaded",!1),oe()(this,"availablePlugins",new Set)}return me()(C,[{key:"loadPlugins",value:function(){var u=z()(w()().mark(function a(){var e=this;return w()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.pluginsLoaded){o.next=2;break}return o.abrupt("return");case 2:return o.abrupt("return",new Promise(function(i,r){if(!window.AMap){r(new Error("AMap\u672A\u52A0\u8F7D"));return}var d=["AMap.Driving","AMap.Walking","AMap.Transfer","AMap.Riding"];window.AMap.plugin(d,function(){var s={"AMap.Driving":"driving","AMap.Walking":"walking","AMap.Transfer":"transfer","AMap.Riding":"riding"};d.forEach(function(h){var v=h.replace("AMap.","");if(window.AMap[v]){var p=s[h];p&&e.availablePlugins.add(p)}}),e.pluginsLoaded=!0,console.log("\u5DF2\u52A0\u8F7D\u7684\u63D2\u4EF6:",Array.from(e.availablePlugins)),i(void 0)})}));case 3:case"end":return o.stop()}},a,this)}));function n(){return u.apply(this,arguments)}return n}()},{key:"ensurePluginsLoaded",value:function(){var u=z()(w()().mark(function a(){return w()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.pluginsLoaded){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.loadPlugins();case 4:case"end":return t.stop()}},a,this)}));function n(){return u.apply(this,arguments)}return n}()},{key:"isPluginAvailable",value:function(n){return this.availablePlugins.has(n.toLowerCase())}},{key:"getAvailablePlugins",value:function(){return Array.from(this.availablePlugins)}},{key:"reset",value:function(){this.pluginsLoaded=!1,this.availablePlugins.clear()}}],[{key:"getInstance",value:function(){return C.instance||(C.instance=new C),C.instance}}]),C}();oe()(xe,"instance",void 0);var ce=function(){var C=z()(w()().mark(function u(){var n;return w()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=xe.getInstance(),e.next=3,n.ensurePluginsLoaded();case 3:case"end":return e.stop()}},u)}));return function(){return C.apply(this,arguments)}}(),de=function(u){var n=xe.getInstance();return n.isPluginAvailable(u)},re={driving:"\u9A7E\u8F66",walking:"\u6B65\u884C",riding:"\u9A91\u884C",transfer:"\u516C\u4EA4",mixed:"\u6DF7\u5408"},ue={driving:"#1890ff",walking:"#52c41a",riding:"#faad14",transfer:"#f759ab",mixed:"#13c2c2"},da=function(){function C(u){pe()(this,C),oe()(this,"map",void 0),oe()(this,"currentRouteInstance",null),oe()(this,"segmentInstances",[]),oe()(this,"segmentOverlays",[]),this.map=u}return me()(C,[{key:"drawDrivingRoute",value:function(n,a){var e=this;return new Promise(function(t){if(!de("driving")){t(!1);return}e.currentRouteInstance=new window.AMap.Driving({map:e.map,showTraffic:!1,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(o,i){o==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),t(!0)):(console.error("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",o,i),t(!1))})})}},{key:"drawWalkingRoute",value:function(n,a){var e=this;return new Promise(function(t){if(!de("walking")){t(!1);return}e.currentRouteInstance=new window.AMap.Walking({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(o,i){o==="complete"&&i.routes&&i.routes.length>0?(console.log("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),t(!0)):(console.error("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",o,i),t(!1))})})}},{key:"drawRidingRoute",value:function(n,a){var e=this;return new Promise(function(t){if(!de("riding")){t(!1);return}e.currentRouteInstance=new window.AMap.Riding({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(o,i){o==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),t(!0)):(console.error("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",o,i),t(!1))})})}},{key:"drawTransitRoute",value:function(n,a){var e=this;return new Promise(function(t){if(!de("transfer")){t(!1);return}e.currentRouteInstance=new window.AMap.Transfer({map:e.map,city:"\u676D\u5DDE",autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(o,i){o==="complete"&&i.plans&&i.plans.length>0?(console.log("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),t(!0)):(console.error("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",o,i),t(!1))})})}},{key:"drawRoute",value:function(){var u=z()(w()().mark(function a(e,t,o){return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,ce(),this.clearAllRoutes(),r.t0=o,r.next=r.t0==="driving"?6:r.t0==="walking"?7:r.t0==="riding"?8:r.t0==="transfer"?9:10;break;case 6:return r.abrupt("return",this.drawDrivingRoute(e,t));case 7:return r.abrupt("return",this.drawWalkingRoute(e,t));case 8:return r.abrupt("return",this.drawRidingRoute(e,t));case 9:return r.abrupt("return",this.drawTransitRoute(e,t));case 10:return r.abrupt("return",!1);case 11:r.next=17;break;case 13:return r.prev=13,r.t1=r.catch(0),console.error("\u7ED8\u5236\u8DEF\u7EBF\u5931\u8D25:",r.t1),r.abrupt("return",!1);case 17:case"end":return r.stop()}},a,this,[[0,13]])}));function n(a,e,t){return u.apply(this,arguments)}return n}()},{key:"clearAllRoutes",value:function(){var n=this;this.currentRouteInstance&&(this.currentRouteInstance.clear(),this.currentRouteInstance=null),this.segmentInstances.forEach(function(e){e&&e.clear&&e.clear()}),this.segmentInstances=[],this.segmentOverlays.forEach(function(e){e&&n.map.remove(e)}),this.segmentOverlays=[];var a=this.map.getAllOverlays("polyline");a.forEach(function(e){n.map.remove(e)})}},{key:"drawCompleteRoute",value:function(n){var a=this;if(console.log("\u5F00\u59CB\u7ED8\u5236\u5B8C\u6574\u8DEF\u7EBF:",n),this.clearAllRoutes(),!n.success||n.segments.length===0){console.log("\u6CA1\u6709\u6210\u529F\u7684\u8DEF\u7EBF\u6BB5\u53EF\u7ED8\u5236");return}var e=[];n.segments.forEach(function(t,o){if(t.success&&t.polyline&&t.polyline.length>1){console.log("\u7ED8\u5236\u8DEF\u6BB5 ".concat(o+1,":"),t.startPoint.name,"\u2192",t.endPoint.name,"polyline\u70B9\u6570:",t.polyline.length);var i=new window.AMap.Polyline({path:t.polyline,strokeColor:ue[t.mode]||"#1890ff",strokeWeight:6,strokeOpacity:.8,strokeStyle:"solid",showDir:!0,extData:{segmentId:t.id,segmentIndex:o}});a.map.add(i),a.segmentOverlays.push(i),e.push(i);var r=new window.AMap.Marker({position:t.startPoint.position,content:'<div style="background: '.concat(ue[t.mode],'; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">').concat(o===0?"\u8D77":o+1,"</div>"),title:t.startPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});if(a.map.add(r),a.segmentOverlays.push(r),e.push(r),o===n.segments.length-1){var d=new window.AMap.Marker({position:t.endPoint.position,content:'<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">\u7EC8</div>',title:t.endPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});a.map.add(d),a.segmentOverlays.push(d),e.push(d)}if(t.polyline.length>2){var s=Math.floor(t.polyline.length/2),h=t.polyline[s],v=new window.AMap.Marker({position:h,content:'<div style="background: '.concat(ue[t.mode],'; color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; border: 1px solid white; opacity: 0.9;">').concat(a.getModeIcon(t.mode),"</div>"),anchor:"center",offset:new window.AMap.Pixel(0,-10),zIndex:200});a.map.add(v),a.segmentOverlays.push(v),e.push(v)}}else console.log("\u8DF3\u8FC7\u5931\u8D25\u7684\u8DEF\u6BB5 ".concat(o+1,":"),t.error)}),e.length>0&&(console.log("\u8C03\u6574\u5730\u56FE\u89C6\u91CE\uFF0C\u8986\u76D6\u7269\u6570\u91CF:",e.length),this.map.setFitView(e,!1,[50,50,50,50])),console.log("\u5B8C\u6574\u8DEF\u7EBF\u7ED8\u5236\u5B8C\u6210\uFF0C\u603B\u8986\u76D6\u7269\u6570\u91CF:",this.segmentOverlays.length)}},{key:"getModeIcon",value:function(n){var a={driving:"\u{1F697}",walking:"\u{1F6B6}",riding:"\u{1F6B4}",transfer:"\u{1F68C}"};return a[n]||"\u25CF"}},{key:"highlightSegment",value:function(n){console.log("\u9AD8\u4EAE\u8DEF\u6BB5:",n),this.segmentOverlays.forEach(function(a){if(a.CLASS_NAME==="AMap.Polyline"||a.getPath){var e=a.getExtData();e&&e.segmentId===n?a.setOptions({strokeWeight:10,strokeOpacity:1,zIndex:100}):a.setOptions({strokeWeight:4,strokeOpacity:.4,zIndex:1})}})}},{key:"resetSegmentHighlight",value:function(){console.log("\u91CD\u7F6E\u8DEF\u6BB5\u9AD8\u4EAE"),this.segmentOverlays.forEach(function(n){(n.CLASS_NAME==="AMap.Polyline"||n.getPath)&&n.setOptions({strokeWeight:6,strokeOpacity:.8,zIndex:10})})}}]),C}(),ha=function(){function C(u){pe()(this,C),oe()(this,"calculationService",void 0),oe()(this,"drawingService",void 0),this.calculationService=new oa,this.drawingService=new da(u)}return me()(C,[{key:"getAllRoutes",value:function(){var u=z()(w()().mark(function a(e,t,o){return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.calculationService.getAllRoutes(e,t,o));case 1:case"end":return r.stop()}},a,this)}));function n(a,e,t){return u.apply(this,arguments)}return n}()},{key:"calculateCompleteRouteWithModes",value:function(){var u=z()(w()().mark(function a(e){return w()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.calculationService.calculateCompleteRouteWithModes(e));case 1:case"end":return o.stop()}},a,this)}));function n(a){return u.apply(this,arguments)}return n}()},{key:"drawRoute",value:function(){var u=z()(w()().mark(function a(e,t,o){return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.drawingService.drawRoute(e,t,o));case 1:case"end":return r.stop()}},a,this)}));function n(a,e,t){return u.apply(this,arguments)}return n}()},{key:"drawCompleteRoute",value:function(n){this.drawingService.drawCompleteRoute(n)}},{key:"clearAllRoutes",value:function(){this.drawingService.clearAllRoutes()}},{key:"highlightSegment",value:function(n){this.drawingService.highlightSegment(n)}},{key:"resetSegmentHighlight",value:function(){this.drawingService.resetSegmentHighlight()}}]),C}(),fa={NODE_ENV:"production",PUBLIC_PATH:"/TravelPlan/"}.UMI_APP_AMAP_JS_KEY,va={NODE_ENV:"production",PUBLIC_PATH:"/TravelPlan/"}.UMI_APP_AMAP_SECRET_KEY,ga=function(){return new Promise(function(u,n){if(window.AMap){u();return}window._AMapSecurityConfig={securityJsCode:va};var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src="https://webapi.amap.com/maps?v=2.0&key=".concat(fa),a.onload=function(){console.log("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u6210\u529F"),u()},a.onerror=function(e){console.error("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u5931\u8D25:",e),n(e)},document.head.appendChild(a)})},l=g(52676),pa=function(u){var n=u.value,a=n===void 0?"":n,e=u.onChange,t=u.onPlaceSelected,o=u.placeholder,i=o===void 0?"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22":o,r=u.city,d=r===void 0?"":r,s=(0,j.useState)(a),h=U()(s,2),v=h[0],p=h[1],R=(0,j.useState)([]),b=U()(R,2),m=b[0],y=b[1],P=(0,j.useState)(null),k=U()(P,2),f=k[0],M=k[1],H=(0,j.useState)(!1),X=U()(H,2),L=X[0],G=X[1],q=(0,j.useRef)(null);console.log("AMAP_KEY:",{NODE_ENV:"production",PUBLIC_PATH:"/TravelPlan/"}),(0,j.useEffect)(function(){p(a)},[a]);var J=function(Q,te){var _=te.place;M(_),p(_.name),e==null||e(_.name),t(_)},V=function(){M(null),p(""),e==null||e(""),t(null)},W=function(Q){if(p(Q),e==null||e(Q),!Q.trim()){y([]);return}q.current&&window.clearTimeout(q.current),G(!0),q.current=window.setTimeout(z()(w()().mark(function te(){var _,fe;return w()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,aa(Q,d);case 2:_=se.sent,fe=_.map(function(le){return{value:le.name,label:le.name,address:le.address,place:le}}),y(fe),G(!1);case 6:case"end":return se.stop()}},te)})),300)};return(0,l.jsx)("div",{style:{width:"100%"},children:(0,l.jsxs)(Ie.Z,{allowClear:{clearIcon:(0,l.jsx)(qe.Z,{})},value:v,options:m,onSelect:J,onSearch:W,onClear:V,placeholder:i,notFoundContent:L?"\u641C\u7D22\u4E2D...":"\u65E0\u5339\u914D\u7ED3\u679C",style:{width:"100%"},children:[m.map(function(Y){return(0,l.jsx)(Ie.Z.Option,{value:Y.value,"data-place":Y.place,children:(0,l.jsxs)("div",{className:"search-option",children:[(0,l.jsx)("div",{style:{fontWeight:"bold"},children:Y.label}),(0,l.jsx)("div",{style:{fontSize:"12px",color:"#999"},children:Y.address})]})},Y.value)}),f&&(0,l.jsx)(Xe.Z,{color:"blue",closable:!0,onClose:V,style:{marginTop:8},children:f.name})]})})},ma=pa,ya=g(41448),ba=[{value:"zhejiang",label:"\u6D59\u6C5F",children:[{value:"hangzhou",label:"\u676D\u5DDE"},{value:"ningbo",label:"\u5B81\u6CE2"},{value:"wenzhou",label:"\u6E29\u5DDE"},{value:"shaoxing",label:"\u7ECD\u5174"},{value:"huzhou",label:"\u6E56\u5DDE"},{value:"jiaxing",label:"\u5609\u5174"},{value:"zhoushan",label:"\u821F\u5C71"},{value:"quzhou",label:"\u8862\u5DDE"},{value:"taizhou",label:"\u53F0\u5DDE"},{value:"lishui",label:"\u4E3D\u6C34"}]},{value:"jiangsu",label:"\u6C5F\u82CF",children:[{value:"nanjing",label:"\u5357\u4EAC"},{value:"suzhou",label:"\u82CF\u5DDE"},{value:"wuxi",label:"\u65E0\u9521"},{value:"changzhou",label:"\u5E38\u5DDE"},{value:"zhenjiang",label:"\u9547\u6C5F"},{value:"nantong",label:"\u5357\u901A"},{value:"yangzhou",label:"\u626C\u5DDE"},{value:"taizhou",label:"\u6CF0\u5DDE"},{value:"xuzhou",label:"\u5F90\u5DDE"},{value:"huai an",label:"\u6DEE\u5B89"},{value:"yancheng",label:"\u76D0\u57CE"},{value:"lianyungang",label:"\u8FDE\u4E91\u6E2F"},{value:"suqian",label:"\u5BBF\u8FC1"}]},{value:"beijing",label:"\u5317\u4EAC",children:[{value:"beijing",label:"\u5317\u4EAC"}]},{value:"shanghai",label:"\u4E0A\u6D77",children:[{value:"shanghai",label:"\u4E0A\u6D77"}]},{value:"guangdong",label:"\u5E7F\u4E1C",children:[{value:"guangzhou",label:"\u5E7F\u5DDE"},{value:"shenzhen",label:"\u6DF1\u5733"},{value:"zhuhai",label:"\u73E0\u6D77"},{value:"shantou",label:"\u6C55\u5934"},{value:"foshan",label:"\u4F5B\u5C71"},{value:"dongguan",label:"\u4E1C\u839E"},{value:"zhongshan",label:"\u4E2D\u5C71"},{value:"jiangmen",label:"\u6C5F\u95E8"},{value:"huizhou",label:"\u60E0\u5DDE"},{value:"maoming",label:"\u8302\u540D"},{value:"zhanjiang",label:"\u6E5B\u6C5F"},{value:"meizhou",label:"\u6885\u5DDE"},{value:"qingyuan",label:"\u6E05\u8FDC"},{value:"shaoguan",label:"\u97F6\u5173"},{value:"yunfu",label:"\u4E91\u6D6E"},{value:"chaozhou",label:"\u6F6E\u5DDE"},{value:"jieyang",label:"\u63ED\u9633"},{value:"heyuan",label:"\u6CB3\u6E90"}]},{value:"sichuan",label:"\u56DB\u5DDD",children:[{value:"chengdu",label:"\u6210\u90FD"},{value:"mianyang",label:"\u7EF5\u9633"},{value:"deyang",label:"\u5FB7\u9633"},{value:"nanchong",label:"\u5357\u5145"},{value:"ziyang",label:"\u8D44\u9633"},{value:"zigong",label:"\u81EA\u8D21"},{value:"panzhihua",label:"\u6500\u679D\u82B1"},{value:"luzhou",label:"\u6CF8\u5DDE"},{value:"dazhou",label:"\u8FBE\u5DDE"},{value:"guangyuan",label:"\u5E7F\u5143"},{value:"yibin",label:"\u5B9C\u5BBE"},{value:"neijiang",label:"\u5185\u6C5F"},{value:"leshan",label:"\u4E50\u5C71"},{value:"bazhong",label:"\u5DF4\u4E2D"},{value:"yaan",label:"\u96C5\u5B89"},{value:"ganzi",label:"\u7518\u5B5C"},{value:"liangshan",label:"\u51C9\u5C71"},{value:"abazhou",label:"\u963F\u575D"}]},{value:"yunnan",label:"\u4E91\u5357",children:[{value:"kunming",label:"\u6606\u660E"},{value:"dali",label:"\u5927\u7406"},{value:"lijiang",label:"\u4E3D\u6C5F"},{value:"xishuangbanna",label:"\u897F\u53CC\u7248\u7EB3"},{value:"baoshan",label:"\u4FDD\u5C71"},{value:"chuxiong",label:"\u695A\u96C4"},{value:"dehong",label:"\u5FB7\u5B8F"},{value:"nujiang",label:"\u6012\u6C5F"},{value:"diqing",label:"\u8FEA\u5E86"},{value:"zhaotong",label:"\u662D\u901A"},{value:"qujing",label:"\u66F2\u9756"},{value:"yuxi",label:"\u7389\u6EAA"},{value:"honghe",label:"\u7EA2\u6CB3"},{value:"wenchuan",label:"\u6587\u5C71"},{value:"puer",label:"\u666E\u6D31"},{value:"linfen",label:"\u4E34\u6CA7"}]},{value:"hainan",label:"\u6D77\u5357",children:[{value:"haikou",label:"\u6D77\u53E3"},{value:"sanya",label:"\u4E09\u4E9A"},{value:"danzhou",label:"\u510B\u5DDE"},{value:"wuzhishan",label:"\u4E94\u6307\u5C71"},{value:"qionghai",label:"\u743C\u6D77"},{value:"wanning",label:"\u4E07\u5B81"},{value:"wenchang",label:"\u6587\u660C"},{value:"dongfang",label:"\u4E1C\u65B9"}]},{value:"hunan",label:"\u6E56\u5357",children:[{value:"changsha",label:"\u957F\u6C99"},{value:"zhuzhou",label:"\u682A\u6D32"},{value:"xiangtan",label:"\u6E58\u6F6D"},{value:"hengyang",label:"\u8861\u9633"},{value:"shaoyang",label:"\u90B5\u9633"},{value:"yueyang",label:"\u5CB3\u9633"},{value:"changde",label:"\u5E38\u5FB7"},{value:"zhangjiajie",label:"\u5F20\u5BB6\u754C"},{value:"yiyang",label:"\u76CA\u9633"},{value:"chenzhou",label:"\u90F4\u5DDE"},{value:"yongzhou",label:"\u6C38\u5DDE"},{value:"huaihua",label:"\u6000\u5316"},{value:"loudi",label:"\u5A04\u5E95"},{value:"xiangxi",label:"\u6E58\u897F"}]},{value:"hubei",label:"\u6E56\u5317",children:[{value:"wuhan",label:"\u6B66\u6C49"},{value:"huangshi",label:"\u9EC4\u77F3"},{value:"shiyan",label:"\u5341\u5830"},{value:"yichang",label:"\u5B9C\u660C"},{value:"xiangyang",label:"\u8944\u9633"},{value:"ezhou",label:"\u9102\u5DDE"},{value:"jingmen",label:"\u8346\u95E8"},{value:"xiaogan",label:"\u5B5D\u611F"},{value:"jingzhou",label:"\u8346\u5DDE"},{value:"huanggang",label:"\u9EC4\u5188"},{value:"xianning",label:"\u54B8\u5B81"},{value:"suizhou",label:"\u968F\u5DDE"},{value:"enshi",label:"\u6069\u65BD"}]},{value:"shandong",label:"\u5C71\u4E1C",children:[{value:"jinan",label:"\u6D4E\u5357"},{value:"qingdao",label:"\u9752\u5C9B"},{value:"zibo",label:"\u6DC4\u535A"},{value:"zaozhuang",label:"\u67A3\u5E84"},{value:"dongying",label:"\u4E1C\u8425"},{value:"yantai",label:"\u70DF\u53F0"},{value:"weifang",label:"\u6F4D\u574A"},{value:"jining",label:"\u6D4E\u5B81"},{value:"taian",label:"\u6CF0\u5B89"},{value:"weihai",label:"\u5A01\u6D77"},{value:"rizhao",label:"\u65E5\u7167"},{value:"laiwu",label:"\u83B1\u829C"},{value:"linyi",label:"\u4E34\u6C82"},{value:"dezhou",label:"\u5FB7\u5DDE"},{value:"liaocheng",label:"\u804A\u57CE"},{value:"binzhou",label:"\u6EE8\u5DDE"},{value:"heze",label:"\u83CF\u6CFD"}]}],Te={\u676D\u5DDE:[120.153576,30.287459],\u5B81\u6CE2:[121.549792,29.870244],\u6E29\u5DDE:[120.699374,27.994207],\u7ECD\u5174:[120.580045,30.023551],\u6E56\u5DDE:[120.097547,30.872655],\u5609\u5174:[120.756608,30.750483],\u821F\u5C71:[122.207217,30.025551],\u8862\u5DDE:[118.876444,28.946588],\u53F0\u5DDE:[121.420711,28.656387],\u4E3D\u6C34:[119.921033,28.451379],\u5357\u4EAC:[118.767413,32.041544],\u82CF\u5DDE:[120.585316,31.29888],\u65E0\u9521:[120.299393,31.573885],\u5E38\u5DDE:[119.955045,31.795574],\u9547\u6C5F:[119.452783,32.204402],\u5357\u901A:[120.864688,32.016175],\u626C\u5DDE:[119.421009,32.393152],\u6CF0\u5DDE:[119.915173,32.484882],\u5F90\u5DDE:[117.184811,34.261792],\u6DEE\u5B89:[119.015305,33.581511],\u76D0\u57CE:[120.139998,33.377631],\u8FDE\u4E91\u6E2F:[119.221617,34.576476],\u5BBF\u8FC1:[118.276837,33.939688],\u5317\u4EAC:[116.397428,39.90923],\u4E0A\u6D77:[121.473701,31.230416],\u5E7F\u5DDE:[113.280637,23.125178],\u6DF1\u5733:[114.085947,22.547],\u73E0\u6D77:[113.576726,22.270703],\u6C55\u5934:[116.683828,23.355818],\u4F5B\u5C71:[113.122717,23.028595],\u4E1C\u839E:[113.75179,23.020748],\u4E2D\u5C71:[113.382333,22.521112],\u6C5F\u95E8:[113.094175,22.589016],\u60E0\u5DDE:[114.412605,23.07942],\u8302\u540D:[110.919231,21.659752],\u6E5B\u6C5F:[110.359377,21.270679],\u6885\u5DDE:[116.119268,24.299056],\u6E05\u8FDC:[113.04789,24.325153],\u97F6\u5173:[113.598407,24.809434],\u4E91\u6D6E:[112.044382,22.927393],\u6F6E\u5DDE:[116.632303,23.661951],\u63ED\u9633:[116.355529,23.543716],\u6CB3\u6E90:[114.697808,23.746275],\u6210\u90FD:[104.065735,30.659462],\u7EF5\u9633:[104.741657,31.455295],\u5FB7\u9633:[104.394943,31.128142],\u5357\u5145:[106.082976,30.795771],\u8D44\u9633:[104.641797,30.123222],\u81EA\u8D21:[104.778442,29.359089],\u6500\u679D\u82B1:[101.718636,26.582347],\u6CF8\u5DDE:[105.443737,28.878649],\u8FBE\u5DDE:[107.502627,31.209818],\u5E7F\u5143:[105.828737,32.433767],\u5B9C\u5BBE:[104.569279,28.763023],\u5185\u6C5F:[105.052014,29.582056],\u4E50\u5C71:[103.761017,29.563017],\u5DF4\u4E2D:[106.753537,31.857465],\u96C5\u5B89:[103.001858,29.98289],\u7518\u5B5C:[100.233394,30.050591],\u51C9\u5C71:[102.266365,27.902191],\u963F\u575D:[102.22435,31.898394],\u6606\u660E:[102.832892,24.880095],\u5927\u7406:[100.228445,25.616545],\u4E3D\u6C5F:[100.226146,26.864494],\u897F\u53CC\u7248\u7EB3:[100.799647,22.003307],\u4FDD\u5C71:[99.166606,25.111631],\u695A\u96C4:[101.543757,25.036331],\u5FB7\u5B8F:[98.577494,24.439671],\u6012\u6C5F:[98.854247,26.648914],\u8FEA\u5E86:[99.708255,27.825172],\u662D\u901A:[103.717158,27.318388],\u66F2\u9756:[103.797387,25.496423],\u7389\u6EAA:[102.539095,24.350431],\u7EA2\u6CB3:[102.818658,23.369552],\u6587\u5C71:[104.24427,23.369998],\u666E\u6D31:[100.973858,22.775479],\u4E34\u6CA7:[100.089039,23.885899],\u6D77\u53E3:[110.33119,20.031971],\u4E09\u4E9A:[109.731928,18.249575],\u510B\u5DDE:[109.340454,19.517126],\u4E94\u6307\u5C71:[109.517624,18.773724],\u743C\u6D77:[110.466989,19.256953],\u4E07\u5B81:[110.389319,18.798578],\u6587\u660C:[110.77781,19.810778],\u4E1C\u65B9:[108.653813,19.09708],\u957F\u6C99:[112.973895,28.196059],\u682A\u6D32:[113.132898,27.831873],\u6E58\u6F6D:[112.944048,27.829724],\u8861\u9633:[112.580162,26.898242],\u90B5\u9633:[111.467124,27.237843],\u5CB3\u9633:[113.089684,29.363969],\u5E38\u5FB7:[111.691585,29.030896],\u5F20\u5BB6\u754C:[110.479298,29.127356],\u76CA\u9633:[112.339719,28.567383],\u90F4\u5DDE:[113.032259,25.774173],\u6C38\u5DDE:[111.608017,26.430765],\u6000\u5316:[109.959052,27.537304],\u5A04\u5E95:[112.003673,27.728183],\u6E58\u897F:[109.739779,28.312699],\u6B66\u6C49:[114.298572,30.584355],\u9EC4\u77F3:[115.096794,30.185835],\u5341\u5830:[110.788111,32.646473],\u5B9C\u660C:[111.290804,30.693176],\u8944\u9633:[112.14414,32.042451],\u9102\u5DDE:[114.888993,30.390928],\u8346\u95E8:[112.203958,31.035758],\u5B5D\u611F:[113.917078,30.916557],\u8346\u5DDE:[112.239204,30.329688],\u9EC4\u5188:[114.879454,30.436752],\u54B8\u5B81:[113.868505,29.839171],\u968F\u5DDE:[113.364104,31.708469],\u6069\u65BD:[109.489134,30.274575],\u6D4E\u5357:[117.020048,36.667524],\u9752\u5C9B:[120.382602,36.064357],\u6DC4\u535A:[118.047644,36.788883],\u67A3\u5E84:[117.323134,34.818489],\u4E1C\u8425:[118.492963,37.461484],\u70DF\u53F0:[121.391446,37.539289],\u6F4D\u574A:[119.160833,36.649827],\u6D4E\u5B81:[116.587269,35.389439],\u6CF0\u5B89:[117.087156,36.184069],\u5A01\u6D77:[122.121559,37.51284],\u65E5\u7167:[119.477875,35.417796],\u83B1\u829C:[117.659763,36.211577],\u4E34\u6C82:[118.356384,35.065087],\u5FB7\u5DDE:[116.357594,37.455084],\u804A\u57CE:[115.975435,36.456405],\u6EE8\u5DDE:[117.971797,37.38421],\u83CF\u6CFD:[115.469381,35.246531],\u5168\u56FD:[104.195397,35.86166]},wa=function(u){var n=u.value,a=n===void 0?"":n,e=u.onChange;return(0,l.jsx)(ya.Z,{defaultValue:["\u6D59\u6C5F","\u676D\u5DDE"],options:ba,onChange:e})},Sa=wa,ka=g(17114),we=g(87263),Ca=["data-row-key"],Pa=function(u){var n=u["data-row-key"],a=Je()(u,Ca),e=(0,ye.nB)({id:n}),t=e.attributes,o=e.listeners,i=e.setNodeRef,r=e.transform,d=e.transition,s=e.isDragging,h=K()(K()({},a.style),{},{transform:Ye.ux.Translate.toString(r),transition:d,cursor:"move"},s?{position:"relative",zIndex:999,background:"#fafafa"}:{});return(0,l.jsx)("tr",K()(K()(K()(K()({},a),{},{ref:i,style:h},t),o),{},{"data-row-key":n}))},Ra=function(u){var n=u.items,a=u.setItems,e=u.isSubmitted,t=e===void 0?!1:e,o=u.onSubmit,i=u.onEdit,r=u.onImportData,d=(0,j.useState)(n),s=U()(d,2),h=s[0],v=s[1],p=(0,j.useState)(!1),R=U()(p,2),b=R[0],m=R[1],y=(0,j.useState)(null),P=U()(y,2),k=P[0],f=P[1],M=(0,j.useState)("\u676D\u5DDE"),H=U()(M,2),X=H[0],L=H[1];j.useEffect(function(){v(n)},[n]);var G=(0,be.Dy)((0,be.VT)(be.we,{activationConstraint:{distance:5}})),q=function(x){var S=x.active,E=x.over;if(S.id!==(E==null?void 0:E.id)){var c=h.findIndex(function(O){return O.id===S.id}),B=h.findIndex(function(O){return O.id===E.id}),A=(0,ye.Rp)(h,c,B);v(A),a(A)}},J=function(){var x=n.filter(function(S){return S.checked});if(x.length<2){Re.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u81F3\u5C11\u9009\u62E92\u4E2A\u666F\u70B9\u624D\u80FD\u63D0\u4EA4\u884C\u7A0B"});return}o==null||o()},V=function(){i==null||i()},W=function(){var x=document.createElement("input");x.type="file",x.accept=".json",x.onchange=function(S){var E,c=(E=S.target.files)===null||E===void 0?void 0:E[0];if(c){var B=new FileReader;B.onload=function(A){try{var O,$=JSON.parse((O=A.target)===null||O===void 0?void 0:O.result);if($.spots&&Array.isArray($.spots)){var D=$.spots.map(function(Z,ie){var I,ee;return{id:"imported-".concat(Date.now(),"-").concat(ie),name:Z.name,location:Z.location||Z.name,region:Z.region||"\u672A\u77E5",lat:((I=Z.coordinates)===null||I===void 0?void 0:I.latitude)||Z.lat,lng:((ee=Z.coordinates)===null||ee===void 0?void 0:ee.longitude)||Z.lng,isStart:ie===0,isEnd:ie===$.spots.length-1,mode:Z.transportMode||Z.mode||"driving",checked:!1}});r?r(D):a(function(Z){return[].concat(ve()(Z),ve()(D))}),N.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(D.length," \u4E2A\u666F\u70B9"))}else N.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u6B63\u786E\u7684JSON\u6587\u4EF6")}catch(Z){console.error("\u5BFC\u5165\u6587\u4EF6\u89E3\u6790\u5931\u8D25:",Z),N.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5JSON\u683C\u5F0F")}},B.readAsText(c)}},x.click()},Y=function(x){a(function(S){return S.map(function(E){return K()(K()({},E),{},{isStart:E.id===x,isEnd:E.isEnd&&E.id!==x})})})},Q=function(x){a(function(S){return S.map(function(E){return K()(K()({},E),{},{isEnd:E.id===x,isStart:E.isStart&&E.id!==x})})})},te=function(x){a(function(S){return S.filter(function(E){return E.id!==x})})},_=function(){f(null),m(!0),L("\u676D\u5DDE")},fe=function(){if(!k){Re.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u666F\u70B9"});return}var x={id:"pois-".concat(Date.now()),name:k.name,location:k.address,region:k.cityname||X,lat:k==null?void 0:k.location.lat,lng:k==null?void 0:k.location.lng,isStart:!1,isEnd:!1,mode:"driving",checked:!1};a(function(S){return[].concat(ve()(S),[x])}),m(!1),f(null)},ke=function(){m(!1),f(null)},se={type:"checkbox",selectedRowKeys:n.filter(function(F){return F.checked}).map(function(F){return F.id}),onChange:function(x,S){a(function(E){return E.map(function(c){return K()(K()({},c),{},{checked:x.includes(c.id)})})})},onSelect:function(x,S,E){a(function(c){return c.map(function(B){return B.id===x.id?K()(K()({},B),{},{checked:S}):B})})},onSelectAll:function(x,S,E){a(function(c){return c.map(function(B){return K()(K()({},B),{},{checked:x})})})},getCheckboxProps:function(x){return{disabled:t,name:x.name}},columnTitle:t?"\u9009\u62E9\u72B6\u6001":(0,l.jsx)(Ke.Z,{indeterminate:n.some(function(F){return F.checked})&&!n.every(function(F){return F.checked}),checked:n.length>0&&n.every(function(F){return F.checked}),disabled:t||n.length===0,onChange:function(x){var S=x.target.checked;a(function(E){return E.map(function(c){return K()(K()({},c),{},{checked:S})})})}}),columnWidth:60},le=[{title:t?"\u884C\u7A0B\u987A\u5E8F":"\u666F\u70B9",dataIndex:"name",width:200,render:function(x,S,E){return(0,l.jsxs)(he.Z,{gap:"middle",align:"center",children:[t&&S.checked&&(0,l.jsx)("div",{style:{minWidth:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#1890ff",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:n.filter(function(c){return c.checked}).findIndex(function(c){return c.id===S.id})+1}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{fontWeight:S.isStart||S.isEnd?"bold":"normal"},children:[S.isStart&&(0,l.jsx)("span",{style:{color:"#52c41a",marginRight:4},children:"[\u8D77\u70B9]"}),S.isEnd&&(0,l.jsx)("span",{style:{color:"#ff4d4f",marginRight:4},children:"[\u7EC8\u70B9]"}),x]}),(0,l.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:S.location})]})]})}},{title:"\u51FA\u884C\u65B9\u5F0F",dataIndex:"mode",width:100,render:function(x,S){return(0,l.jsxs)(ge.default,{value:x,style:{width:70},disabled:t,onChange:function(c){a(function(B){return B.map(function(A){return A.id===S.id?K()(K()({},A),{},{mode:c}):A})})},children:[(0,l.jsx)(ge.default.Option,{value:"driving",children:"\u9A7E\u8F66"}),(0,l.jsx)(ge.default.Option,{value:"walking",children:"\u6B65\u884C"}),(0,l.jsx)(ge.default.Option,{value:"riding",children:"\u9A91\u884C"}),(0,l.jsx)(ge.default.Option,{value:"transfer",children:"\u516C\u4EA4"})]})}},{title:"\u64CD\u4F5C",key:"action",width:150,render:function(x,S){return(0,l.jsxs)(he.Z,{gap:4,wrap:!0,children:[!t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ne.ZP,{size:"small",type:S.isStart?"primary":"default",onClick:function(){return Y(S.id)},children:S.isStart?"\u8D77\u70B9":"\u8BBE\u4E3A\u8D77\u70B9"}),(0,l.jsx)(ne.ZP,{size:"small",type:S.isEnd?"primary":"default",onClick:function(){return Q(S.id)},children:S.isEnd?"\u7EC8\u70B9":"\u8BBE\u4E3A\u7EC8\u70B9"}),(0,l.jsx)(ne.ZP,{size:"small",variant:"link",color:"danger",onClick:function(){return te(S.id)},children:"\u5220\u9664"})]}),t&&(0,l.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:S.checked?"\u5DF2\u9009\u62E9":"\u672A\u9009\u62E9"})]})}}];return(0,l.jsxs)(he.Z,{vertical:!0,style:{height:"100%"},children:[(0,l.jsx)(be.LB,{sensors:G,onDragEnd:q,children:(0,l.jsx)(ye.Fo,{items:h.map(function(F){return F.id}),strategy:ye.qw,children:(0,l.jsx)(He.Z,{components:{body:{row:Pa}},rowKey:"id",columns:le,dataSource:h,pagination:!1,scroll:{y:"calc(100vh - 260px)"},rowSelection:t?void 0:se,style:{background:"#fff",flex:1,position:"relative",zIndex:1},locale:{emptyText:(0,l.jsxs)("div",{style:{padding:"60px 20px",textAlign:"center",color:"#999"},children:[(0,l.jsx)("div",{style:{fontSize:"16px",marginBottom:"8px"},children:"\u6682\u65E0\u666F\u70B9\u6570\u636E"}),(0,l.jsx)("div",{style:{fontSize:"14px"},children:'\u70B9\u51FB\u4E0B\u65B9"\u65B0\u589E\u666F\u70B9"\u6309\u94AE\u6DFB\u52A0\u60A8\u60F3\u53BB\u7684\u5730\u65B9'})]})}})})}),(0,l.jsxs)(he.Z,{justify:"space-between",style:{padding:"16px 0",flexShrink:0},children:[(0,l.jsxs)(he.Z,{gap:"middle",children:[(0,l.jsx)(ne.ZP,{type:"primary",icon:(0,l.jsx)(ka.Z,{}),onClick:_,disabled:t,children:"\u65B0\u589E\u666F\u70B9"}),(0,l.jsx)(ne.ZP,{icon:(0,l.jsx)(we.Z,{}),onClick:W,disabled:t,title:"\u4ECEJSON\u6587\u4EF6\u6279\u91CF\u5BFC\u5165\u666F\u70B9",children:"\u5BFC\u5165\u666F\u70B9"})]}),(0,l.jsxs)(Re.Z,{title:"\u65B0\u589E\u666F\u70B9",open:b,onOk:fe,onCancel:ke,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",zIndex:1e4,getContainer:function(){return document.body},children:[(0,l.jsxs)("div",{style:{marginBottom:16},children:[(0,l.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u57CE\u5E02\u8303\u56F4"}),(0,l.jsx)(Sa,{onChange:function(x,S){if(S&&S.length>0){var E=S[S.length-1].label;L(E)}else L("\u676D\u5DDE")}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u9009\u62E9\u666F\u70B9"}),(0,l.jsx)(ma,{onPlaceSelected:f,placeholder:"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22",city:X==="\u676D\u5DDE"?"":X},X),k&&(0,l.jsxs)("div",{style:{marginTop:8,padding:8,background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4},children:[(0,l.jsx)("div",{style:{fontWeight:"bold"},children:k.name}),(0,l.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:k.address})]})]})]}),(0,l.jsx)(he.Z,{gap:"middle",children:t?(0,l.jsx)(ne.ZP,{onClick:V,children:"\u8FD4\u56DE\u7F16\u8F91"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ne.ZP,{type:"default",children:"\u7F16\u8F91"}),(0,l.jsx)(ne.ZP,{type:"primary",onClick:J,children:"\u63D0\u4EA4\u884C\u7A0B"})]})})]})]})},xa=Ra,Aa=g(35937),ze=g(4388),Se=g(62826),Ea=g(87056),Fa=g(86422),Ba=function(u){var n=u.planItems,a=u.completeRoute,e=u.isSubmitted,t=u.onImportData,o=function(){if(!e||!a)return"";var b=n.filter(function(y){return y.checked}),m=`\u65C5\u884C\u884C\u7A0B\u8BA1\u5212
`;return m+="\u751F\u6210\u65F6\u95F4: ".concat(new Date().toLocaleString(),`
`),m+=`=====================================

`,m+=`\u884C\u7A0B\u6982\u89C8:
`,m+="\u666F\u70B9\u6570\u91CF: ".concat(b.length,`\u4E2A
`),m+="\u8DEF\u6BB5\u6570\u91CF: ".concat(a.segments.length,`\u6BB5
`),m+="\u603B\u8DDD\u79BB: ".concat((a.totalDistance/1e3).toFixed(1),`km
`),m+="\u603B\u65F6\u95F4: ".concat(Math.ceil(a.totalDuration/60),`\u5206\u949F
`),m+="\u6210\u529F\u8DEF\u6BB5: ".concat(a.segments.filter(function(y){return y.success}).length,"/").concat(a.segments.length,`\u6BB5

`),m+=`\u666F\u70B9\u5217\u8868:
`,b.forEach(function(y,P){m+="".concat(P+1,". ").concat(y.name,`
`),m+="   \u4F4D\u7F6E: ".concat(y.location,`
`),m+="   \u5750\u6807: ".concat(y.lat,", ").concat(y.lng,`
`),m+="   \u51FA\u884C\u65B9\u5F0F: ".concat(re[y.mode],`

`)}),m+=`\u8DEF\u7EBF\u8BE6\u60C5:
`,a.segments.forEach(function(y,P){m+="\u8DEF\u6BB5 ".concat(P+1,": ").concat(y.startPoint.name," \u2192 ").concat(y.endPoint.name,`
`),y.success?(m+="   \u8DDD\u79BB: ".concat((y.distance/1e3).toFixed(1),`km
`),m+="   \u65F6\u95F4: ".concat(Math.ceil(y.duration/60),`\u5206\u949F
`),m+="   \u65B9\u5F0F: ".concat(re[y.mode],`
`)):m+="   \u72B6\u6001: \u8BA1\u7B97\u5931\u8D25 - ".concat(y.error,`
`),m+=`
`}),m},i=function(){try{var b=o(),m=new Blob([b],{type:"text/plain;charset=utf-8"}),y=URL.createObjectURL(m),P=document.createElement("a");P.href=y,P.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(y),N.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6")}catch(k){console.error("\u5BFC\u51FA\u6587\u672C\u6587\u4EF6\u5931\u8D25:",k),N.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},r=function(){try{var b=n.filter(function(f){return f.checked}),m={metadata:{title:"\u65C5\u884C\u884C\u7A0B\u8BA1\u5212",exportTime:new Date().toISOString(),version:"1.0"},summary:{totalSpots:b.length,totalSegments:(a==null?void 0:a.segments.length)||0,totalDistance:(a==null?void 0:a.totalDistance)||0,totalDuration:(a==null?void 0:a.totalDuration)||0,successSegments:(a==null?void 0:a.segments.filter(function(f){return f.success}).length)||0},spots:b.map(function(f,M){return{order:M+1,id:f.id,name:f.name,location:f.location,region:f.region,coordinates:{latitude:f.lat,longitude:f.lng},transportMode:f.mode,transportModeName:re[f.mode]}}),routes:(a==null?void 0:a.segments.map(function(f,M){var H;return{segmentId:f.id,order:M+1,from:{name:f.startPoint.name,coordinates:f.startPoint.position},to:{name:f.endPoint.name,coordinates:f.endPoint.position},distance:f.distance,duration:f.duration,mode:f.mode,modeName:re[f.mode],success:f.success,error:f.error,polylinePoints:((H=f.polyline)===null||H===void 0?void 0:H.length)||0}}))||[]},y=new Blob([JSON.stringify(m,null,2)],{type:"application/json;charset=utf-8"}),P=URL.createObjectURL(y),k=document.createElement("a");k.href=P,k.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(P),N.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6")}catch(f){console.error("\u5BFC\u51FAJSON\u6587\u4EF6\u5931\u8D25:",f),N.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},d=function(){try{var b=n.filter(function(f){return f.checked}),m="\uFEFF";m+=`\u5E8F\u53F7,\u666F\u70B9\u540D\u79F0,\u4F4D\u7F6E,\u5730\u533A,\u7EAC\u5EA6,\u7ECF\u5EA6,\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0
`,b.forEach(function(f,M){m+="".concat(M+1,',"').concat(f.name,'","').concat(f.location,'","').concat(f.region,'",').concat(f.lat,",").concat(f.lng,',"').concat(f.mode,'","').concat(re[f.mode],`"
`)}),a&&a.segments.length>0&&(m+=`
\u8DEF\u6BB5\u5E8F\u53F7,\u8D77\u70B9,\u7EC8\u70B9,\u8DDD\u79BB(\u7C73),\u65F6\u95F4(\u79D2),\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0,\u72B6\u6001,\u9519\u8BEF\u4FE1\u606F
`,a.segments.forEach(function(f,M){m+="".concat(M+1,',"').concat(f.startPoint.name,'","').concat(f.endPoint.name,'",').concat(f.distance,",").concat(f.duration,',"').concat(f.mode,'","').concat(re[f.mode],'","').concat(f.success?"\u6210\u529F":"\u5931\u8D25",'","').concat(f.error||"",`"
`)}));var y=new Blob([m],{type:"text/csv;charset=utf-8"}),P=URL.createObjectURL(y),k=document.createElement("a");k.href=P,k.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(P),N.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6")}catch(f){console.error("\u5BFC\u51FACSV\u6587\u4EF6\u5931\u8D25:",f),N.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},s=function(){var b=document.createElement("input");b.type="file",b.accept=".json",b.onchange=function(m){var y,P=(y=m.target.files)===null||y===void 0?void 0:y[0];if(P){var k=new FileReader;k.onload=function(f){try{var M,H=JSON.parse((M=f.target)===null||M===void 0?void 0:M.result);if(H.spots&&Array.isArray(H.spots)){var X=H.spots.map(function(L,G){var q,J;return{id:"imported-".concat(Date.now(),"-").concat(G),name:L.name,location:L.location||L.name,region:L.region||"\u672A\u77E5",lat:((q=L.coordinates)===null||q===void 0?void 0:q.latitude)||L.lat,lng:((J=L.coordinates)===null||J===void 0?void 0:J.longitude)||L.lng,isStart:G===0,isEnd:G===H.spots.length-1,mode:L.transportMode||L.mode||"driving",checked:!0}});t?(t(X),N.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(X.length," \u4E2A\u666F\u70B9"))):N.ZP.error("\u5BFC\u5165\u529F\u80FD\u4E0D\u53EF\u7528")}else N.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u6B63\u786E\u7684JSON\u6587\u4EF6")}catch(L){console.error("\u5BFC\u5165\u6587\u4EF6\u89E3\u6790\u5931\u8D25:",L),N.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5JSON\u683C\u5F0F")}},k.readAsText(P)}},b.click()},h=function(){var R=z()(w()().mark(function b(){var m;return w()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,m=o(),P.next=4,navigator.clipboard.writeText(m);case 4:N.ZP.success("\u884C\u7A0B\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"),P.next=11;break;case 7:P.prev=7,P.t0=P.catch(0),console.error("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25:",P.t0),N.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236");case 11:case"end":return P.stop()}},b,null,[[0,7]])}));return function(){return R.apply(this,arguments)}}(),v=function(){try{var b=n.filter(function(k){return k.checked}),m={spots:b.map(function(k){return{name:k.name,lat:k.lat,lng:k.lng,mode:k.mode}})},y=encodeURIComponent(JSON.stringify(m)),P="".concat(window.location.origin).concat(window.location.pathname,"?share=").concat(y);navigator.clipboard.writeText(P),N.ZP.success("\u5206\u4EAB\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch(k){console.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",k),N.ZP.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25")}},p=[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,l.jsx)(we.Z,{}),onClick:s},{key:"txt",label:"\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6",icon:(0,l.jsx)(Se.Z,{}),onClick:i},{key:"json",label:"\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6",icon:(0,l.jsx)(Se.Z,{}),onClick:r},{key:"csv",label:"\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6",icon:(0,l.jsx)(Ea.Z,{}),onClick:d},{key:"copy",label:"\u590D\u5236\u5230\u526A\u8D34\u677F",icon:(0,l.jsx)(Se.Z,{}),onClick:h},{key:"share",label:"\u751F\u6210\u5206\u4EAB\u94FE\u63A5",icon:(0,l.jsx)(Se.Z,{}),onClick:v}];return!e||!a||a.segments.length===0?(0,l.jsx)(ze.Z,{menu:{items:[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,l.jsx)(we.Z,{}),onClick:s}]},placement:"bottomRight",trigger:["click"],children:(0,l.jsx)(ne.ZP,{type:"primary",size:"small",icon:(0,l.jsx)(we.Z,{}),title:"\u5BFC\u5165\u884C\u7A0B\u6570\u636E",children:"\u5BFC\u5165"})}):(0,l.jsx)(ze.Z,{menu:{items:p},placement:"bottomRight",trigger:["click"],children:(0,l.jsx)(ne.ZP,{type:"primary",size:"small",icon:(0,l.jsx)(Fa.Z,{}),children:"\u5BFC\u51FA"})})},Da=Ba,ja=function(u){var n=u.planItems,a=u.isSubmitted,e=a===void 0?!1:a,t=u.city,o=t===void 0?"\u676D\u5DDE":t,i=u.onImportData,r=(0,j.useRef)(null),d=(0,j.useRef)(null),s=(0,j.useRef)(null),h=(0,j.useState)([]),v=U()(h,2),p=v[0],R=v[1],b=(0,j.useState)(null),m=U()(b,2),y=m[0],P=m[1],k=(0,j.useState)("driving"),f=U()(k,2),M=f[0],H=f[1],X=(0,j.useState)(null),L=U()(X,2),G=L[0],q=L[1],J=(0,j.useState)(!1),V=U()(J,2),W=V[0],Y=V[1],Q=(0,j.useState)(!0),te=U()(Q,2),_=te[0],fe=te[1],ke=(0,j.useState)(!1),se=U()(ke,2),le=se[0],F=se[1];(0,j.useEffect)(function(){var c=function(){var B=z()(w()().mark(function A(){var O;return w()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(r.current){D.next=2;break}return D.abrupt("return");case 2:return D.prev=2,D.next=5,ga();case 5:return O=Te[o]||Te.\u676D\u5DDE,d.current=new window.AMap.Map(r.current,{zoom:o==="\u676D\u5DDE"?4:11,center:O,mapStyle:"amap://styles/normal",showLabel:!0,showBuildingBlock:!0,viewMode:"2D",pitch:0,skyColor:"#ffffff",features:["bg","point","road","building"],resizeEnable:!0,rotateEnable:!0,pitchEnable:!0,zoomEnable:!0,dragEnable:!0,keyboardEnable:!0,doubleClickZoom:!0,scrollWheel:!0,touchZoom:!0,touchZoomCenter:1,animateEnable:!0}),s.current=new ha(d.current),D.prev=8,D.next=11,new Promise(function(Z){window.AMap.plugin(["AMap.Scale","AMap.ToolBar","AMap.ControlBar"],function(){window.AMap.Scale&&d.current.addControl(new window.AMap.Scale({position:"LB"})),window.AMap.ToolBar&&d.current.addControl(new window.AMap.ToolBar({locate:!0,position:"LT",direction:!0,autoPosition:!1,locationMarker:!0,useNative:!0})),window.AMap.ControlBar&&d.current.addControl(new window.AMap.ControlBar({position:"RT"})),Z()})});case 11:D.next=16;break;case 13:D.prev=13,D.t0=D.catch(8),console.warn("\u5730\u56FE\u63A7\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u4F46\u4E0D\u5F71\u54CD\u4E3B\u8981\u529F\u80FD:",D.t0);case 16:fe(!1),D.next=23;break;case 19:D.prev=19,D.t1=D.catch(2),console.error("\u5730\u56FE\u521D\u59CB\u5316\u5931\u8D25:",D.t1),fe(!1);case 23:case"end":return D.stop()}},A,null,[[2,19],[8,13]])}));return function(){return B.apply(this,arguments)}}();return c(),function(){d.current&&(d.current.destroy(),d.current=null)}},[o]),(0,j.useEffect)(function(){if(!(!d.current||n.length===0)){var c=d.current.getAllOverlays("marker");c.forEach(function(A){d.current.remove(A)});var B=[];n.forEach(function(A,O){if(!(!A.lat||!A.lng)){var $="";if(e&&A.checked){var D=n.filter(function(I){return I.checked}),Z=D.findIndex(function(I){return I.id===A.id});$='<div style="background: #1890ff; color: white; padding: 6px 10px; border-radius: 50%; font-size: 14px; font-weight: bold; min-width: 28px; text-align: center;">'.concat(Z+1,"</div>")}else A.isStart?$='<div style="background: #52c41a; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u8D77\u70B9</div>':A.isEnd?$='<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u7EC8\u70B9</div>':$='<div style="background: #1890ff; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">'.concat(O+1,"</div>");var ie=new window.AMap.Marker({position:[A.lng,A.lat],content:$,title:A.name,anchor:"center",offset:new window.AMap.Pixel(0,-15),label:{content:A.name,direction:"top",offset:new window.AMap.Pixel(0,-10),style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"}}});B.push(ie),d.current.add(ie)}}),B.length>0&&d.current.setFitView(B,!1,[20,20,20,20])}},[n,e]),(0,j.useEffect)(function(){var c=function(){var B=z()(w()().mark(function A(){var O,$,D,Z,ie,I,ee,Ce,Fe,Be;return w()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!(!s.current||_)){T.next=2;break}return T.abrupt("return");case 2:if(!e){T.next=23;break}if(O=n.filter(function(ae){return ae.checked}),!(O.length<2)){T.next=7;break}return P(null),T.abrupt("return");case 7:return Y(!0),T.prev=8,T.next=11,s.current.calculateCompleteRouteWithModes(O);case 11:$=T.sent,P($),$.success&&$.segments.length>0&&(D=$.segments.filter(function(ae){return ae.success}).map(function(ae){return ae.mode}),D.length>0&&(Z=ve()(new Set(D)),Z.length===1?H(Z[0]):H("mixed")),s.current.drawCompleteRoute($)),T.next=20;break;case 16:T.prev=16,T.t0=T.catch(8),console.error("\u5B8C\u6574\u8DEF\u5F84\u8BA1\u7B97\u5931\u8D25:",T.t0),P(null);case 20:Y(!1),T.next=43;break;case 23:if(ie=n.find(function(ae){return ae.isStart}),I=n.find(function(ae){return ae.isEnd}),!(!ie||!I)){T.next=28;break}return R([]),T.abrupt("return");case 28:return Y(!0),T.prev=29,T.next=32,s.current.getAllRoutes([ie.lng,ie.lat],[I.lng,I.lat],o);case 32:ee=T.sent,R(ee),Ce=ee.filter(function(ae){return ae.success}),Ce.length>0&&(Be=((Fe=Ce.find(function(ae){return ae.mode==="driving"}))===null||Fe===void 0?void 0:Fe.mode)||Ce[0].mode,H(Be),S(Be)),T.next=42;break;case 38:T.prev=38,T.t1=T.catch(29),console.error("\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25:",T.t1),R([]);case 42:Y(!1);case 43:case"end":return T.stop()}},A,null,[[8,16],[29,38]])}));return function(){return B.apply(this,arguments)}}();c()},[n,_,o,e]);var x=function(B){i&&i(B)},S=function(){var c=z()(w()().mark(function B(A){var O,$,D,Z;return w()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!(!s.current||le||e)){I.next=2;break}return I.abrupt("return");case 2:if(O=n.find(function(ee){return ee.isStart}),$=n.find(function(ee){return ee.isEnd}),!(!O||!$)){I.next=6;break}return I.abrupt("return");case 6:if(D=p.find(function(ee){return ee.mode===A}),!(!D||!D.success)){I.next=9;break}return I.abrupt("return");case 9:return F(!0),H(A),I.prev=11,I.next=14,s.current.drawRoute([O.lng,O.lat],[$.lng,$.lat],A);case 14:Z=I.sent,Z||N.ZP.error("".concat(re[A],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25")),I.next=22;break;case 18:I.prev=18,I.t0=I.catch(11),console.error("\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",I.t0),N.ZP.error("".concat(re[A],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25"));case 22:F(!1);case 23:case"end":return I.stop()}},B,null,[[11,18]])}));return function(A){return c.apply(this,arguments)}}(),E=function(B){if(console.log("\u70B9\u51FB\u8DEF\u6BB5:",B,"\u5F53\u524D\u9009\u4E2D:",G),!s.current){console.error("routeService\u672A\u521D\u59CB\u5316");return}G===B?(q(null),s.current.resetSegmentHighlight()):(q(B),s.current.highlightSegment(B))};return(0,l.jsxs)("div",{style:{height:"80vh",width:"100%",border:"1px solid #e8e8e8",borderRadius:8,overflow:"auto"},children:[(0,l.jsx)("div",{style:{padding:"16px",background:"#f5f5f5",borderBottom:"1px solid #e8e8e8"},children:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{children:[_?"\u5730\u56FE\u52A0\u8F7D\u4E2D...":W?e?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u8DEF\u7EBF\u4E2D...":le?"\u6B63\u5728\u7ED8\u5236".concat(re[M],"\u8DEF\u7EBF..."):e?y&&y.success?"\u5B8C\u6574\u884C\u7A0B\u8DEF\u7EBF (".concat(y.segments.filter(function(c){return c.success}).length,"/").concat(y.segments.length," \u6BB5\u6210\u529F)"):"\u5B8C\u6574\u8DEF\u5F84\u8BA1\u7B97":p.length>0?"\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4 (".concat(p.filter(function(c){return c.success}).length,"/").concat(p.length," \u79CD\u53EF\u7528)"):"\u8DEF\u7EBF\u9884\u89C8",(e?y:p.length>0)&&!W&&(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:["\u5F53\u524D\u663E\u793A: ",(0,l.jsx)("span",{style:{color:ue[M],fontWeight:"bold"},children:re[M]||M})," \u8DEF\u7EBF",e&&y&&(0,l.jsxs)("span",{style:{marginLeft:"16px"},children:["\u603B\u8DDD\u79BB: ",(y.totalDistance/1e3).toFixed(1),"km | \u603B\u65F6\u95F4: ",Math.ceil(y.totalDuration/60),"\u5206\u949F"]})]})]}),(0,l.jsx)(Da,{planItems:n,completeRoute:y,isSubmitted:e,onImportData:x})]})}),(0,l.jsx)("div",{ref:r,style:{height:"calc(100% - 200px)",width:"100%",background:"#f0f2f5"}}),(0,l.jsxs)("div",{style:{padding:"16px",maxHeight:"100vh",overflow:"hidden"},children:[W&&(0,l.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,l.jsx)(Aa.Z,{size:"small"})," ",e?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u4E2D..."]}),e&&!W&&y&&(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:"bold"},children:"\u884C\u7A0B\u8DEF\u7EBF\u8BE6\u60C5\uFF1A"}),y.segments.map(function(c,B){return(0,l.jsxs)("div",{style:{marginBottom:8,padding:"8px 12px",background:c.success?G===c.id?"#e6f7ff":"#fafafa":"#fff2f0",borderRadius:4,border:G===c.id?"2px solid ".concat(ue[c.mode]):"1px solid transparent",cursor:c.success?"pointer":"default",opacity:c.success?1:.6,transition:"all 0.3s ease"},onClick:function(){return c.success&&E(c.id)},children:[(0,l.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("div",{style:{width:12,height:12,backgroundColor:c.success?ue[c.mode]:"#d9d9d9",borderRadius:"50%",marginRight:8}}),(0,l.jsxs)("strong",{style:{color:c.success?G===c.id?ue[c.mode]:"#333":"#999"},children:[c.startPoint.name," \u2192 ",c.endPoint.name,G===c.id&&" (\u9AD8\u4EAE\u663E\u793A)"]})]})}),(0,l.jsx)("div",{style:{fontSize:"12px",color:c.success?"#666":"#999",marginTop:"4px"},children:c.success?(0,l.jsxs)(l.Fragment,{children:["\u8DDD\u79BB: ",(c.distance/1e3).toFixed(1),"km | \u65F6\u95F4: ",Math.ceil(c.duration/60),"\u5206\u949F | \u65B9\u5F0F: ",re[c.mode]]}):(0,l.jsx)("span",{style:{color:"#ff4d4f"},children:c.error})})]},c.id)}),y.segments.some(function(c){return c.success})&&(0,l.jsxs)("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#f0f9ff",borderRadius:4,border:"1px solid #91d5ff"},children:[(0,l.jsx)("strong",{children:"\u603B\u8BA1\uFF1A"}),(0,l.jsxs)("span",{style:{marginLeft:"8px"},children:["\u8DDD\u79BB ",(y.totalDistance/1e3).toFixed(1),"km | \u65F6\u95F4 ",Math.ceil(y.totalDuration/60),"\u5206\u949F"]})]})]}),!e&&!W&&p.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:"bold"},children:"\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4\uFF1A"}),p.map(function(c,B){return(0,l.jsxs)("div",{style:{marginBottom:8,padding:"8px 12px",background:c.success?M===c.mode?"#e6f7ff":"#fafafa":"#fff2f0",borderRadius:4,border:M===c.mode&&c.success?"2px solid ".concat(ue[c.mode]):"1px solid transparent",cursor:c.success?"pointer":"default",opacity:c.success?1:.6,transition:"all 0.3s ease"},onClick:function(){return c.success&&!le&&S(c.mode)},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("div",{style:{width:12,height:12,backgroundColor:c.success?ue[c.mode]:"#d9d9d9",borderRadius:"50%",marginRight:8}}),(0,l.jsxs)("strong",{style:{color:c.success?M===c.mode?ue[c.mode]:"#333":"#999"},children:[re[c.mode],M===c.mode&&c.success&&" (\u5F53\u524D\u663E\u793A)"]})]}),c.success&&(0,l.jsx)(ne.ZP,{size:"small",type:M===c.mode?"primary":"default",loading:le&&M===c.mode,onClick:function(O){O.stopPropagation(),S(c.mode)},children:le&&M===c.mode?"\u7ED8\u5236\u4E2D":"\u67E5\u770B\u8DEF\u7EBF"})]}),(0,l.jsx)("div",{style:{fontSize:"12px",color:c.success?"#666":"#999",marginTop:"4px"},children:(0,l.jsxs)(l.Fragment,{children:["\u8DDD\u79BB: ",(c.distance/1e3).toFixed(1),"km | \u65F6\u95F4: ",Math.ceil(c.duration/60),"\u5206\u949F",c.mode==="transfer"&&" | \u542B\u6362\u4E58"]})})]},B)})]}),!W&&(e?!y:p.length===0)&&!_&&(0,l.jsx)("div",{style:{textAlign:"center",color:"#999",padding:"20px"},children:e?"\u8BF7\u9009\u62E9\u81F3\u5C112\u4E2A\u666F\u70B9\u8BA1\u7B97\u8DEF\u5F84":"\u8BF7\u8BBE\u7F6E\u8D77\u70B9\u548C\u7EC8\u70B9\u67E5\u770B\u8DEF\u7EBF"})]})]})},Ze=ja,Ma=function(u){var n=u.planItems,a=u.setPlanItems,e=u.isSubmitted,t=u.onImportData,o=u.onSubmit,i=u.onEdit;return(0,l.jsxs)(Oe.Z,{gutter:[16,16],style:{height:"100%"},children:[(0,l.jsx)(Me.Z,{xs:24,lg:14,style:{height:"100%"},children:(0,l.jsx)(xa,{items:n,setItems:a,isSubmitted:e,onSubmit:o,onEdit:i})}),(0,l.jsx)(Me.Z,{xs:24,lg:10,style:{height:"100%"},children:(0,l.jsx)(Ze,{planItems:n,isSubmitted:e,city:n.length>0?n[0].region:"\u676D\u5DDE",onImportData:t})})]})},Ia=Ma,Ta=g(38913),Ae="travel_plan_items",Ee="travel_plan_submitted",za=function(u,n){try{localStorage.setItem(Ae,JSON.stringify(u)),localStorage.setItem(Ee,JSON.stringify(n)),console.log("\u6570\u636E\u5DF2\u4FDD\u5B58\u5230localStorage")}catch(a){console.error("\u4FDD\u5B58\u5230localStorage\u5931\u8D25:",a)}},Za=function(){try{var u=localStorage.getItem(Ae),n=localStorage.getItem(Ee),a=u?JSON.parse(u):[],e=n?JSON.parse(n):!1;return console.log("\u4ECElocalStorage\u52A0\u8F7D\u6570\u636E:",{planItems:a.length,isSubmitted:e}),{planItems:a,isSubmitted:e}}catch(t){return console.error("\u4ECElocalStorage\u52A0\u8F7D\u5931\u8D25:",t),{planItems:[],isSubmitted:!1}}},La=function(){try{localStorage.removeItem(Ae),localStorage.removeItem(Ee),console.log("localStorage\u5DF2\u6E05\u9664")}catch(u){console.error("\u6E05\u9664localStorage\u5931\u8D25:",u)}},Wa=g(92275),Na=g.n(Wa),Ya=g(56628);function Oa(){var C=(0,j.useState)(""),u=U()(C,2),n=u[0],a=u[1],e={toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]};return(0,l.jsx)(Na(),{theme:"snow",value:n,onChange:a,modules:e,placeholder:"\u5F00\u59CB\u8BB0\u5F55\u4F60\u7684\u65C5\u6E38\u7B14\u8BB0\u5427~"})}var $a=Oa,Va=Pe.Z.Header,Ua=Pe.Z.Content,Ja=function(){var u=(0,j.useState)([]),n=U()(u,2),a=n[0],e=n[1],t=(0,j.useState)("1"),o=U()(t,2),i=o[0],r=o[1],d=(0,j.useState)(!1),s=U()(d,2),h=s[0],v=s[1],p=(0,j.useState)(["map"]),R=U()(p,2),b=R[0],m=R[1],y=We.Z.useToken(),P=y.token,k=P.colorBgContainer,f=P.borderRadiusLG;(0,j.useEffect)(function(){var J=Za(),V=J.planItems,W=J.isSubmitted;V.length>0&&(e(V),v(W),N.ZP.success("\u5DF2\u6062\u590D ".concat(V.length," \u4E2A\u666F\u70B9\u7684\u65C5\u884C\u8BA1\u5212")))},[]),(0,j.useEffect)(function(){a.length>0&&za(a,h)},[a,h]);var M=function(V){r(V)},H=function(){v(!0)},X=function(){v(!1)},L=function(V){e(V),v(!1),r("2")},G=function(){e([]),v(!1),La(),N.ZP.success("\u5DF2\u6E05\u9664\u6240\u6709\u6570\u636E")};(0,j.useEffect)(function(){var J=new URLSearchParams(window.location.search),V=J.get("share");if(V)try{var W=JSON.parse(decodeURIComponent(V));if(W.spots&&Array.isArray(W.spots)){var Y=W.spots.map(function(Q,te){return{id:"shared-".concat(Date.now(),"-").concat(te),name:Q.name,location:Q.name,region:"\u672A\u77E5",lat:Q.lat,lng:Q.lng,isStart:te===0,isEnd:te===W.spots.length-1,mode:Q.mode||"driving",checked:!0}});e(Y),r("2"),v(!0),N.ZP.success("\u5DF2\u5BFC\u5165\u5206\u4EAB\u7684\u884C\u7A0B\u8BA1\u5212"),window.history.replaceState({},document.title,window.location.pathname)}}catch(Q){console.error("\u89E3\u6790\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",Q),N.ZP.error("\u5206\u4EAB\u94FE\u63A5\u683C\u5F0F\u4E0D\u6B63\u786E")}},[]);var q=function(){switch(i){case"1":return(0,l.jsx)(Ia,{planItems:a,setPlanItems:e,isSubmitted:h,onSubmit:H,onEdit:X,onImportData:L});case"2":var V=[{key:"note",label:(0,l.jsx)("span",{style:{fontWeight:500},children:"\u{1F4DD} \u65C5\u884C\u7B14\u8BB0"}),children:(0,l.jsx)($a,{})},{key:"map",label:(0,l.jsx)("span",{style:{fontWeight:500},children:"\u{1F5FA}\uFE0F \u65C5\u884C\u5730\u56FE"}),children:(0,l.jsx)("div",{style:{height:"500px",borderRadius:"8px",overflow:"hidden",border:"1px solid #f0f0f0"},children:(0,l.jsx)(Ze,{planItems:a,isSubmitted:h,city:a.length>0?a[0].region:"\u676D\u5DDE",onImportData:L})})}];return(0,l.jsx)(he.Z,{gap:"middle",vertical:!0,children:(0,l.jsx)(je.Z,{activeKey:b,onChange:function(Y){return m(Y)},bordered:!1,expandIconPosition:"end",style:{background:"#fff",borderRadius:"8px"},collapsible:"header",children:V.map(function(W){return(0,l.jsx)(je.Z.Panel,{header:W.label,children:W.children},String(W.key))})})});default:return null}};return(0,l.jsxs)(Pe.Z,{style:{height:"100vh",minWidth:"40vh",overflow:"hidden"},children:[(0,l.jsxs)(Va,{style:{display:"flex",alignItems:"center",marginBottom:20,flexShrink:0},children:[(0,l.jsx)("div",{className:"demo-logo",style:{color:"white",marginRight:20},children:"\u81EA\u5B9A\u4E49\u65C5\u884C\u8BA1\u5212"}),(0,l.jsx)(Ne.Z,{theme:"dark",mode:"horizontal",selectedKeys:[i],onClick:function(V){var W=V.key;return M(W)},items:[{key:"1",label:"\u613F\u671B\u666F\u70B9\u5355"},{key:"2",label:"\u5728\u7EBF\u8BB0\u4E8B\u672C"}],style:{flex:1,minWidth:0}}),a.length>0&&(0,l.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,l.jsxs)("span",{style:{color:"rgba(255,255,255,0.7)",fontSize:"14px"},children:["\u5DF2\u4FDD\u5B58 ",a.length," \u4E2A\u666F\u70B9"]}),(0,l.jsx)(ne.ZP,{type:"text",size:"small",icon:(0,l.jsx)(Ta.Z,{}),onClick:G,style:{color:"rgba(255,255,255,0.7)"},title:"\u6E05\u9664\u6240\u6709\u6570\u636E",children:"\u6E05\u9664"})]})]}),(0,l.jsx)(Ua,{style:{padding:"0 48px",flex:1,overflow:"hidden"},children:(0,l.jsx)("div",{style:{height:"100%",background:k,padding:24,borderRadius:f,overflow:"auto",scrollbarWidth:"none"},children:q()})})]})},Ka=Ja}}]);
