"use strict";(self.webpackChunktravel_plan=self.webpackChunktravel_plan||[]).push([[866],{73053:function(bn,Ee,m){m.r(Ee),m.d(Ee,{default:function(){return yn}});var $e=m(48305),T=m.n($e),D=m(75271),Me=m(56564),he=m(51555),z=m(3988),Ke=m(63092),Fe=m(23297),Ve=m(15558),le=m.n(Ve),He=m(26068),Z=m.n(He),Je=m(67825),Ue=m.n(Je),be=m(26729),Ye=m(73648),J=m(28375),ie=m(11778),Y=m(92974),Ge=m(49319),ve=m(99546),fe=m(5574),Xe=m(78434),Qe=m(90228),C=m.n(Qe),qe=m(87999),j=m.n(qe),je=m(34329),_e=m(79306),ea=m(99247),aa=m(64533),na="ac47d45ec5e5e8ddf58b95e9e99ede62",ta=function(){var w=j()(C()().mark(function r(n,a){var e,l;return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,aa.Z.get("https://restapi.amap.com/v5/place/text",{params:{key:na,keywords:n,city:a,output:"json"}});case 3:if(e=i.sent,!(e.data&&e.data.status==="1"&&e.data.pois)){i.next=9;break}return l=e.data.pois.map(function(t){var c=t.location.split(","),o=T()(c,2),d=o[0],h=o[1];return{id:t.id,name:t.name,address:t.address,location:{lat:parseFloat(h),lng:parseFloat(d)},cityname:t.cityname,adname:t.adname}}),i.abrupt("return",l);case 9:return console.error("\u9AD8\u5FB7 API \u8FD4\u56DE\u9519\u8BEF:",e.data.info),i.abrupt("return",[]);case 11:i.next=17;break;case 13:return i.prev=13,i.t0=i.catch(0),console.error("\u641C\u7D22\u5730\u70B9\u8BF7\u6C42\u5931\u8D25:",i.t0),i.abrupt("return",[]);case 17:case"end":return i.stop()}},r,null,[[0,13]])}));return function(n,a){return w.apply(this,arguments)}}(),ra=m(25298),ue=m.n(ra),la=m(17069),oe=m.n(la),ia=m(31759),ua=m.n(ia),oa=function(){function w(){ue()(this,w)}return oe()(w,[{key:"calculateSingleSegment",value:function(){var r=j()(C()().mark(function a(e,l,u,i){var t;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,o.t0=u,o.next=o.t0==="driving"?4:o.t0==="walking"?8:o.t0==="riding"?12:o.t0==="transfer"?16:20;break;case 4:return o.next=6,this.getDrivingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 6:return t=o.sent,o.abrupt("break",23);case 8:return o.next=10,this.getWalkingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 10:return t=o.sent,o.abrupt("break",23);case 12:return o.next=14,this.getRidingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 14:return t=o.sent,o.abrupt("break",23);case 16:return o.next=18,this.getTransferRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat],"\u676D\u5DDE");case 18:return t=o.sent,o.abrupt("break",23);case 20:return o.next=22,this.getDrivingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 22:t=o.sent;case 23:return o.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:l.name,position:[l.lng,l.lat]},distance:t.distance,duration:t.duration,mode:u,polyline:t.polyline||[],success:t.success,error:t.error});case 26:return o.prev=26,o.t1=o.catch(0),console.error("\u8DEF\u6BB5\u8BA1\u7B97\u5931\u8D25:",o.t1),o.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:l.name,position:[l.lng,l.lat]},distance:0,duration:0,mode:u,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 30:case"end":return o.stop()}},a,this,[[0,26]])}));function n(a,e,l,u){return r.apply(this,arguments)}return n}()},{key:"getDrivingRouteWithPolyline",value:function(){var r=j()(C()().mark(function a(e,l){var u=this;return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X();case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(q("driving")){t.next=10;break}return t.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return t.abrupt("return",new Promise(function(c){var o=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});o.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var b=h.routes[0],f=u.extractPolylineFromRoute(b);c({mode:"driving",distance:b.distance,duration:b.time,success:!0,polyline:f})}else c({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return t.stop()}},a,null,[[0,5]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getWalkingRouteWithPolyline",value:function(){var r=j()(C()().mark(function a(e,l){var u=this;return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X();case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(q("walking")){t.next=10;break}return t.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return t.abrupt("return",new Promise(function(c){var o=new window.AMap.Walking({map:null,autoFitView:!1});o.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var b=h.routes[0],f=u.extractPolylineFromRoute(b);c({mode:"walking",distance:b.distance,duration:b.time,success:!0,polyline:f})}else c({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return t.stop()}},a,null,[[0,5]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getRidingRouteWithPolyline",value:function(){var r=j()(C()().mark(function a(e,l){var u=this;return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X();case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(q("riding")){t.next=10;break}return t.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return t.abrupt("return",new Promise(function(c){var o=new window.AMap.Riding({map:null,autoFitView:!1});o.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var b=h.routes[0],f=u.extractPolylineFromRoute(b);c({mode:"riding",distance:b.distance,duration:b.time||b.duration,success:!0,polyline:f})}else c({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return t.stop()}},a,null,[[0,5]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getTransferRouteWithPolyline",value:function(){var r=j()(C()().mark(function a(e,l){var u=this,i,t=arguments;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=t.length>2&&t[2]!==void 0?t[2]:"\u676D\u5DDE",o.prev=1,o.next=4,X();case 4:o.next=9;break;case 6:return o.prev=6,o.t0=o.catch(1),o.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 9:if(q("transfer")){o.next=11;break}return o.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 11:return o.abrupt("return",new Promise(function(d){var h=new window.AMap.Transfer({map:null,city:i,autoFitView:!1});h.search(e,l,function(b,f){if(b==="complete"&&f.plans&&f.plans.length>0){var p=f.plans[0],y=u.extractPolylineFromRoute(p);d({mode:"transfer",distance:p.distance,duration:p.time,success:!0,polyline:y})}else d({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 12:case"end":return o.stop()}},a,null,[[1,6]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"extractPolylineFromRoute",value:function(n){var a=this,e=[];if(n.rides&&Array.isArray(n.rides))return n.rides.forEach(function(u){u.path&&Array.isArray(u.path)&&u.path.forEach(function(i){var t=a.extractPosition(i);t&&e.push(t)})}),e;if(n.steps&&Array.isArray(n.steps))n.steps.forEach(function(u,i){if(u.polyline){var t=a.parsePolyline(u.polyline);e.push.apply(e,le()(t))}else if(u.path&&Array.isArray(u.path))u.path.forEach(function(d,h){if(d&&ua()(d)==="object"){var b,f;if(d.lng!==void 0&&d.lat!==void 0)b=d.lng,f=d.lat;else if(d.longitude!==void 0&&d.latitude!==void 0)b=d.longitude,f=d.latitude;else if(d.x!==void 0&&d.y!==void 0)b=d.x,f=d.y;else if(Array.isArray(d)&&d.length>=2)b=d[0],f=d[1];else if(d.getPosition&&typeof d.getPosition=="function"){var p=d.getPosition();b=p.getLng(),f=p.getLat()}b!==void 0&&f!==void 0&&!isNaN(b)&&!isNaN(f)&&e.push([b,f])}});else{if(u.start_location){var c=a.extractPosition(u.start_location);c&&e.push(c)}if(u.end_location){var o=a.extractPosition(u.end_location);o&&e.push(o)}}});else if(n.path&&Array.isArray(n.path))n.path.forEach(function(u,i){var t=a.extractPosition(u);t&&e.push(t)});else if(n.polyline){var l=this.parsePolyline(n.polyline);e.push.apply(e,le()(l))}return e}},{key:"extractPosition",value:function(n){if(!n)return null;var a,e;if(n.lng!==void 0&&n.lat!==void 0)a=n.lng,e=n.lat;else if(n.longitude!==void 0&&n.latitude!==void 0)a=n.longitude,e=n.latitude;else if(n.x!==void 0&&n.y!==void 0)a=n.x,e=n.y;else if(Array.isArray(n)&&n.length>=2)a=n[0],e=n[1];else if(n.getPosition&&typeof n.getPosition=="function"){var l=n.getPosition();a=l.getLng(),e=l.getLat()}else n.getLng&&typeof n.getLng=="function"&&(a=n.getLng(),e=n.getLat());return a!==void 0&&e!==void 0&&!isNaN(a)&&!isNaN(e)?[a,e]:null}},{key:"parsePolyline",value:function(n){if(!n||typeof n!="string")return[];try{var a;n.includes(";")?a=n.split(";"):n.includes("|")?a=n.split("|"):n.includes(" ")?a=n.split(" "):a=[n];for(var e=[],l=0;l<a.length;l++){var u=a[l].trim();if(u){var i=u.split(",");if(i.length>=2){var t=parseFloat(i[0]),c=parseFloat(i[1]);!isNaN(t)&&!isNaN(c)&&t>=-180&&t<=180&&c>=-90&&c<=90&&e.push([t,c])}}}return e}catch(o){return[]}}}]),w}(),sa=new oa,ca=function(){var w=j()(C()().mark(function r(n,a,e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",sa.calculateSingleSegment(n,a,e,l));case 1:case"end":return i.stop()}},r)}));return function(n,a,e,l){return w.apply(this,arguments)}}(),da=function(){function w(){ue()(this,w)}return oe()(w,[{key:"getDrivingRoute",value:function(){var r=j()(C()().mark(function a(e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,X();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(t){var c=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(o,d){if(o==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];t({mode:"driving",distance:h.distance,duration:h.time,success:!0})}else t({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getWalkingRoute",value:function(){var r=j()(C()().mark(function a(e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,X();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(t){var c=new window.AMap.Walking({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(o,d){if(o==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];t({mode:"walking",distance:h.distance,duration:h.time,success:!0})}else t({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getRidingRoute",value:function(){var r=j()(C()().mark(function a(e,l){return C()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,X();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(t){var c=new window.AMap.Riding({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(o,d){if(o==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];t({mode:"riding",distance:h.distance,duration:h.time,success:!0})}else t({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},a,null,[[0,5]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getTransitRoute",value:function(){var r=j()(C()().mark(function a(e,l){var u,i=arguments;return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u=i.length>2&&i[2]!==void 0?i[2]:"\u676D\u5DDE",c.prev=1,c.next=4,X();case 4:c.next=9;break;case 6:return c.prev=6,c.t0=c.catch(1),c.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 9:return c.abrupt("return",new Promise(function(o){var d=new window.AMap.Transfer({map:null,city:u==="\u676D\u5DDE"?"\u5317\u4EAC":u,autoFitView:!1});d.search(e,l,function(h,b){if(h==="complete"&&b.plans&&b.plans.length>0){var f=b.plans[0];o({mode:"transfer",distance:f.distance,duration:f.time,success:!0})}else o({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 10:case"end":return c.stop()}},a,null,[[1,6]])}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"getAllRoutes",value:function(){var r=j()(C()().mark(function a(e,l){var u,i,t=arguments;return C()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return u=t.length>2&&t[2]!==void 0?t[2]:"\u676D\u5DDE",o.next=3,Promise.all([this.getDrivingRoute(e,l),this.getWalkingRoute(e,l),this.getRidingRoute(e,l),this.getTransitRoute(e,l,u)]);case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}},a,this)}));function n(a,e){return r.apply(this,arguments)}return n}()},{key:"calculateCompleteRouteWithModes",value:function(){var r=j()(C()().mark(function a(e){var l,u,i,t,c,o,d,h,b;return C()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(e.length<2)){p.next=2;break}return p.abrupt("return",{segments:[],totalDistance:0,totalDuration:0,mode:"mixed",success:!1});case 2:l=[],u=0,i=0,t=0;case 6:if(!(t<e.length-1)){p.next=27;break}return c=e[t],o=e[t+1],d=c.mode||"driving",p.prev=10,console.log("\u8BA1\u7B97\u8DEF\u6BB5 ".concat(t+1,":"),c.name,"\u2192",o.name,"(".concat(d,")")),p.next=14,ca(c,o,d,"segment-".concat(t));case 14:h=p.sent,console.log("\u8DEF\u6BB5 ".concat(t+1," \u8BA1\u7B97\u7ED3\u679C:"),h),l.push(h),h.success&&(u+=h.distance,i+=h.duration),p.next=24;break;case 20:p.prev=20,p.t0=p.catch(10),console.error("\u8DEF\u6BB5 ".concat(c.name," \u2192 ").concat(o.name," \u8BA1\u7B97\u5931\u8D25:"),p.t0),l.push({id:"segment-".concat(t),startPoint:{name:c.name,position:[c.lng,c.lat]},endPoint:{name:o.name,position:[o.lng,o.lat]},distance:0,duration:0,mode:d,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 24:t++,p.next=6;break;case 27:return b={segments:l,totalDistance:u,totalDuration:i,mode:"mixed",success:l.some(function(y){return y.success})},console.log("\u5B8C\u6574\u8DEF\u7EBF\u8BA1\u7B97\u7ED3\u679C:",b),p.abrupt("return",b);case 30:case"end":return p.stop()}},a,null,[[10,20]])}));function n(a){return r.apply(this,arguments)}return n}()}]),w}(),ha=m(82092),G=m.n(ha),we=function(){function w(){ue()(this,w),G()(this,"pluginsLoaded",!1),G()(this,"availablePlugins",new Set)}return oe()(w,[{key:"loadPlugins",value:function(){var r=j()(C()().mark(function a(){var e=this;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.pluginsLoaded){u.next=2;break}return u.abrupt("return");case 2:return u.abrupt("return",new Promise(function(i,t){if(!window.AMap){t(new Error("AMap\u672A\u52A0\u8F7D"));return}var c=["AMap.Driving","AMap.Walking","AMap.Transfer","AMap.Riding"];window.AMap.plugin(c,function(){var o={"AMap.Driving":"driving","AMap.Walking":"walking","AMap.Transfer":"transfer","AMap.Riding":"riding"};c.forEach(function(d){var h=d.replace("AMap.","");if(window.AMap[h]){var b=o[d];b&&e.availablePlugins.add(b)}}),e.pluginsLoaded=!0,console.log("\u5DF2\u52A0\u8F7D\u7684\u63D2\u4EF6:",Array.from(e.availablePlugins)),i(void 0)})}));case 3:case"end":return u.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"ensurePluginsLoaded",value:function(){var r=j()(C()().mark(function a(){return C()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.pluginsLoaded){l.next=2;break}return l.abrupt("return");case 2:return l.next=4,this.loadPlugins();case 4:case"end":return l.stop()}},a,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"isPluginAvailable",value:function(n){return this.availablePlugins.has(n.toLowerCase())}},{key:"getAvailablePlugins",value:function(){return Array.from(this.availablePlugins)}},{key:"reset",value:function(){this.pluginsLoaded=!1,this.availablePlugins.clear()}}],[{key:"getInstance",value:function(){return w.instance||(w.instance=new w),w.instance}}]),w}();G()(we,"instance",void 0);var X=function(){var w=j()(C()().mark(function r(){var n;return C()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=we.getInstance(),e.next=3,n.ensurePluginsLoaded();case 3:case"end":return e.stop()}},r)}));return function(){return w.apply(this,arguments)}}(),q=function(r){var n=we.getInstance();return n.isPluginAvailable(r)},K={driving:"\u9A7E\u8F66",walking:"\u6B65\u884C",riding:"\u9A91\u884C",transfer:"\u516C\u4EA4",mixed:"\u6DF7\u5408"},V={driving:"#1890ff",walking:"#52c41a",riding:"#faad14",transfer:"#f759ab",mixed:"#13c2c2"},va=function(){function w(r){ue()(this,w),G()(this,"map",void 0),G()(this,"currentRouteInstance",null),G()(this,"segmentInstances",[]),G()(this,"segmentOverlays",[]),this.map=r}return oe()(w,[{key:"drawDrivingRoute",value:function(n,a){var e=this;return new Promise(function(l){if(!q("driving")){l(!1);return}e.currentRouteInstance=new window.AMap.Driving({map:e.map,showTraffic:!1,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawWalkingRoute",value:function(n,a){var e=this;return new Promise(function(l){if(!q("walking")){l(!1);return}e.currentRouteInstance=new window.AMap.Walking({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawRidingRoute",value:function(n,a){var e=this;return new Promise(function(l){if(!q("riding")){l(!1);return}e.currentRouteInstance=new window.AMap.Riding({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawTransitRoute",value:function(n,a){var e=this;return new Promise(function(l){if(!q("transfer")){l(!1);return}e.currentRouteInstance=new window.AMap.Transfer({map:e.map,city:"\u676D\u5DDE",autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,a,function(u,i){u==="complete"&&i.plans&&i.plans.length>0?(console.log("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawRoute",value:function(){var r=j()(C()().mark(function a(e,l,u){return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,X(),this.clearAllRoutes(),t.t0=u,t.next=t.t0==="driving"?6:t.t0==="walking"?7:t.t0==="riding"?8:t.t0==="transfer"?9:10;break;case 6:return t.abrupt("return",this.drawDrivingRoute(e,l));case 7:return t.abrupt("return",this.drawWalkingRoute(e,l));case 8:return t.abrupt("return",this.drawRidingRoute(e,l));case 9:return t.abrupt("return",this.drawTransitRoute(e,l));case 10:return t.abrupt("return",!1);case 11:t.next=17;break;case 13:return t.prev=13,t.t1=t.catch(0),console.error("\u7ED8\u5236\u8DEF\u7EBF\u5931\u8D25:",t.t1),t.abrupt("return",!1);case 17:case"end":return t.stop()}},a,this,[[0,13]])}));function n(a,e,l){return r.apply(this,arguments)}return n}()},{key:"clearAllRoutes",value:function(){var n=this;this.currentRouteInstance&&(this.currentRouteInstance.clear(),this.currentRouteInstance=null),this.segmentInstances.forEach(function(e){e&&e.clear&&e.clear()}),this.segmentInstances=[],this.segmentOverlays.forEach(function(e){e&&n.map.remove(e)}),this.segmentOverlays=[];var a=this.map.getAllOverlays("polyline");a.forEach(function(e){n.map.remove(e)})}},{key:"drawCompleteRoute",value:function(n){var a=this;if(console.log("\u5F00\u59CB\u7ED8\u5236\u5B8C\u6574\u8DEF\u7EBF:",n),this.clearAllRoutes(),!n.success||n.segments.length===0){console.log("\u6CA1\u6709\u6210\u529F\u7684\u8DEF\u7EBF\u6BB5\u53EF\u7ED8\u5236");return}var e=[];n.segments.forEach(function(l,u){if(l.success&&l.polyline&&l.polyline.length>1){console.log("\u7ED8\u5236\u8DEF\u6BB5 ".concat(u+1,":"),l.startPoint.name,"\u2192",l.endPoint.name,"polyline\u70B9\u6570:",l.polyline.length);var i=new window.AMap.Polyline({path:l.polyline,strokeColor:V[l.mode]||"#1890ff",strokeWeight:6,strokeOpacity:.8,strokeStyle:"solid",showDir:!0,extData:{segmentId:l.id,segmentIndex:u}});a.map.add(i),a.segmentOverlays.push(i),e.push(i);var t=new window.AMap.Marker({position:l.startPoint.position,content:'<div style="background: '.concat(V[l.mode],'; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">').concat(u===0?"\u8D77":u+1,"</div>"),title:l.startPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});if(a.map.add(t),a.segmentOverlays.push(t),e.push(t),u===n.segments.length-1){var c=new window.AMap.Marker({position:l.endPoint.position,content:'<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">\u7EC8</div>',title:l.endPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});a.map.add(c),a.segmentOverlays.push(c),e.push(c)}if(l.polyline.length>2){var o=Math.floor(l.polyline.length/2),d=l.polyline[o],h=new window.AMap.Marker({position:d,content:'<div style="background: '.concat(V[l.mode],'; color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; border: 1px solid white; opacity: 0.9;">').concat(a.getModeIcon(l.mode),"</div>"),anchor:"center",offset:new window.AMap.Pixel(0,-10),zIndex:200});a.map.add(h),a.segmentOverlays.push(h),e.push(h)}}else console.log("\u8DF3\u8FC7\u5931\u8D25\u7684\u8DEF\u6BB5 ".concat(u+1,":"),l.error)}),e.length>0&&(console.log("\u8C03\u6574\u5730\u56FE\u89C6\u91CE\uFF0C\u8986\u76D6\u7269\u6570\u91CF:",e.length),this.map.setFitView(e,!1,[50,50,50,50])),console.log("\u5B8C\u6574\u8DEF\u7EBF\u7ED8\u5236\u5B8C\u6210\uFF0C\u603B\u8986\u76D6\u7269\u6570\u91CF:",this.segmentOverlays.length)}},{key:"getModeIcon",value:function(n){var a={driving:"\u{1F697}",walking:"\u{1F6B6}",riding:"\u{1F6B4}",transfer:"\u{1F68C}"};return a[n]||"\u25CF"}},{key:"highlightSegment",value:function(n){console.log("\u9AD8\u4EAE\u8DEF\u6BB5:",n),this.segmentOverlays.forEach(function(a){if(a.CLASS_NAME==="AMap.Polyline"||a.getPath){var e=a.getExtData();e&&e.segmentId===n?a.setOptions({strokeWeight:10,strokeOpacity:1,zIndex:100}):a.setOptions({strokeWeight:4,strokeOpacity:.4,zIndex:1})}})}},{key:"resetSegmentHighlight",value:function(){console.log("\u91CD\u7F6E\u8DEF\u6BB5\u9AD8\u4EAE"),this.segmentOverlays.forEach(function(n){(n.CLASS_NAME==="AMap.Polyline"||n.getPath)&&n.setOptions({strokeWeight:6,strokeOpacity:.8,zIndex:10})})}}]),w}(),fa=function(){function w(r){ue()(this,w),G()(this,"calculationService",void 0),G()(this,"drawingService",void 0),this.calculationService=new da,this.drawingService=new va(r)}return oe()(w,[{key:"getAllRoutes",value:function(){var r=j()(C()().mark(function a(e,l,u){return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.calculationService.getAllRoutes(e,l,u));case 1:case"end":return t.stop()}},a,this)}));function n(a,e,l){return r.apply(this,arguments)}return n}()},{key:"calculateCompleteRouteWithModes",value:function(){var r=j()(C()().mark(function a(e){return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.calculationService.calculateCompleteRouteWithModes(e));case 1:case"end":return u.stop()}},a,this)}));function n(a){return r.apply(this,arguments)}return n}()},{key:"drawRoute",value:function(){var r=j()(C()().mark(function a(e,l,u){return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.drawingService.drawRoute(e,l,u));case 1:case"end":return t.stop()}},a,this)}));function n(a,e,l){return r.apply(this,arguments)}return n}()},{key:"drawCompleteRoute",value:function(n){this.drawingService.drawCompleteRoute(n)}},{key:"clearAllRoutes",value:function(){this.drawingService.clearAllRoutes()}},{key:"highlightSegment",value:function(n){this.drawingService.highlightSegment(n)}},{key:"resetSegmentHighlight",value:function(){this.drawingService.resetSegmentHighlight()}}]),w}(),s=m(52676),ga=function(r){var n=r.value,a=n===void 0?"":n,e=r.onChange,l=r.onPlaceSelected,u=r.placeholder,i=u===void 0?"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22":u,t=r.city,c=t===void 0?"":t,o=(0,D.useState)(a),d=T()(o,2),h=d[0],b=d[1],f=(0,D.useState)([]),p=T()(f,2),y=p[0],k=p[1],R=(0,D.useState)(null),S=T()(R,2),v=S[0],B=S[1],F=(0,D.useState)(!1),I=T()(F,2),M=I[0],W=I[1],$=(0,D.useRef)(null);console.log("AMAP_KEY:",{NODE_ENV:"production",UMI_APP_AMAP_SECRET_KEY:"3e3153b7d6dec0cb487d2afde4795453",UMI_APP_AMAP_WEB_SERVICE_KEY:"ac47d45ec5e5e8ddf58b95e9e99ede62",UMI_APP_AMAP_JS_KEY:"c235c1e78c16464f41d866fe4c811c58",PUBLIC_PATH:"/TravelPlan/"}),(0,D.useEffect)(function(){b(a)},[a]);var g=function(ee,de){var Q=de.place;B(Q),b(Q.name),e==null||e(Q.name),l(Q)},L=function(){B(null),b(""),e==null||e(""),l(null)},We=function(ee){if(b(ee),e==null||e(ee),!ee.trim()){k([]);return}$.current&&window.clearTimeout($.current),W(!0),$.current=window.setTimeout(j()(C()().mark(function de(){var Q,me;return C()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,ta(ee,c);case 2:Q=ae.sent,me=Q.map(function(re){return{value:re.name,label:re.name,address:re.address,place:re}}),k(me),W(!1);case 6:case"end":return ae.stop()}},de)})),300)};return(0,s.jsx)("div",{style:{width:"100%"},children:(0,s.jsxs)(je.Z,{allowClear:{clearIcon:(0,s.jsx)(ea.Z,{})},value:h,options:y,onSelect:g,onSearch:We,onClear:L,placeholder:i,notFoundContent:M?"\u641C\u7D22\u4E2D...":"\u65E0\u5339\u914D\u7ED3\u679C",style:{width:"100%"},children:[y.map(function(U){return(0,s.jsx)(je.Z.Option,{value:U.value,"data-place":U.place,children:(0,s.jsxs)("div",{className:"search-option",children:[(0,s.jsx)("div",{style:{fontWeight:"bold"},children:U.label}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#999"},children:U.address})]})},U.value)}),v&&(0,s.jsx)(_e.Z,{color:"blue",closable:!0,onClose:L,style:{marginTop:8},children:v.name})]})})},pa=ga,ma=m(41448),ya=[{value:"zhejiang",label:"\u6D59\u6C5F",children:[{value:"hangzhou",label:"\u676D\u5DDE"},{value:"ningbo",label:"\u5B81\u6CE2"},{value:"wenzhou",label:"\u6E29\u5DDE"},{value:"shaoxing",label:"\u7ECD\u5174"},{value:"huzhou",label:"\u6E56\u5DDE"},{value:"jiaxing",label:"\u5609\u5174"},{value:"zhoushan",label:"\u821F\u5C71"},{value:"quzhou",label:"\u8862\u5DDE"},{value:"taizhou",label:"\u53F0\u5DDE"},{value:"lishui",label:"\u4E3D\u6C34"}]},{value:"jiangsu",label:"\u6C5F\u82CF",children:[{value:"nanjing",label:"\u5357\u4EAC"},{value:"suzhou",label:"\u82CF\u5DDE"},{value:"wuxi",label:"\u65E0\u9521"},{value:"changzhou",label:"\u5E38\u5DDE"},{value:"zhenjiang",label:"\u9547\u6C5F"},{value:"nantong",label:"\u5357\u901A"},{value:"yangzhou",label:"\u626C\u5DDE"},{value:"taizhou",label:"\u6CF0\u5DDE"},{value:"xuzhou",label:"\u5F90\u5DDE"},{value:"huai an",label:"\u6DEE\u5B89"},{value:"yancheng",label:"\u76D0\u57CE"},{value:"lianyungang",label:"\u8FDE\u4E91\u6E2F"},{value:"suqian",label:"\u5BBF\u8FC1"}]},{value:"beijing",label:"\u5317\u4EAC",children:[{value:"beijing",label:"\u5317\u4EAC"}]},{value:"shanghai",label:"\u4E0A\u6D77",children:[{value:"shanghai",label:"\u4E0A\u6D77"}]},{value:"guangdong",label:"\u5E7F\u4E1C",children:[{value:"guangzhou",label:"\u5E7F\u5DDE"},{value:"shenzhen",label:"\u6DF1\u5733"},{value:"zhuhai",label:"\u73E0\u6D77"},{value:"shantou",label:"\u6C55\u5934"},{value:"foshan",label:"\u4F5B\u5C71"},{value:"dongguan",label:"\u4E1C\u839E"},{value:"zhongshan",label:"\u4E2D\u5C71"},{value:"jiangmen",label:"\u6C5F\u95E8"},{value:"huizhou",label:"\u60E0\u5DDE"},{value:"maoming",label:"\u8302\u540D"},{value:"zhanjiang",label:"\u6E5B\u6C5F"},{value:"meizhou",label:"\u6885\u5DDE"},{value:"qingyuan",label:"\u6E05\u8FDC"},{value:"shaoguan",label:"\u97F6\u5173"},{value:"yunfu",label:"\u4E91\u6D6E"},{value:"chaozhou",label:"\u6F6E\u5DDE"},{value:"jieyang",label:"\u63ED\u9633"},{value:"heyuan",label:"\u6CB3\u6E90"}]},{value:"sichuan",label:"\u56DB\u5DDD",children:[{value:"chengdu",label:"\u6210\u90FD"},{value:"mianyang",label:"\u7EF5\u9633"},{value:"deyang",label:"\u5FB7\u9633"},{value:"nanchong",label:"\u5357\u5145"},{value:"ziyang",label:"\u8D44\u9633"},{value:"zigong",label:"\u81EA\u8D21"},{value:"panzhihua",label:"\u6500\u679D\u82B1"},{value:"luzhou",label:"\u6CF8\u5DDE"},{value:"dazhou",label:"\u8FBE\u5DDE"},{value:"guangyuan",label:"\u5E7F\u5143"},{value:"yibin",label:"\u5B9C\u5BBE"},{value:"neijiang",label:"\u5185\u6C5F"},{value:"leshan",label:"\u4E50\u5C71"},{value:"bazhong",label:"\u5DF4\u4E2D"},{value:"yaan",label:"\u96C5\u5B89"},{value:"ganzi",label:"\u7518\u5B5C"},{value:"liangshan",label:"\u51C9\u5C71"},{value:"abazhou",label:"\u963F\u575D"}]},{value:"yunnan",label:"\u4E91\u5357",children:[{value:"kunming",label:"\u6606\u660E"},{value:"dali",label:"\u5927\u7406"},{value:"lijiang",label:"\u4E3D\u6C5F"},{value:"xishuangbanna",label:"\u897F\u53CC\u7248\u7EB3"},{value:"baoshan",label:"\u4FDD\u5C71"},{value:"chuxiong",label:"\u695A\u96C4"},{value:"dehong",label:"\u5FB7\u5B8F"},{value:"nujiang",label:"\u6012\u6C5F"},{value:"diqing",label:"\u8FEA\u5E86"},{value:"zhaotong",label:"\u662D\u901A"},{value:"qujing",label:"\u66F2\u9756"},{value:"yuxi",label:"\u7389\u6EAA"},{value:"honghe",label:"\u7EA2\u6CB3"},{value:"wenchuan",label:"\u6587\u5C71"},{value:"puer",label:"\u666E\u6D31"},{value:"linfen",label:"\u4E34\u6CA7"}]},{value:"hainan",label:"\u6D77\u5357",children:[{value:"haikou",label:"\u6D77\u53E3"},{value:"sanya",label:"\u4E09\u4E9A"},{value:"danzhou",label:"\u510B\u5DDE"},{value:"wuzhishan",label:"\u4E94\u6307\u5C71"},{value:"qionghai",label:"\u743C\u6D77"},{value:"wanning",label:"\u4E07\u5B81"},{value:"wenchang",label:"\u6587\u660C"},{value:"dongfang",label:"\u4E1C\u65B9"}]},{value:"hunan",label:"\u6E56\u5357",children:[{value:"changsha",label:"\u957F\u6C99"},{value:"zhuzhou",label:"\u682A\u6D32"},{value:"xiangtan",label:"\u6E58\u6F6D"},{value:"hengyang",label:"\u8861\u9633"},{value:"shaoyang",label:"\u90B5\u9633"},{value:"yueyang",label:"\u5CB3\u9633"},{value:"changde",label:"\u5E38\u5FB7"},{value:"zhangjiajie",label:"\u5F20\u5BB6\u754C"},{value:"yiyang",label:"\u76CA\u9633"},{value:"chenzhou",label:"\u90F4\u5DDE"},{value:"yongzhou",label:"\u6C38\u5DDE"},{value:"huaihua",label:"\u6000\u5316"},{value:"loudi",label:"\u5A04\u5E95"},{value:"xiangxi",label:"\u6E58\u897F"}]},{value:"hubei",label:"\u6E56\u5317",children:[{value:"wuhan",label:"\u6B66\u6C49"},{value:"huangshi",label:"\u9EC4\u77F3"},{value:"shiyan",label:"\u5341\u5830"},{value:"yichang",label:"\u5B9C\u660C"},{value:"xiangyang",label:"\u8944\u9633"},{value:"ezhou",label:"\u9102\u5DDE"},{value:"jingmen",label:"\u8346\u95E8"},{value:"xiaogan",label:"\u5B5D\u611F"},{value:"jingzhou",label:"\u8346\u5DDE"},{value:"huanggang",label:"\u9EC4\u5188"},{value:"xianning",label:"\u54B8\u5B81"},{value:"suizhou",label:"\u968F\u5DDE"},{value:"enshi",label:"\u6069\u65BD"}]},{value:"shandong",label:"\u5C71\u4E1C",children:[{value:"jinan",label:"\u6D4E\u5357"},{value:"qingdao",label:"\u9752\u5C9B"},{value:"zibo",label:"\u6DC4\u535A"},{value:"zaozhuang",label:"\u67A3\u5E84"},{value:"dongying",label:"\u4E1C\u8425"},{value:"yantai",label:"\u70DF\u53F0"},{value:"weifang",label:"\u6F4D\u574A"},{value:"jining",label:"\u6D4E\u5B81"},{value:"taian",label:"\u6CF0\u5B89"},{value:"weihai",label:"\u5A01\u6D77"},{value:"rizhao",label:"\u65E5\u7167"},{value:"laiwu",label:"\u83B1\u829C"},{value:"linyi",label:"\u4E34\u6C82"},{value:"dezhou",label:"\u5FB7\u5DDE"},{value:"liaocheng",label:"\u804A\u57CE"},{value:"binzhou",label:"\u6EE8\u5DDE"},{value:"heze",label:"\u83CF\u6CFD"}]}],Ie={\u676D\u5DDE:[120.153576,30.287459],\u5B81\u6CE2:[121.549792,29.870244],\u6E29\u5DDE:[120.699374,27.994207],\u7ECD\u5174:[120.580045,30.023551],\u6E56\u5DDE:[120.097547,30.872655],\u5609\u5174:[120.756608,30.750483],\u821F\u5C71:[122.207217,30.025551],\u8862\u5DDE:[118.876444,28.946588],\u53F0\u5DDE:[121.420711,28.656387],\u4E3D\u6C34:[119.921033,28.451379],\u5357\u4EAC:[118.767413,32.041544],\u82CF\u5DDE:[120.585316,31.29888],\u65E0\u9521:[120.299393,31.573885],\u5E38\u5DDE:[119.955045,31.795574],\u9547\u6C5F:[119.452783,32.204402],\u5357\u901A:[120.864688,32.016175],\u626C\u5DDE:[119.421009,32.393152],\u6CF0\u5DDE:[119.915173,32.484882],\u5F90\u5DDE:[117.184811,34.261792],\u6DEE\u5B89:[119.015305,33.581511],\u76D0\u57CE:[120.139998,33.377631],\u8FDE\u4E91\u6E2F:[119.221617,34.576476],\u5BBF\u8FC1:[118.276837,33.939688],\u5317\u4EAC:[116.397428,39.90923],\u4E0A\u6D77:[121.473701,31.230416],\u5E7F\u5DDE:[113.280637,23.125178],\u6DF1\u5733:[114.085947,22.547],\u73E0\u6D77:[113.576726,22.270703],\u6C55\u5934:[116.683828,23.355818],\u4F5B\u5C71:[113.122717,23.028595],\u4E1C\u839E:[113.75179,23.020748],\u4E2D\u5C71:[113.382333,22.521112],\u6C5F\u95E8:[113.094175,22.589016],\u60E0\u5DDE:[114.412605,23.07942],\u8302\u540D:[110.919231,21.659752],\u6E5B\u6C5F:[110.359377,21.270679],\u6885\u5DDE:[116.119268,24.299056],\u6E05\u8FDC:[113.04789,24.325153],\u97F6\u5173:[113.598407,24.809434],\u4E91\u6D6E:[112.044382,22.927393],\u6F6E\u5DDE:[116.632303,23.661951],\u63ED\u9633:[116.355529,23.543716],\u6CB3\u6E90:[114.697808,23.746275],\u6210\u90FD:[104.065735,30.659462],\u7EF5\u9633:[104.741657,31.455295],\u5FB7\u9633:[104.394943,31.128142],\u5357\u5145:[106.082976,30.795771],\u8D44\u9633:[104.641797,30.123222],\u81EA\u8D21:[104.778442,29.359089],\u6500\u679D\u82B1:[101.718636,26.582347],\u6CF8\u5DDE:[105.443737,28.878649],\u8FBE\u5DDE:[107.502627,31.209818],\u5E7F\u5143:[105.828737,32.433767],\u5B9C\u5BBE:[104.569279,28.763023],\u5185\u6C5F:[105.052014,29.582056],\u4E50\u5C71:[103.761017,29.563017],\u5DF4\u4E2D:[106.753537,31.857465],\u96C5\u5B89:[103.001858,29.98289],\u7518\u5B5C:[100.233394,30.050591],\u51C9\u5C71:[102.266365,27.902191],\u963F\u575D:[102.22435,31.898394],\u6606\u660E:[102.832892,24.880095],\u5927\u7406:[100.228445,25.616545],\u4E3D\u6C5F:[100.226146,26.864494],\u897F\u53CC\u7248\u7EB3:[100.799647,22.003307],\u4FDD\u5C71:[99.166606,25.111631],\u695A\u96C4:[101.543757,25.036331],\u5FB7\u5B8F:[98.577494,24.439671],\u6012\u6C5F:[98.854247,26.648914],\u8FEA\u5E86:[99.708255,27.825172],\u662D\u901A:[103.717158,27.318388],\u66F2\u9756:[103.797387,25.496423],\u7389\u6EAA:[102.539095,24.350431],\u7EA2\u6CB3:[102.818658,23.369552],\u6587\u5C71:[104.24427,23.369998],\u666E\u6D31:[100.973858,22.775479],\u4E34\u6CA7:[100.089039,23.885899],\u6D77\u53E3:[110.33119,20.031971],\u4E09\u4E9A:[109.731928,18.249575],\u510B\u5DDE:[109.340454,19.517126],\u4E94\u6307\u5C71:[109.517624,18.773724],\u743C\u6D77:[110.466989,19.256953],\u4E07\u5B81:[110.389319,18.798578],\u6587\u660C:[110.77781,19.810778],\u4E1C\u65B9:[108.653813,19.09708],\u957F\u6C99:[112.973895,28.196059],\u682A\u6D32:[113.132898,27.831873],\u6E58\u6F6D:[112.944048,27.829724],\u8861\u9633:[112.580162,26.898242],\u90B5\u9633:[111.467124,27.237843],\u5CB3\u9633:[113.089684,29.363969],\u5E38\u5FB7:[111.691585,29.030896],\u5F20\u5BB6\u754C:[110.479298,29.127356],\u76CA\u9633:[112.339719,28.567383],\u90F4\u5DDE:[113.032259,25.774173],\u6C38\u5DDE:[111.608017,26.430765],\u6000\u5316:[109.959052,27.537304],\u5A04\u5E95:[112.003673,27.728183],\u6E58\u897F:[109.739779,28.312699],\u6B66\u6C49:[114.298572,30.584355],\u9EC4\u77F3:[115.096794,30.185835],\u5341\u5830:[110.788111,32.646473],\u5B9C\u660C:[111.290804,30.693176],\u8944\u9633:[112.14414,32.042451],\u9102\u5DDE:[114.888993,30.390928],\u8346\u95E8:[112.203958,31.035758],\u5B5D\u611F:[113.917078,30.916557],\u8346\u5DDE:[112.239204,30.329688],\u9EC4\u5188:[114.879454,30.436752],\u54B8\u5B81:[113.868505,29.839171],\u968F\u5DDE:[113.364104,31.708469],\u6069\u65BD:[109.489134,30.274575],\u6D4E\u5357:[117.020048,36.667524],\u9752\u5C9B:[120.382602,36.064357],\u6DC4\u535A:[118.047644,36.788883],\u67A3\u5E84:[117.323134,34.818489],\u4E1C\u8425:[118.492963,37.461484],\u70DF\u53F0:[121.391446,37.539289],\u6F4D\u574A:[119.160833,36.649827],\u6D4E\u5B81:[116.587269,35.389439],\u6CF0\u5B89:[117.087156,36.184069],\u5A01\u6D77:[122.121559,37.51284],\u65E5\u7167:[119.477875,35.417796],\u83B1\u829C:[117.659763,36.211577],\u4E34\u6C82:[118.356384,35.065087],\u5FB7\u5DDE:[116.357594,37.455084],\u804A\u57CE:[115.975435,36.456405],\u6EE8\u5DDE:[117.971797,37.38421],\u83CF\u6CFD:[115.469381,35.246531],\u5168\u56FD:[104.195397,35.86166]},ba=function(r){var n=r.value,a=n===void 0?"":n,e=r.onChange;return(0,s.jsx)(ma.Z,{defaultValue:["\u6D59\u6C5F","\u676D\u5DDE"],options:ya,onChange:e})},wa=ba,Sa=["data-row-key"],Ca=function(r){var n=r["data-row-key"],a=Ue()(r,Sa),e=(0,ve.nB)({id:n}),l=e.attributes,u=e.listeners,i=e.setNodeRef,t=e.transform,c=e.transition,o=e.isDragging,d=Z()(Z()({},a.style),{},{transform:Xe.ux.Translate.toString(t),transition:c,cursor:"move"},o?{position:"relative",zIndex:999,background:"#fafafa"}:{});return(0,s.jsx)("tr",Z()(Z()(Z()(Z()({},a),{},{ref:i,style:d},l),u),{},{"data-row-key":n}))},ka=function(r){var n=r.items,a=r.setItems,e=r.isSubmitted,l=e===void 0?!1:e,u=r.onSubmit,i=r.onEdit,t=r.onImportData,c=(0,D.useState)(n),o=T()(c,2),d=o[0],h=o[1],b=(0,D.useState)(!1),f=T()(b,2),p=f[0],y=f[1],k=(0,D.useState)(null),R=T()(k,2),S=R[0],v=R[1],B=(0,D.useState)("\u676D\u5DDE"),F=T()(B,2),I=F[0],M=F[1];D.useEffect(function(){h(n)},[n]);var W=(0,fe.Dy)((0,fe.VT)(fe.we,{activationConstraint:{distance:5}})),$=function(A){var P=A.active,x=A.over;if(P.id!==(x==null?void 0:x.id)){var N=d.findIndex(function(ne){return ne.id===P.id}),H=d.findIndex(function(ne){return ne.id===x.id}),_=(0,ve.Rp)(d,N,H);h(_),a(_)}},g=function(){var A=n.filter(function(P){return P.checked});if(A.length<2){be.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u81F3\u5C11\u9009\u62E92\u4E2A\u666F\u70B9\u624D\u80FD\u63D0\u4EA4\u884C\u7A0B"});return}u==null||u()},L=function(){i==null||i()},We=function(){var A=document.createElement("input");A.type="file",A.accept=".json",A.onchange=function(P){var x,N=(x=P.target.files)===null||x===void 0?void 0:x[0];if(N){var H=new FileReader;H.onload=function(_){try{var ne,ye=JSON.parse((ne=_.target)===null||ne===void 0?void 0:ne.result);if(ye.spots&&Array.isArray(ye.spots)){var Ae=ye.spots.map(function(O,xe){var De,Be;return{id:"imported-".concat(Date.now(),"-").concat(xe),name:O.name,location:O.location||O.name,region:O.region||"\u672A\u77E5",lat:((De=O.coordinates)===null||De===void 0?void 0:De.latitude)||O.lat,lng:((Be=O.coordinates)===null||Be===void 0?void 0:Be.longitude)||O.lng,isStart:xe===0,isEnd:xe===ye.spots.length-1,mode:O.transportMode||O.mode||"driving",checked:!1}});t?t(Ae):a(function(O){return[].concat(le()(O),le()(Ae))}),z.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(Ae.length," \u4E2A\u666F\u70B9"))}else z.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u6B63\u786E\u7684JSON\u6587\u4EF6")}catch(O){console.error("\u5BFC\u5165\u6587\u4EF6\u89E3\u6790\u5931\u8D25:",O),z.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5JSON\u683C\u5F0F")}},H.readAsText(N)}},A.click()},U=function(A){a(function(P){return P.map(function(x){return Z()(Z()({},x),{},{isStart:x.id===A,isEnd:x.isEnd&&x.id!==A})})})},ee=function(A){a(function(P){return P.map(function(x){return Z()(Z()({},x),{},{isEnd:x.id===A,isStart:x.isStart&&x.id!==A})})})},de=function(A){a(function(P){return P.filter(function(x){return x.id!==A})})},Q=function(){v(null),y(!0),M("\u676D\u5DDE")},me=function(){if(!S){be.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u666F\u70B9"});return}var A={id:"pois-".concat(Date.now()),name:S.name,location:S.address,region:S.cityname||I,lat:S==null?void 0:S.location.lat,lng:S==null?void 0:S.location.lng,isStart:!1,isEnd:!1,mode:"driving",checked:!1};a(function(P){return[].concat(le()(P),[A])}),y(!1),v(null)},Oe=function(){y(!1),v(null)},ae={type:"checkbox",selectedRowKeys:n.filter(function(E){return E.checked}).map(function(E){return E.id}),onChange:function(A,P){a(function(x){return x.map(function(N){return Z()(Z()({},N),{},{checked:A.includes(N.id)})})})},onSelect:function(A,P,x){a(function(N){return N.map(function(H){return H.id===A.id?Z()(Z()({},H),{},{checked:P}):H})})},onSelectAll:function(A,P,x){a(function(N){return N.map(function(H){return Z()(Z()({},H),{},{checked:A})})})},getCheckboxProps:function(A){return{disabled:l,name:A.name}},columnTitle:l?"\u9009\u62E9\u72B6\u6001":(0,s.jsx)(Ye.Z,{indeterminate:n.some(function(E){return E.checked})&&!n.every(function(E){return E.checked}),checked:n.length>0&&n.every(function(E){return E.checked}),disabled:l||n.length===0,onChange:function(A){var P=A.target.checked;a(function(x){return x.map(function(N){return Z()(Z()({},N),{},{checked:P})})})}}),columnWidth:60},re=[{title:l?"\u884C\u7A0B\u987A\u5E8F":"\u666F\u70B9",dataIndex:"name",width:200,render:function(A,P,x){return(0,s.jsxs)(J.Z,{gap:"middle",align:"center",children:[l&&P.checked&&(0,s.jsx)("div",{style:{minWidth:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#1890ff",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:n.filter(function(N){return N.checked}).findIndex(function(N){return N.id===P.id})+1}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{fontWeight:P.isStart||P.isEnd?"bold":"normal"},children:[P.isStart&&(0,s.jsx)("span",{style:{color:"#52c41a",marginRight:4},children:"[\u8D77\u70B9]"}),P.isEnd&&(0,s.jsx)("span",{style:{color:"#ff4d4f",marginRight:4},children:"[\u7EC8\u70B9]"}),A]}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:P.location})]})]})}},{title:"\u51FA\u884C\u65B9\u5F0F",dataIndex:"mode",width:100,render:function(A,P){return(0,s.jsxs)(ie.default,{value:A,style:{width:70},disabled:l,onChange:function(N){a(function(H){return H.map(function(_){return _.id===P.id?Z()(Z()({},_),{},{mode:N}):_})})},children:[(0,s.jsx)(ie.default.Option,{value:"driving",children:"\u9A7E\u8F66"}),(0,s.jsx)(ie.default.Option,{value:"walking",children:"\u6B65\u884C"}),(0,s.jsx)(ie.default.Option,{value:"riding",children:"\u9A91\u884C"}),(0,s.jsx)(ie.default.Option,{value:"transfer",children:"\u516C\u4EA4"})]})}},{title:"\u64CD\u4F5C",key:"action",width:150,render:function(A,P){return(0,s.jsxs)(J.Z,{gap:4,wrap:!0,children:[!l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.ZP,{size:"small",type:P.isStart?"primary":"default",onClick:function(){return U(P.id)},children:P.isStart?"\u8D77\u70B9":"\u8BBE\u4E3A\u8D77\u70B9"}),(0,s.jsx)(Y.ZP,{size:"small",type:P.isEnd?"primary":"default",onClick:function(){return ee(P.id)},children:P.isEnd?"\u7EC8\u70B9":"\u8BBE\u4E3A\u7EC8\u70B9"}),(0,s.jsx)(Y.ZP,{size:"small",variant:"link",color:"danger",onClick:function(){return de(P.id)},children:"\u5220\u9664"})]}),l&&(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:P.checked?"\u5DF2\u9009\u62E9":"\u672A\u9009\u62E9"})]})}}];return(0,s.jsxs)(J.Z,{vertical:!0,style:{height:"100%"},children:[(0,s.jsx)(fe.LB,{sensors:W,onDragEnd:$,children:(0,s.jsx)(ve.Fo,{items:d.map(function(E){return E.id}),strategy:ve.qw,children:(0,s.jsx)(Ge.Z,{components:{body:{row:Ca}},rowKey:"id",columns:re,dataSource:d,pagination:!1,scroll:{y:"calc(100vh - 260px)"},rowSelection:l?void 0:ae,style:{background:"#fff",flex:1,position:"relative",zIndex:1},locale:{emptyText:(0,s.jsxs)("div",{style:{padding:"60px 20px",textAlign:"center",color:"#999"},children:[(0,s.jsx)("div",{style:{fontSize:"16px",marginBottom:"8px"},children:"\u6682\u65E0\u666F\u70B9\u6570\u636E"}),(0,s.jsx)("div",{style:{fontSize:"14px"},children:'\u70B9\u51FB\u4E0B\u65B9"\u65B0\u589E\u666F\u70B9"\u6309\u94AE\u6DFB\u52A0\u60A8\u60F3\u53BB\u7684\u5730\u65B9'})]})}})})}),(0,s.jsxs)(J.Z,{justify:"space-between",style:{padding:"16px 0",flexShrink:0},children:[(0,s.jsx)(J.Z,{gap:"middle",children:(0,s.jsx)(Y.ZP,{type:"primary",onClick:Q,disabled:l,children:"\u65B0\u589E"})}),(0,s.jsxs)(be.Z,{title:"\u65B0\u589E",open:p,onOk:me,onCancel:Oe,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",zIndex:1e4,getContainer:function(){return document.body},children:[(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u57CE\u5E02\u8303\u56F4"}),(0,s.jsx)(wa,{onChange:function(A,P){if(P&&P.length>0){var x=P[P.length-1].label;M(x)}else M("\u676D\u5DDE")}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u9009\u62E9\u666F\u70B9"}),(0,s.jsx)(pa,{onPlaceSelected:v,placeholder:"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22",city:I==="\u676D\u5DDE"?"":I},I),S&&(0,s.jsxs)("div",{style:{marginTop:8,padding:8,background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4},children:[(0,s.jsx)("div",{style:{fontWeight:"bold"},children:S.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:S.address})]})]})]}),(0,s.jsx)(J.Z,{gap:"middle",style:{marginRight:20},children:l?(0,s.jsx)(Y.ZP,{onClick:L,children:"\u8FD4\u56DE\u7F16\u8F91"}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Y.ZP,{type:"primary",onClick:g,children:"\u63D0\u4EA4\u884C\u7A0B"})})})]})]})},Ra=ka,Pa={mapContainer:"mapContainer___vtLAG"},Aa=function(r){var n=r.mapContainerRef;return(0,s.jsx)("div",{ref:n,className:Pa.mapContainer})},xa=Aa,ze=m(8520),Se=m(87263),ge=m(62826),Da=m(87056),Ba=m(86422),Ea=function(r){var n=r.planItems,a=r.completeRoute,e=r.isSubmitted,l=r.onImportData,u=function(){if(!e||!a)return"";var p=n.filter(function(k){return k.checked}),y=`\u65C5\u884C\u884C\u7A0B\u8BA1\u5212
`;return y+="\u751F\u6210\u65F6\u95F4: ".concat(new Date().toLocaleString(),`
`),y+=`=====================================

`,y+=`\u884C\u7A0B\u6982\u89C8:
`,y+="\u666F\u70B9\u6570\u91CF: ".concat(p.length,`\u4E2A
`),y+="\u8DEF\u6BB5\u6570\u91CF: ".concat(a.segments.length,`\u6BB5
`),y+="\u603B\u8DDD\u79BB: ".concat((a.totalDistance/1e3).toFixed(1),`km
`),y+="\u603B\u65F6\u95F4: ".concat(Math.ceil(a.totalDuration/60),`\u5206\u949F
`),y+="\u6210\u529F\u8DEF\u6BB5: ".concat(a.segments.filter(function(k){return k.success}).length,"/").concat(a.segments.length,`\u6BB5

`),y+=`\u666F\u70B9\u5217\u8868:
`,p.forEach(function(k,R){y+="".concat(R+1,". ").concat(k.name,`
`),y+="   \u4F4D\u7F6E: ".concat(k.location,`
`),y+="   \u5750\u6807: ".concat(k.lat,", ").concat(k.lng,`
`),y+="   \u51FA\u884C\u65B9\u5F0F: ".concat(K[k.mode],`

`)}),y+=`\u8DEF\u7EBF\u8BE6\u60C5:
`,a.segments.forEach(function(k,R){y+="\u8DEF\u6BB5 ".concat(R+1,": ").concat(k.startPoint.name," \u2192 ").concat(k.endPoint.name,`
`),k.success?(y+="   \u8DDD\u79BB: ".concat((k.distance/1e3).toFixed(1),`km
`),y+="   \u65F6\u95F4: ".concat(Math.ceil(k.duration/60),`\u5206\u949F
`),y+="   \u65B9\u5F0F: ".concat(K[k.mode],`
`)):y+="   \u72B6\u6001: \u8BA1\u7B97\u5931\u8D25 - ".concat(k.error,`
`),y+=`
`}),y},i=function(){try{var p=u(),y=new Blob([p],{type:"text/plain;charset=utf-8"}),k=URL.createObjectURL(y),R=document.createElement("a");R.href=k,R.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(k),z.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6")}catch(S){console.error("\u5BFC\u51FA\u6587\u672C\u6587\u4EF6\u5931\u8D25:",S),z.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},t=function(){try{var p=n.filter(function(v){return v.checked}),y={metadata:{title:"\u65C5\u884C\u884C\u7A0B\u8BA1\u5212",exportTime:new Date().toISOString(),version:"1.0"},summary:{totalSpots:p.length,totalSegments:(a==null?void 0:a.segments.length)||0,totalDistance:(a==null?void 0:a.totalDistance)||0,totalDuration:(a==null?void 0:a.totalDuration)||0,successSegments:(a==null?void 0:a.segments.filter(function(v){return v.success}).length)||0},spots:p.map(function(v,B){return{order:B+1,id:v.id,name:v.name,location:v.location,region:v.region,coordinates:{latitude:v.lat,longitude:v.lng},transportMode:v.mode,transportModeName:K[v.mode]}}),routes:(a==null?void 0:a.segments.map(function(v,B){var F;return{segmentId:v.id,order:B+1,from:{name:v.startPoint.name,coordinates:v.startPoint.position},to:{name:v.endPoint.name,coordinates:v.endPoint.position},distance:v.distance,duration:v.duration,mode:v.mode,modeName:K[v.mode],success:v.success,error:v.error,polylinePoints:((F=v.polyline)===null||F===void 0?void 0:F.length)||0}}))||[]},k=new Blob([JSON.stringify(y,null,2)],{type:"application/json;charset=utf-8"}),R=URL.createObjectURL(k),S=document.createElement("a");S.href=R,S.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(R),z.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6")}catch(v){console.error("\u5BFC\u51FAJSON\u6587\u4EF6\u5931\u8D25:",v),z.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},c=function(){try{var p=n.filter(function(v){return v.checked}),y="\uFEFF";y+=`\u5E8F\u53F7,\u666F\u70B9\u540D\u79F0,\u4F4D\u7F6E,\u5730\u533A,\u7EAC\u5EA6,\u7ECF\u5EA6,\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0
`,p.forEach(function(v,B){y+="".concat(B+1,',"').concat(v.name,'","').concat(v.location,'","').concat(v.region,'",').concat(v.lat,",").concat(v.lng,',"').concat(v.mode,'","').concat(K[v.mode],`"
`)}),a&&a.segments.length>0&&(y+=`
\u8DEF\u6BB5\u5E8F\u53F7,\u8D77\u70B9,\u7EC8\u70B9,\u8DDD\u79BB(\u7C73),\u65F6\u95F4(\u79D2),\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0,\u72B6\u6001,\u9519\u8BEF\u4FE1\u606F
`,a.segments.forEach(function(v,B){y+="".concat(B+1,',"').concat(v.startPoint.name,'","').concat(v.endPoint.name,'",').concat(v.distance,",").concat(v.duration,',"').concat(v.mode,'","').concat(K[v.mode],'","').concat(v.success?"\u6210\u529F":"\u5931\u8D25",'","').concat(v.error||"",`"
`)}));var k=new Blob([y],{type:"text/csv;charset=utf-8"}),R=URL.createObjectURL(k),S=document.createElement("a");S.href=R,S.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(R),z.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6")}catch(v){console.error("\u5BFC\u51FACSV\u6587\u4EF6\u5931\u8D25:",v),z.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},o=function(){var p=document.createElement("input");p.type="file",p.accept=".json",p.onchange=function(y){var k,R=(k=y.target.files)===null||k===void 0?void 0:k[0];if(R){var S=new FileReader;S.onload=function(v){try{var B,F=JSON.parse((B=v.target)===null||B===void 0?void 0:B.result);if(F.spots&&Array.isArray(F.spots)){var I=F.spots.map(function(M,W){var $,g;return{id:"imported-".concat(Date.now(),"-").concat(W),name:M.name,location:M.location||M.name,region:M.region||"\u672A\u77E5",lat:(($=M.coordinates)===null||$===void 0?void 0:$.latitude)||M.lat,lng:((g=M.coordinates)===null||g===void 0?void 0:g.longitude)||M.lng,isStart:W===0,isEnd:W===F.spots.length-1,mode:M.transportMode||M.mode||"driving",checked:!0}});l?(l(I),z.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(I.length," \u4E2A\u666F\u70B9"))):z.ZP.error("\u5BFC\u5165\u529F\u80FD\u4E0D\u53EF\u7528")}else z.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u6B63\u786E\u7684JSON\u6587\u4EF6")}catch(M){console.error("\u5BFC\u5165\u6587\u4EF6\u89E3\u6790\u5931\u8D25:",M),z.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5JSON\u683C\u5F0F")}},S.readAsText(R)}},p.click()},d=function(){var f=j()(C()().mark(function p(){var y;return C()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.prev=0,y=u(),R.next=4,navigator.clipboard.writeText(y);case 4:z.ZP.success("\u884C\u7A0B\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"),R.next=11;break;case 7:R.prev=7,R.t0=R.catch(0),console.error("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25:",R.t0),z.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236");case 11:case"end":return R.stop()}},p,null,[[0,7]])}));return function(){return f.apply(this,arguments)}}(),h=function(){try{var p=n.filter(function(S){return S.checked}),y={spots:p.map(function(S){return{name:S.name,lat:S.lat,lng:S.lng,mode:S.mode}})},k=encodeURIComponent(JSON.stringify(y)),R="".concat(window.location.origin).concat(window.location.pathname,"?share=").concat(k);navigator.clipboard.writeText(R),z.ZP.success("\u5206\u4EAB\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch(S){console.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",S),z.ZP.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25")}},b=[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,s.jsx)(Se.Z,{}),onClick:o},{key:"txt",label:"\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6",icon:(0,s.jsx)(ge.Z,{}),onClick:i},{key:"json",label:"\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6",icon:(0,s.jsx)(ge.Z,{}),onClick:t},{key:"csv",label:"\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6",icon:(0,s.jsx)(Da.Z,{}),onClick:c},{key:"copy",label:"\u590D\u5236\u5230\u526A\u8D34\u677F",icon:(0,s.jsx)(ge.Z,{}),onClick:d},{key:"share",label:"\u751F\u6210\u5206\u4EAB\u94FE\u63A5",icon:(0,s.jsx)(ge.Z,{}),onClick:h}];return!e||!a||a.segments.length===0?(0,s.jsx)(ze.Z,{menu:{items:[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,s.jsx)(Se.Z,{}),onClick:o}]},placement:"bottomRight",trigger:["click"],children:(0,s.jsx)(Y.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(Se.Z,{}),title:"\u5BFC\u5165\u884C\u7A0B\u6570\u636E",children:"\u5BFC\u5165"})}):(0,s.jsx)(ze.Z,{menu:{items:b},placement:"bottomRight",trigger:["click"],children:(0,s.jsx)(Y.ZP,{type:"primary",size:"small",icon:(0,s.jsx)(Ba.Z,{}),children:"\u5BFC\u51FA"})})},Ma=Ea,se={mapHeader:"mapHeader___ZfXdw",headerTitle:"headerTitle___iBoRP",selectedMode:"selectedMode___VlGSk",routeInfo:"routeInfo___UvkLb",routeDetails:"routeDetails___IVH1j"},Fa=function(r){var n=r.planItems,a=r.routes,e=r.completeRoute,l=r.isSubmitted,u=r.selectedMode,i=r.routeDrawing,t=r.loading,c=r.mapLoading,o=r.onImportData;return(0,s.jsx)("div",{className:se.mapHeader,children:(0,s.jsxs)("div",{className:se.headerTitle,children:[(0,s.jsxs)("div",{children:[c?"\u5730\u56FE\u52A0\u8F7D\u4E2D...":t?l?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u8DEF\u7EBF\u4E2D...":i?"\u6B63\u5728\u7ED8\u5236".concat(K[u],"\u8DEF\u7EBF..."):l?e&&e.success?"\u5B8C\u6574\u884C\u7A0B\u8DEF\u7EBF (".concat(e.segments.filter(function(d){return d.success}).length,"/").concat(e.segments.length," \u6BB5\u6210\u529F)"):"\u5B8C\u6574\u8DEF\u5F84\u8BA1\u7B97":a.length>0?"\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4 (".concat(a.filter(function(d){return d.success}).length,"/").concat(a.length," \u79CD\u53EF\u7528)"):"\u8DEF\u7EBF\u9884\u89C8",(l?e:a.length>0)&&!t&&(0,s.jsxs)("div",{className:se.routeInfo,children:["\u5F53\u524D\u663E\u793A: ",(0,s.jsx)("span",{style:{color:V[u]},className:se.selectedMode,children:K[u]||u})," \u8DEF\u7EBF",l&&e&&(0,s.jsxs)("span",{className:se.routeDetails,children:["\u603B\u8DDD\u79BB: ",(e.totalDistance/1e3).toFixed(1),"km | \u603B\u65F6\u95F4: ",Math.ceil(e.totalDuration/60),"\u5206\u949F"]})]})]}),(0,s.jsx)(Ma,{planItems:n,completeRoute:e,isSubmitted:l,onImportData:o})]})})},ja=Fa,Ia=m(35937),Ce={spin:"spin___H6Z9A",detailContainer:"detailContainer___UnJZd",emptyState:"emptyState___GJe_C"},za=function(r){var n=r.loading,a=r.mapLoading,e=r.isSubmitted,l=r.completeRoute,u=r.routes,i=he.Z.useToken(),t=i.token;return n||a||e&&l||!e&&u.length>0?null:(0,s.jsx)("div",{className:Ce.emptyState,style:{color:t.colorTextDescription},children:e?"\u8BF7\u9009\u62E9\u81F3\u5C112\u4E2A\u666F\u70B9\u8BA1\u7B97\u8DEF\u5F84":"\u8BF7\u8BBE\u7F6E\u8D77\u70B9\u548C\u7EC8\u70B9\u67E5\u770B\u8DEF\u7EBF"})},Ta=za,Te=m(72504),ce=m(60980),Ze=m(4422),Za=function(r){var n=r.isSubmitted,a=r.loading,e=r.routes,l=r.selectedMode,u=r.routeDrawing,i=r.handleModeChange,t=he.Z.useToken(),c=t.token,o=Te.Z.Text;return n||a||e.length<=0?null:(0,s.jsxs)(J.Z,{vertical:!0,gap:"small",children:[(0,s.jsx)(o,{strong:!0,style:{fontSize:"13px",marginTop:"8px"},children:"\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4\uFF1A"}),(0,s.jsx)(ce.Z,{size:"small",dataSource:e,split:!1,renderItem:function(h){return(0,s.jsx)(ce.Z.Item,{onClick:function(){return h.success&&!u&&i(h.mode)},style:{background:h.success?l===h.mode?c.colorInfoBg:"#f5f5f5":c.colorErrorBg,border:"none",borderRadius:c.borderRadiusSM,cursor:h.success?"pointer":"not-allowed",opacity:h.success?1:.6,transition:"all 0.3s ease",padding:"6px 12px",marginBottom:"5px",alignItems:"center",boxShadow:l===h.mode?"0 0 0 1px ".concat(V[h.mode],"40"):"none"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,s.jsx)(Ze.Z,{dot:!0,offset:[-2,8],style:{backgroundColor:V[h.mode],boxShadow:l===h.mode&&h.success?"0 0 0 2px ".concat(V[h.mode],"40"):"none",marginRight:8}}),(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:(0,s.jsxs)(J.Z,{align:"center",gap:8,children:[(0,s.jsxs)(o,{strong:!0,style:{fontSize:c.fontSizeSM,color:l===h.mode&&h.success?V[h.mode]:void 0},children:[K[h.mode],l===h.mode&&h.success]}),h.success?(0,s.jsxs)(o,{type:"secondary",style:{fontSize:"11px"},children:["\u8DDD\u79BB: ",(h.distance/1e3).toFixed(1),"km | \u65F6\u95F4:"," ",Math.ceil(h.duration/60),"\u5206\u949F",h.mode==="transfer"&&" | \u542B\u6362\u4E58"]}):(0,s.jsx)(o,{type:"danger",style:{fontSize:"11px"},children:h.error||"\u8DEF\u7EBF\u4E0D\u53EF\u7528"})]})})]})},h.mode)}})]})},La=Za,Na=m(96761),Wa=function(r){var n=r.isSubmitted,a=r.completeRoute,e=r.selectedSegment,l=r.handleSegmentClick,u=he.Z.useToken(),i=u.token,t=Te.Z.Text;return!n||!a?null:(0,s.jsxs)(J.Z,{vertical:!0,gap:"small",children:[(0,s.jsx)(t,{strong:!0,style:{fontSize:"13px",marginTop:"8px"},children:"\u884C\u7A0B\u8DEF\u7EBF\u8BE6\u60C5:"}),(0,s.jsx)(ce.Z,{size:"small",dataSource:a.segments,split:!1,renderItem:function(o){return(0,s.jsx)(ce.Z.Item,{onClick:function(){return o.success&&l(o.id)},style:{background:o.success?e===o.id?i.colorInfoBg:"#f5f5f5":i.colorErrorBg,border:"none",borderRadius:i.borderRadiusSM,cursor:o.success?"pointer":"not-allowed",opacity:o.success?1:.6,transition:"all 0.3s ease",padding:"0px 0px 0px 5px",marginBottom:"5px",boxShadow:e===o.id?"0 0 0 1px ".concat(V[o.mode],"40"):"none"},children:(0,s.jsx)(ce.Z.Item.Meta,{avatar:(0,s.jsx)(Ze.Z,{dot:!0,offset:[8,5],style:{backgroundColor:V[o.mode],boxShadow:e===o.id?"0 0 0 2px ".concat(V[o.mode],"40"):"none"}}),title:(0,s.jsxs)(t,{strong:!0,style:{fontSize:i.fontSizeSM,color:e===o.id?V[o.mode]:void 0},children:[o.startPoint.name," \u2192 ",o.endPoint.name,e===o.id]}),description:o.success?(0,s.jsxs)(t,{type:"secondary",style:{fontSize:i.fontSizeSM},children:["\u8DDD\u79BB: ",(o.distance/1e3).toFixed(1),"km | \u65F6\u95F4:"," ",Math.ceil(o.duration/60),"\u5206\u949F | \u65B9\u5F0F:"," ",K[o.mode]]}):(0,s.jsx)(t,{type:"danger",style:{fontSize:i.fontSizeSM},children:o.error})})},o.id)}}),a.segments.some(function(c){return c.success})&&(0,s.jsxs)(Na.Z,{type:"inner",size:"small",style:{fontSize:i.fontSizeSM,background:i.colorInfoBg,borderColor:i.colorInfoBorder},children:[(0,s.jsx)(t,{style:{fontSize:i.fontSizeSM},strong:!0,children:"\u603B\u8BA1\uFF1A"}),(0,s.jsxs)("span",{children:["\u8DDD\u79BB ",(a.totalDistance/1e3).toFixed(1),"km | \u65F6\u95F4"," ",Math.ceil(a.totalDuration/60),"\u5206\u949F"]})]})]})},Oa=Wa,$a=function(r){var n=r.loading,a=r.isSubmitted,e=r.completeRoute,l=r.routes,u=r.selectedMode,i=r.selectedSegment,t=r.routeDrawing,c=r.mapLoading,o=r.handleSegmentClick,d=r.handleModeChange;return n?(0,s.jsxs)("div",{children:[(0,s.jsx)(Ia.Z,{size:"small",className:Ce.spin})," ",a?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u4E2D..."]}):(0,s.jsxs)("div",{className:Ce.detailContainer,children:[(0,s.jsx)(Oa,{isSubmitted:a,completeRoute:e,selectedSegment:i,handleSegmentClick:o}),(0,s.jsx)(La,{isSubmitted:a,loading:n,routes:l,selectedMode:u,routeDrawing:t,handleModeChange:d}),(0,s.jsx)(Ta,{loading:n,mapLoading:c,isSubmitted:a,completeRoute:e,routes:l})]})},Ka=$a,Va="c235c1e78c16464f41d866fe4c811c58",Ha="3e3153b7d6dec0cb487d2afde4795453",Ja=function(){return new Promise(function(r,n){if(window.AMap){r();return}window._AMapSecurityConfig={securityJsCode:Ha};var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src="https://webapi.amap.com/maps?v=2.0&key=".concat(Va),a.onload=function(){console.log("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u6210\u529F"),r()},a.onerror=function(e){console.error("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u5931\u8D25:",e),n(e)},document.head.appendChild(a)})},Ua=function(r){var n=(0,D.useRef)(null),a=(0,D.useRef)(null),e=(0,D.useRef)(null),l=(0,D.useState)(!0),u=T()(l,2),i=u[0],t=u[1];return(0,D.useEffect)(function(){var c=function(){var o=j()(C()().mark(function d(){var h;return C()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(n.current){f.next=2;break}return f.abrupt("return");case 2:return f.prev=2,f.next=5,Ja();case 5:return h=Ie[r]||Ie.\u676D\u5DDE,a.current=new window.AMap.Map(n.current,{zoom:r==="\u676D\u5DDE"?4:11,center:h,mapStyle:"amap://styles/normal",showLabel:!0,showBuildingBlock:!0,viewMode:"2D",pitch:0,skyColor:"#ffffff",features:["bg","point","road","building"],resizeEnable:!0,rotateEnable:!0,pitchEnable:!0,zoomEnable:!0,dragEnable:!0,keyboardEnable:!0,doubleClickZoom:!0,scrollWheel:!0,touchZoom:!0,touchZoomCenter:1,animateEnable:!0}),e.current=new fa(a.current),f.prev=8,f.next=11,new Promise(function(p){window.AMap.plugin(["AMap.Scale","AMap.ToolBar","AMap.ControlBar"],function(){window.AMap.Scale&&a.current.addControl(new window.AMap.Scale({position:"LB"})),window.AMap.ToolBar&&a.current.addControl(new window.AMap.ToolBar({locate:!0,position:"LT",direction:!0,autoPosition:!1,locationMarker:!0,useNative:!0})),window.AMap.ControlBar&&a.current.addControl(new window.AMap.ControlBar({position:"RT"})),p()})});case 11:f.next=16;break;case 13:f.prev=13,f.t0=f.catch(8),console.warn("\u5730\u56FE\u63A7\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u4F46\u4E0D\u5F71\u54CD\u4E3B\u8981\u529F\u80FD:",f.t0);case 16:t(!1),f.next=23;break;case 19:f.prev=19,f.t1=f.catch(2),console.error("\u5730\u56FE\u521D\u59CB\u5316\u5931\u8D25:",f.t1),t(!1);case 23:case"end":return f.stop()}},d,null,[[2,19],[8,13]])}));return function(){return o.apply(this,arguments)}}();return c(),function(){a.current&&(a.current.destroy(),a.current=null)}},[r]),{mapContainerRef:n,mapInstanceRef:a,mapLoading:i,routeServiceRef:e}},Ya=function(r,n,a){(0,D.useEffect)(function(){if(!(!r.current||n.length===0)){var e=r.current.getAllOverlays("marker");e.forEach(function(u){r.current.remove(u)});var l=[];n.forEach(function(u,i){if(!(!u.lat||!u.lng)){var t="";if(a&&u.checked){var c=n.filter(function(h){return h.checked}),o=c.findIndex(function(h){return h.id===u.id});t='<div style="background: #1890ff; color: white; padding: 6px 10px; border-radius: 50%; font-size: 14px; font-weight: bold; min-width: 28px; text-align: center;">'.concat(o+1,"</div>")}else u.isStart?t='<div style="background: #52c41a; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u8D77\u70B9</div>':u.isEnd?t='<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u7EC8\u70B9</div>':t='<div style="background: #1890ff; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">'.concat(i+1,"</div>");var d=new window.AMap.Marker({position:[u.lng,u.lat],content:t,title:u.name,anchor:"center",offset:new window.AMap.Pixel(0,-15),label:{content:u.name,direction:"top",offset:new window.AMap.Pixel(0,-10),style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"}}});l.push(d),r.current.add(d)}}),l.length>0&&r.current.setFitView(l,!1,[20,20,20,20])}},[r,n,a])},Ga=function(r,n,a,e,l){var u=(0,D.useState)([]),i=T()(u,2),t=i[0],c=i[1],o=(0,D.useState)(null),d=T()(o,2),h=d[0],b=d[1],f=(0,D.useState)(!1),p=T()(f,2),y=p[0],k=p[1];return(0,D.useEffect)(function(){var R=function(){var S=j()(C()().mark(function v(){var B,F,I,M,W;return C()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(!r.current||l)){g.next=2;break}return g.abrupt("return");case 2:if(k(!0),g.prev=3,!a){g.next=16;break}if(B=n.filter(function(L){return L.checked}),!(B.length<2)){g.next=9;break}return b(null),g.abrupt("return");case 9:return g.next=11,r.current.calculateCompleteRouteWithModes(B);case 11:F=g.sent,b(F),F.success&&F.segments.length>0&&r.current.drawCompleteRoute(F),g.next=25;break;case 16:if(I=n.find(function(L){return L.isStart}),M=n.find(function(L){return L.isEnd}),!(!I||!M)){g.next=21;break}return c([]),g.abrupt("return");case 21:return g.next=23,r.current.getAllRoutes([I.lng,I.lat],[M.lng,M.lat],e);case 23:W=g.sent,c(W);case 25:g.next=31;break;case 27:g.prev=27,g.t0=g.catch(3),console.error("\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25:",g.t0),a?b(null):c([]);case 31:return g.prev=31,k(!1),g.finish(31);case 34:case"end":return g.stop()}},v,null,[[3,27,31,34]])}));return function(){return S.apply(this,arguments)}}();R()},[n,a,e,l,r]),{routes:t,completeRoute:h,loading:y,setRoutes:c,setCompleteRoute:b}},Xa=function(r,n,a,e){var l=(0,D.useState)("driving"),u=T()(l,2),i=u[0],t=u[1],c=(0,D.useState)(null),o=T()(c,2),d=o[0],h=o[1],b=(0,D.useState)(!1),f=T()(b,2),p=f[0],y=f[1],k=function(){var S=j()(C()().mark(function v(B){var F,I,M,W;return C()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(!r.current||p||e)){g.next=2;break}return g.abrupt("return");case 2:if(F=a.find(function(L){return L.isStart}),I=a.find(function(L){return L.isEnd}),!(!F||!I)){g.next=6;break}return g.abrupt("return");case 6:if(M=n.find(function(L){return L.mode===B}),!(!M||!M.success)){g.next=9;break}return g.abrupt("return");case 9:return y(!0),t(B),g.prev=11,g.next=14,r.current.drawRoute([F.lng,F.lat],[I.lng,I.lat],B);case 14:W=g.sent,W||z.ZP.error("".concat(K[B],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25")),g.next=22;break;case 18:g.prev=18,g.t0=g.catch(11),console.error("\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",g.t0),z.ZP.error("".concat(K[B],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25"));case 22:return g.prev=22,y(!1),g.finish(22);case 25:case"end":return g.stop()}},v,null,[[11,18,22,25]])}));return function(B){return S.apply(this,arguments)}}(),R=function(v){if(!r.current){console.error("routeService \u672A\u521D\u59CB\u5316");return}d===v?(h(null),r.current.resetSegmentHighlight()):(h(v),r.current.highlightSegment(v))};return{selectedMode:i,selectedSegment:d,routeDrawing:p,handleModeChange:k,handleSegmentClick:R,setSelectedMode:t}},Qa=function(r){var n=r.planItems,a=r.isSubmitted,e=a===void 0?!1:a,l=r.city,u=l===void 0?"\u676D\u5DDE":l,i=r.onImportData,t=Ua(u),c=t.mapContainerRef,o=t.mapInstanceRef,d=t.mapLoading,h=t.routeServiceRef;Ya(o,n,e);var b=Ga(h,n,e,u,d),f=b.routes,p=b.completeRoute,y=b.loading,k=Xa(h,f,n,e),R=k.selectedMode,S=k.selectedSegment,v=k.routeDrawing,B=k.handleModeChange,F=k.handleSegmentClick,I=function(W){i==null||i(W)};return(0,s.jsxs)(J.Z,{vertical:!0,style:{height:"100%",overflow:"auto",border:"1px solid #f0f0f0",borderRadius:8},children:[(0,s.jsx)(ja,{planItems:n,routes:f,completeRoute:p,isSubmitted:e,selectedMode:R,routeDrawing:v,loading:y,mapLoading:d,onImportData:I}),(0,s.jsx)("div",{style:{flex:1,minHeight:"40vh"},children:(0,s.jsx)(xa,{mapContainerRef:c})}),(0,s.jsx)(Ka,{loading:y,isSubmitted:e,completeRoute:p,routes:f,selectedMode:R,selectedSegment:S,routeDrawing:v,mapLoading:d,handleSegmentClick:F,handleModeChange:B})]})},Le=Qa,qa=function(r){var n=r.planItems,a=r.setPlanItems,e=r.isSubmitted,l=r.onImportData,u=r.onSubmit,i=r.onEdit;return(0,s.jsxs)(Ke.Z,{gutter:[16,16],style:{height:"100%"},children:[(0,s.jsx)(Fe.Z,{xs:24,lg:14,style:{height:"100%"},children:(0,s.jsx)(Ra,{items:n,setItems:a,isSubmitted:e,onSubmit:u,onEdit:i})}),(0,s.jsx)(Fe.Z,{xs:24,lg:10,style:{height:"100%"},children:(0,s.jsx)(Le,{planItems:n,isSubmitted:e,city:n.length>0?n[0].region:"\u676D\u5DDE",onImportData:l})})]})},_a=qa,ke={layout:"layout___F0kCh",contentContainer:"contentContainer___G9f2i",content:"content___nGCOl"},en=m(43559),te={header:"header___gCFwP",logo:"logo___aO8oL",menu:"menu___n76AM",planInfo:"planInfo___Bb004",clearButton:"clearButton___VhSxa",planCount:"planCount___N3KCR"},an=m(57705),nn=m(38913),tn=function(r){var n=r.selectedKey,a=r.planItems,e=r.onMenuSelect,l=r.onClearAll,u=function(t){var c=t.key;e(c)};return(0,s.jsxs)(en.h4,{className:te.header,children:[(0,s.jsx)("div",{className:te.logo,children:"\u81EA\u5B9A\u4E49\u65C5\u884C\u8BA1\u5212"}),(0,s.jsx)(an.Z,{theme:"dark",mode:"horizontal",selectedKeys:[n],onClick:u,items:[{key:"1",label:"\u613F\u671B\u666F\u70B9\u5355"},{key:"2",label:"\u5728\u7EBF\u8BB0\u4E8B\u672C"}],className:te.menu}),a.length>0&&(0,s.jsxs)("div",{className:te.planInfo,children:[(0,s.jsxs)("span",{className:te.planCount,children:["\u5DF2\u4FDD\u5B58 ",a.length," \u4E2A\u666F\u70B9"]}),(0,s.jsx)(Y.ZP,{type:"text",size:"small",icon:(0,s.jsx)(nn.Z,{}),onClick:l,className:te.clearButton,title:"\u6E05\u9664\u6240\u6709\u6570\u636E",children:"\u6E05\u9664"})]})]})},rn=tn,Re="travel_plan_items",Pe="travel_plan_submitted",ln=function(r,n){try{localStorage.setItem(Re,JSON.stringify(r)),localStorage.setItem(Pe,JSON.stringify(n)),console.log("\u6570\u636E\u5DF2\u4FDD\u5B58\u5230localStorage")}catch(a){console.error("\u4FDD\u5B58\u5230localStorage\u5931\u8D25:",a)}},un=function(){try{var r=localStorage.getItem(Re),n=localStorage.getItem(Pe),a=r?JSON.parse(r):[],e=n?JSON.parse(n):!1;return console.log("\u4ECElocalStorage\u52A0\u8F7D\u6570\u636E:",{planItems:a.length,isSubmitted:e}),{planItems:a,isSubmitted:e}}catch(l){return console.error("\u4ECElocalStorage\u52A0\u8F7D\u5931\u8D25:",l),{planItems:[],isSubmitted:!1}}},on=function(){try{localStorage.removeItem(Re),localStorage.removeItem(Pe),console.log("localStorage\u5DF2\u6E05\u9664")}catch(r){console.error("\u6E05\u9664localStorage\u5931\u8D25:",r)}},sn=function(r,n,a){(0,D.useEffect)(function(){var e=new URLSearchParams(window.location.search),l=e.get("share");if(l)try{var u=JSON.parse(decodeURIComponent(l));if(u.spots&&Array.isArray(u.spots)){var i=u.spots.map(function(t,c){return{id:"shared-".concat(Date.now(),"-").concat(c),name:t.name,location:t.name,region:"\u672A\u77E5",lat:t.lat,lng:t.lng,isStart:c===0,isEnd:c===u.spots.length-1,mode:t.mode||"driving",checked:!0}});r(i),n("2"),a(!0),z.ZP.success("\u5DF2\u5BFC\u5165\u5206\u4EAB\u7684\u884C\u7A0B\u8BA1\u5212"),window.history.replaceState({},document.title,window.location.pathname)}}catch(t){console.error("\u89E3\u6790\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",t),z.ZP.error("\u5206\u4EAB\u94FE\u63A5\u683C\u5F0F\u4E0D\u6B63\u786E")}},[])},cn=m(92275),dn=m.n(cn),wn=m(56628);function hn(){var w=(0,D.useState)(""),r=T()(w,2),n=r[0],a=r[1],e={toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]};return(0,s.jsx)(dn(),{theme:"snow",value:n,onChange:a,modules:e,placeholder:"\u5F00\u59CB\u8BB0\u5F55\u4F60\u7684\u65C5\u6E38\u7B14\u8BB0\u5427~"})}var vn=hn,Ne=m(49418),pe={label:"label___e_oPN",children:"children___BnC17",collapseItems:"collapseItems___Ohcid"},fn=function(r){var n=r.planItems,a=r.isSubmitted,e=r.activeKeys,l=r.onActiveKeysChange,u=r.onImportData,i=n.length>0?n[0].region:"\u676D\u5DDE",t=[{key:"note",label:(0,s.jsx)("span",{className:pe.label,children:"\u{1F4DD} \u65C5\u884C\u7B14\u8BB0"}),children:(0,s.jsx)(vn,{})},{key:"map",label:(0,s.jsx)("span",{className:pe.label,children:"\u{1F5FA}\uFE0F \u65C5\u884C\u5730\u56FE"}),children:(0,s.jsx)("div",{className:pe.children,children:(0,s.jsx)(Le,{planItems:n,isSubmitted:a,city:i,onImportData:u})})}];return(0,s.jsx)(J.Z,{gap:"middle",vertical:!0,children:(0,s.jsx)(Ne.Z,{activeKey:e,onChange:function(o){return l(o)},bordered:!1,expandIconPosition:"end",className:pe.collapseItems,collapsible:"header",children:t.map(function(c){return(0,s.jsx)(Ne.Z.Panel,{header:c.label,children:c.children},String(c.key))})})})},gn=fn,pn=Me.Z.Content,mn=function(){var r=(0,D.useState)([]),n=T()(r,2),a=n[0],e=n[1],l=(0,D.useState)("1"),u=T()(l,2),i=u[0],t=u[1],c=(0,D.useState)(!1),o=T()(c,2),d=o[0],h=o[1],b=(0,D.useState)(["map"]),f=T()(b,2),p=f[0],y=f[1],k=he.Z.useToken(),R=k.token,S=R.colorBgContainer,v=R.borderRadiusLG;sn(e,t,h),(0,D.useEffect)(function(){var g=un();g.planItems.length>0&&(e(g.planItems),h(g.isSubmitted),z.ZP.success("\u5DF2\u6062\u590D ".concat(g.planItems.length," \u4E2A\u666F\u70B9\u7684\u65C5\u884C\u8BA1\u5212")))},[]),(0,D.useEffect)(function(){a.length>0&&ln(a,d)},[a,d]);var B=function(){e([]),h(!1),on(),z.ZP.success("\u5DF2\u6E05\u9664\u6240\u6709\u6570\u636E")},F=function(L){t(L)},I=function(L){e(L),h(!1),t("2")},M=function(){h(!0)},W=function(){h(!1)},$=function(){switch(i){case"1":return(0,s.jsx)(_a,{planItems:a,setPlanItems:e,isSubmitted:d,onSubmit:M,onEdit:W,onImportData:I});case"2":return(0,s.jsx)(gn,{planItems:a,isSubmitted:d,activeKeys:p,onActiveKeysChange:y,onImportData:I});default:return null}};return(0,s.jsxs)(Me.Z,{className:ke.layout,children:[(0,s.jsx)(rn,{selectedKey:i,planItems:a,onMenuSelect:F,onClearAll:B}),(0,s.jsx)(pn,{className:ke.contentContainer,children:(0,s.jsx)("div",{className:ke.content,style:{backgroundColor:S,borderRadius:v},children:$()})})]})},yn=mn}}]);
