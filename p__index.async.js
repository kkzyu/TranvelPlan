"use strict";(self.webpackChunktravel_plan=self.webpackChunktravel_plan||[]).push([[866],{64800:function(kn,we,p){p.r(we),p.d(we,{default:function(){return Sn}});var Ie=p(48305),A=p.n(Ie),S=p(75271),Ce=p(56564),le=p(51555),x=p(3988),Te=p(63092),ke=p(23297),Le=p(15558),de=p.n(Le),ze=p(26068),E=p.n(ze),he=p(26729),O=p(28375),ie=p(99546),ue=p(5574),V=p(92974),Ze=p(90228),b=p.n(Ze),Ne=p(87999),k=p.n(Ne),Pe=p(34329),We=p(79306),Oe=p(99247),$e=p(64533),Ke="ac47d45ec5e5e8ddf58b95e9e99ede62",Ve=function(){var f=k()(b()().mark(function t(n,r){var e,l;return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,$e.Z.get("https://restapi.amap.com/v5/place/text",{params:{key:Ke,keywords:n,city:r,output:"json"}});case 3:if(e=i.sent,!(e.data&&e.data.status==="1"&&e.data.pois)){i.next=9;break}return l=e.data.pois.map(function(a){var c=a.location.split(","),s=A()(c,2),d=s[0],h=s[1];return{id:a.id,name:a.name,address:a.address,location:{lat:parseFloat(h),lng:parseFloat(d)},cityname:a.cityname,adname:a.adname}}),i.abrupt("return",l);case 9:return console.error("\u9AD8\u5FB7 API \u8FD4\u56DE\u9519\u8BEF:",e.data.info),i.abrupt("return",[]);case 11:i.next=17;break;case 13:return i.prev=13,i.t0=i.catch(0),console.error("\u641C\u7D22\u5730\u70B9\u8BF7\u6C42\u5931\u8D25:",i.t0),i.abrupt("return",[]);case 17:case"end":return i.stop()}},t,null,[[0,13]])}));return function(n,r){return f.apply(this,arguments)}}(),He=p(25298),q=p.n(He),Ue=p(17069),_=p.n(Ue),Je=p(31759),Ge=p.n(Je),Ye=function(){function f(){q()(this,f)}return _()(f,[{key:"calculateSingleSegment",value:function(){var t=k()(b()().mark(function r(e,l,u,i){var a;return b()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:s.prev=0,s.t0=u,s.next=s.t0==="driving"?4:s.t0==="walking"?8:s.t0==="riding"?12:s.t0==="transfer"?16:20;break;case 4:return s.next=6,this.getDrivingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 6:return a=s.sent,s.abrupt("break",23);case 8:return s.next=10,this.getWalkingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 10:return a=s.sent,s.abrupt("break",23);case 12:return s.next=14,this.getRidingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 14:return a=s.sent,s.abrupt("break",23);case 16:return s.next=18,this.getTransferRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat],"\u676D\u5DDE");case 18:return a=s.sent,s.abrupt("break",23);case 20:return s.next=22,this.getDrivingRouteWithPolyline([e.lng,e.lat],[l.lng,l.lat]);case 22:a=s.sent;case 23:return s.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:l.name,position:[l.lng,l.lat]},distance:a.distance,duration:a.duration,mode:u,polyline:a.polyline||[],success:a.success,error:a.error});case 26:return s.prev=26,s.t1=s.catch(0),console.error("\u8DEF\u6BB5\u8BA1\u7B97\u5931\u8D25:",s.t1),s.abrupt("return",{id:i,startPoint:{name:e.name,position:[e.lng,e.lat]},endPoint:{name:l.name,position:[l.lng,l.lat]},distance:0,duration:0,mode:u,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 30:case"end":return s.stop()}},r,this,[[0,26]])}));function n(r,e,l,u){return t.apply(this,arguments)}return n}()},{key:"getDrivingRouteWithPolyline",value:function(){var t=k()(b()().mark(function r(e,l){var u=this;return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,U();case 3:a.next=8;break;case 5:return a.prev=5,a.t0=a.catch(0),a.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(Y("driving")){a.next=10;break}return a.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return a.abrupt("return",new Promise(function(c){var s=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});s.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var g=h.routes[0],v=u.extractPolylineFromRoute(g);c({mode:"driving",distance:g.distance,duration:g.time,success:!0,polyline:v})}else c({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return a.stop()}},r,null,[[0,5]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getWalkingRouteWithPolyline",value:function(){var t=k()(b()().mark(function r(e,l){var u=this;return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,U();case 3:a.next=8;break;case 5:return a.prev=5,a.t0=a.catch(0),a.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(Y("walking")){a.next=10;break}return a.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return a.abrupt("return",new Promise(function(c){var s=new window.AMap.Walking({map:null,autoFitView:!1});s.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var g=h.routes[0],v=u.extractPolylineFromRoute(g);c({mode:"walking",distance:g.distance,duration:g.time,success:!0,polyline:v})}else c({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return a.stop()}},r,null,[[0,5]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getRidingRouteWithPolyline",value:function(){var t=k()(b()().mark(function r(e,l){var u=this;return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,U();case 3:a.next=8;break;case 5:return a.prev=5,a.t0=a.catch(0),a.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 8:if(Y("riding")){a.next=10;break}return a.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 10:return a.abrupt("return",new Promise(function(c){var s=new window.AMap.Riding({map:null,autoFitView:!1});s.search(e,l,function(d,h){if(d==="complete"&&h.routes&&h.routes.length>0){var g=h.routes[0],v=u.extractPolylineFromRoute(g);c({mode:"riding",distance:g.distance,duration:g.time||g.duration,success:!0,polyline:v})}else c({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 11:case"end":return a.stop()}},r,null,[[0,5]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getTransferRouteWithPolyline",value:function(){var t=k()(b()().mark(function r(e,l){var u=this,i,a=arguments;return b()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=a.length>2&&a[2]!==void 0?a[2]:"\u676D\u5DDE",s.prev=1,s.next=4,U();case 4:s.next=9;break;case 6:return s.prev=6,s.t0=s.catch(1),s.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25",polyline:[]});case 9:if(Y("transfer")){s.next=11;break}return s.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u4E0D\u53EF\u7528",polyline:[]});case 11:return s.abrupt("return",new Promise(function(d){var h=new window.AMap.Transfer({map:null,city:i,autoFitView:!1});h.search(e,l,function(g,v){if(g==="complete"&&v.plans&&v.plans.length>0){var m=v.plans[0],C=u.extractPolylineFromRoute(m);d({mode:"transfer",distance:m.distance,duration:m.time,success:!0,polyline:C})}else d({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25",polyline:[]})})}));case 12:case"end":return s.stop()}},r,null,[[1,6]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"extractPolylineFromRoute",value:function(n){var r=this,e=[];if(n.rides&&Array.isArray(n.rides))return n.rides.forEach(function(u){u.path&&Array.isArray(u.path)&&u.path.forEach(function(i){var a=r.extractPosition(i);a&&e.push(a)})}),e;if(n.steps&&Array.isArray(n.steps))n.steps.forEach(function(u,i){if(u.polyline){var a=r.parsePolyline(u.polyline);e.push.apply(e,de()(a))}else if(u.path&&Array.isArray(u.path))u.path.forEach(function(d,h){if(d&&Ge()(d)==="object"){var g,v;if(d.lng!==void 0&&d.lat!==void 0)g=d.lng,v=d.lat;else if(d.longitude!==void 0&&d.latitude!==void 0)g=d.longitude,v=d.latitude;else if(d.x!==void 0&&d.y!==void 0)g=d.x,v=d.y;else if(Array.isArray(d)&&d.length>=2)g=d[0],v=d[1];else if(d.getPosition&&typeof d.getPosition=="function"){var m=d.getPosition();g=m.getLng(),v=m.getLat()}g!==void 0&&v!==void 0&&!isNaN(g)&&!isNaN(v)&&e.push([g,v])}});else{if(u.start_location){var c=r.extractPosition(u.start_location);c&&e.push(c)}if(u.end_location){var s=r.extractPosition(u.end_location);s&&e.push(s)}}});else if(n.path&&Array.isArray(n.path))n.path.forEach(function(u,i){var a=r.extractPosition(u);a&&e.push(a)});else if(n.polyline){var l=this.parsePolyline(n.polyline);e.push.apply(e,de()(l))}return e}},{key:"extractPosition",value:function(n){if(!n)return null;var r,e;if(n.lng!==void 0&&n.lat!==void 0)r=n.lng,e=n.lat;else if(n.longitude!==void 0&&n.latitude!==void 0)r=n.longitude,e=n.latitude;else if(n.x!==void 0&&n.y!==void 0)r=n.x,e=n.y;else if(Array.isArray(n)&&n.length>=2)r=n[0],e=n[1];else if(n.getPosition&&typeof n.getPosition=="function"){var l=n.getPosition();r=l.getLng(),e=l.getLat()}else n.getLng&&typeof n.getLng=="function"&&(r=n.getLng(),e=n.getLat());return r!==void 0&&e!==void 0&&!isNaN(r)&&!isNaN(e)?[r,e]:null}},{key:"parsePolyline",value:function(n){if(!n||typeof n!="string")return[];try{var r;n.includes(";")?r=n.split(";"):n.includes("|")?r=n.split("|"):n.includes(" ")?r=n.split(" "):r=[n];for(var e=[],l=0;l<r.length;l++){var u=r[l].trim();if(u){var i=u.split(",");if(i.length>=2){var a=parseFloat(i[0]),c=parseFloat(i[1]);!isNaN(a)&&!isNaN(c)&&a>=-180&&a<=180&&c>=-90&&c<=90&&e.push([a,c])}}}return e}catch(s){return[]}}}]),f}(),Xe=new Ye,Qe=function(){var f=k()(b()().mark(function t(n,r,e,l){return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Xe.calculateSingleSegment(n,r,e,l));case 1:case"end":return i.stop()}},t)}));return function(n,r,e,l){return f.apply(this,arguments)}}(),qe=function(){function f(){q()(this,f)}return _()(f,[{key:"getDrivingRoute",value:function(){var t=k()(b()().mark(function r(e,l){return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,U();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(a){var c=new window.AMap.Driving({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(s,d){if(s==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];a({mode:"driving",distance:h.distance,duration:h.time,success:!0})}else a({mode:"driving",distance:0,duration:0,success:!1,error:"\u9A7E\u8F66\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},r,null,[[0,5]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getWalkingRoute",value:function(){var t=k()(b()().mark(function r(e,l){return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,U();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(a){var c=new window.AMap.Walking({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(s,d){if(s==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];a({mode:"walking",distance:h.distance,duration:h.time,success:!0})}else a({mode:"walking",distance:0,duration:0,success:!1,error:"\u6B65\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},r,null,[[0,5]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getRidingRoute",value:function(){var t=k()(b()().mark(function r(e,l){return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,U();case 3:i.next=8;break;case 5:return i.prev=5,i.t0=i.catch(0),i.abrupt("return",{mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 8:return i.abrupt("return",new Promise(function(a){var c=new window.AMap.Riding({map:null,showTraffic:!1,autoFitView:!1});c.search(e,l,function(s,d){if(s==="complete"&&d.routes&&d.routes.length>0){var h=d.routes[0];a({mode:"riding",distance:h.distance,duration:h.time,success:!0})}else a({mode:"riding",distance:0,duration:0,success:!1,error:"\u9A91\u884C\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 9:case"end":return i.stop()}},r,null,[[0,5]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getTransitRoute",value:function(){var t=k()(b()().mark(function r(e,l){var u,i=arguments;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u=i.length>2&&i[2]!==void 0?i[2]:"\u676D\u5DDE",c.prev=1,c.next=4,U();case 4:c.next=9;break;case 6:return c.prev=6,c.t0=c.catch(1),c.abrupt("return",{mode:"transfer",distance:0,duration:0,success:!1,error:"\u8DEF\u7EBF\u89C4\u5212\u63D2\u4EF6\u52A0\u8F7D\u5931\u8D25"});case 9:return c.abrupt("return",new Promise(function(s){var d=new window.AMap.Transfer({map:null,city:u==="\u676D\u5DDE"?"\u5317\u4EAC":u,autoFitView:!1});d.search(e,l,function(h,g){if(h==="complete"&&g.plans&&g.plans.length>0){var v=g.plans[0];s({mode:"transfer",distance:v.distance,duration:v.time,success:!0})}else s({mode:"transfer",distance:0,duration:0,success:!1,error:"\u516C\u4EA4\u8DEF\u7EBF\u67E5\u8BE2\u5931\u8D25"})})}));case 10:case"end":return c.stop()}},r,null,[[1,6]])}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"getAllRoutes",value:function(){var t=k()(b()().mark(function r(e,l){var u,i,a=arguments;return b()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u=a.length>2&&a[2]!==void 0?a[2]:"\u676D\u5DDE",s.next=3,Promise.all([this.getDrivingRoute(e,l),this.getWalkingRoute(e,l),this.getRidingRoute(e,l),this.getTransitRoute(e,l,u)]);case 3:return i=s.sent,s.abrupt("return",i);case 5:case"end":return s.stop()}},r,this)}));function n(r,e){return t.apply(this,arguments)}return n}()},{key:"calculateCompleteRouteWithModes",value:function(){var t=k()(b()().mark(function r(e){var l,u,i,a,c,s,d,h,g;return b()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(e.length<2)){m.next=2;break}return m.abrupt("return",{segments:[],totalDistance:0,totalDuration:0,mode:"mixed",success:!1});case 2:l=[],u=0,i=0,a=0;case 6:if(!(a<e.length-1)){m.next=27;break}return c=e[a],s=e[a+1],d=c.mode||"driving",m.prev=10,console.log("\u8BA1\u7B97\u8DEF\u6BB5 ".concat(a+1,":"),c.name,"\u2192",s.name,"(".concat(d,")")),m.next=14,Qe(c,s,d,"segment-".concat(a));case 14:h=m.sent,console.log("\u8DEF\u6BB5 ".concat(a+1," \u8BA1\u7B97\u7ED3\u679C:"),h),l.push(h),h.success&&(u+=h.distance,i+=h.duration),m.next=24;break;case 20:m.prev=20,m.t0=m.catch(10),console.error("\u8DEF\u6BB5 ".concat(c.name," \u2192 ").concat(s.name," \u8BA1\u7B97\u5931\u8D25:"),m.t0),l.push({id:"segment-".concat(a),startPoint:{name:c.name,position:[c.lng,c.lat]},endPoint:{name:s.name,position:[s.lng,s.lat]},distance:0,duration:0,mode:d,polyline:[],success:!1,error:"\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25"});case 24:a++,m.next=6;break;case 27:return g={segments:l,totalDistance:u,totalDuration:i,mode:"mixed",success:l.some(function(C){return C.success})},console.log("\u5B8C\u6574\u8DEF\u7EBF\u8BA1\u7B97\u7ED3\u679C:",g),m.abrupt("return",g);case 30:case"end":return m.stop()}},r,null,[[10,20]])}));function n(r){return t.apply(this,arguments)}return n}()}]),f}(),_e=p(82092),H=p.n(_e),ve=function(){function f(){q()(this,f),H()(this,"pluginsLoaded",!1),H()(this,"availablePlugins",new Set)}return _()(f,[{key:"loadPlugins",value:function(){var t=k()(b()().mark(function r(){var e=this;return b()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.pluginsLoaded){u.next=2;break}return u.abrupt("return");case 2:return u.abrupt("return",new Promise(function(i,a){if(!window.AMap){a(new Error("AMap\u672A\u52A0\u8F7D"));return}var c=["AMap.Driving","AMap.Walking","AMap.Transfer","AMap.Riding"];window.AMap.plugin(c,function(){var s={"AMap.Driving":"driving","AMap.Walking":"walking","AMap.Transfer":"transfer","AMap.Riding":"riding"};c.forEach(function(d){var h=d.replace("AMap.","");if(window.AMap[h]){var g=s[d];g&&e.availablePlugins.add(g)}}),e.pluginsLoaded=!0,console.log("\u5DF2\u52A0\u8F7D\u7684\u63D2\u4EF6:",Array.from(e.availablePlugins)),i(void 0)})}));case 3:case"end":return u.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"ensurePluginsLoaded",value:function(){var t=k()(b()().mark(function r(){return b()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.pluginsLoaded){l.next=2;break}return l.abrupt("return");case 2:return l.next=4,this.loadPlugins();case 4:case"end":return l.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"isPluginAvailable",value:function(n){return this.availablePlugins.has(n.toLowerCase())}},{key:"getAvailablePlugins",value:function(){return Array.from(this.availablePlugins)}},{key:"reset",value:function(){this.pluginsLoaded=!1,this.availablePlugins.clear()}}],[{key:"getInstance",value:function(){return f.instance||(f.instance=new f),f.instance}}]),f}();H()(ve,"instance",void 0);var U=function(){var f=k()(b()().mark(function t(){var n;return b()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ve.getInstance(),e.next=3,n.ensurePluginsLoaded();case 3:case"end":return e.stop()}},t)}));return function(){return f.apply(this,arguments)}}(),Y=function(t){var n=ve.getInstance();return n.isPluginAvailable(t)},N={driving:"\u9A7E\u8F66",walking:"\u6B65\u884C",riding:"\u9A91\u884C",transfer:"\u516C\u4EA4",mixed:"\u6DF7\u5408"},W={driving:"#1890ff",walking:"#52c41a",riding:"#faad14",transfer:"#f759ab",mixed:"#13c2c2"},ea=function(){function f(t){q()(this,f),H()(this,"map",void 0),H()(this,"currentRouteInstance",null),H()(this,"segmentInstances",[]),H()(this,"segmentOverlays",[]),this.map=t}return _()(f,[{key:"drawDrivingRoute",value:function(n,r){var e=this;return new Promise(function(l){if(!Y("driving")){l(!1);return}e.currentRouteInstance=new window.AMap.Driving({map:e.map,showTraffic:!1,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,r,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u9A7E\u8F66\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawWalkingRoute",value:function(n,r){var e=this;return new Promise(function(l){if(!Y("walking")){l(!1);return}e.currentRouteInstance=new window.AMap.Walking({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,r,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u6B65\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawRidingRoute",value:function(n,r){var e=this;return new Promise(function(l){if(!Y("riding")){l(!1);return}e.currentRouteInstance=new window.AMap.Riding({map:e.map,autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,r,function(u,i){u==="complete"&&i.routes&&i.routes.length>0?(console.log("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u9A91\u884C\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawTransitRoute",value:function(n,r){var e=this;return new Promise(function(l){if(!Y("transfer")){l(!1);return}e.currentRouteInstance=new window.AMap.Transfer({map:e.map,city:"\u676D\u5DDE",autoFitView:!0,showSteps:!0,hideMarkers:!1}),e.currentRouteInstance.search(n,r,function(u,i){u==="complete"&&i.plans&&i.plans.length>0?(console.log("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u6210\u529F"),l(!0)):(console.error("\u516C\u4EA4\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",u,i),l(!1))})})}},{key:"drawRoute",value:function(){var t=k()(b()().mark(function r(e,l,u){return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,U(),this.clearAllRoutes(),a.t0=u,a.next=a.t0==="driving"?6:a.t0==="walking"?7:a.t0==="riding"?8:a.t0==="transfer"?9:10;break;case 6:return a.abrupt("return",this.drawDrivingRoute(e,l));case 7:return a.abrupt("return",this.drawWalkingRoute(e,l));case 8:return a.abrupt("return",this.drawRidingRoute(e,l));case 9:return a.abrupt("return",this.drawTransitRoute(e,l));case 10:return a.abrupt("return",!1);case 11:a.next=17;break;case 13:return a.prev=13,a.t1=a.catch(0),console.error("\u7ED8\u5236\u8DEF\u7EBF\u5931\u8D25:",a.t1),a.abrupt("return",!1);case 17:case"end":return a.stop()}},r,this,[[0,13]])}));function n(r,e,l){return t.apply(this,arguments)}return n}()},{key:"clearAllRoutes",value:function(){var n=this;this.currentRouteInstance&&(this.currentRouteInstance.clear(),this.currentRouteInstance=null),this.segmentInstances.forEach(function(e){e&&e.clear&&e.clear()}),this.segmentInstances=[],this.segmentOverlays.forEach(function(e){e&&n.map.remove(e)}),this.segmentOverlays=[];var r=this.map.getAllOverlays("polyline");r.forEach(function(e){n.map.remove(e)})}},{key:"drawCompleteRoute",value:function(n){var r=this;if(console.log("\u5F00\u59CB\u7ED8\u5236\u5B8C\u6574\u8DEF\u7EBF:",n),this.clearAllRoutes(),!n.success||n.segments.length===0){console.log("\u6CA1\u6709\u6210\u529F\u7684\u8DEF\u7EBF\u6BB5\u53EF\u7ED8\u5236");return}var e=[];n.segments.forEach(function(l,u){if(l.success&&l.polyline&&l.polyline.length>1){console.log("\u7ED8\u5236\u8DEF\u6BB5 ".concat(u+1,":"),l.startPoint.name,"\u2192",l.endPoint.name,"polyline\u70B9\u6570:",l.polyline.length);var i=new window.AMap.Polyline({path:l.polyline,strokeColor:W[l.mode]||"#1890ff",strokeWeight:6,strokeOpacity:.8,strokeStyle:"solid",showDir:!0,extData:{segmentId:l.id,segmentIndex:u}});r.map.add(i),r.segmentOverlays.push(i),e.push(i);var a=new window.AMap.Marker({position:l.startPoint.position,content:'<div style="background: '.concat(W[l.mode],'; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">').concat(u===0?"\u8D77":u+1,"</div>"),title:l.startPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});if(r.map.add(a),r.segmentOverlays.push(a),e.push(a),u===n.segments.length-1){var c=new window.AMap.Marker({position:l.endPoint.position,content:'<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">\u7EC8</div>',title:l.endPoint.name,anchor:"center",offset:new window.AMap.Pixel(0,-15)});r.map.add(c),r.segmentOverlays.push(c),e.push(c)}if(l.polyline.length>2){var s=Math.floor(l.polyline.length/2),d=l.polyline[s],h=new window.AMap.Marker({position:d,content:'<div style="background: '.concat(W[l.mode],'; color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; border: 1px solid white; opacity: 0.9;">').concat(r.getModeIcon(l.mode),"</div>"),anchor:"center",offset:new window.AMap.Pixel(0,-10),zIndex:200});r.map.add(h),r.segmentOverlays.push(h),e.push(h)}}else console.log("\u8DF3\u8FC7\u5931\u8D25\u7684\u8DEF\u6BB5 ".concat(u+1,":"),l.error)}),e.length>0&&(console.log("\u8C03\u6574\u5730\u56FE\u89C6\u91CE\uFF0C\u8986\u76D6\u7269\u6570\u91CF:",e.length),this.map.setFitView(e,!1,[50,50,50,50])),console.log("\u5B8C\u6574\u8DEF\u7EBF\u7ED8\u5236\u5B8C\u6210\uFF0C\u603B\u8986\u76D6\u7269\u6570\u91CF:",this.segmentOverlays.length)}},{key:"getModeIcon",value:function(n){var r={driving:"\u{1F697}",walking:"\u{1F6B6}",riding:"\u{1F6B4}",transfer:"\u{1F68C}"};return r[n]||"\u25CF"}},{key:"highlightSegment",value:function(n){console.log("\u9AD8\u4EAE\u8DEF\u6BB5:",n),this.segmentOverlays.forEach(function(r){if(r.CLASS_NAME==="AMap.Polyline"||r.getPath){var e=r.getExtData();e&&e.segmentId===n?r.setOptions({strokeWeight:10,strokeOpacity:1,zIndex:100}):r.setOptions({strokeWeight:4,strokeOpacity:.4,zIndex:1})}})}},{key:"resetSegmentHighlight",value:function(){console.log("\u91CD\u7F6E\u8DEF\u6BB5\u9AD8\u4EAE"),this.segmentOverlays.forEach(function(n){(n.CLASS_NAME==="AMap.Polyline"||n.getPath)&&n.setOptions({strokeWeight:6,strokeOpacity:.8,zIndex:10})})}}]),f}(),aa=function(){function f(t){q()(this,f),H()(this,"calculationService",void 0),H()(this,"drawingService",void 0),this.calculationService=new qe,this.drawingService=new ea(t)}return _()(f,[{key:"getAllRoutes",value:function(){var t=k()(b()().mark(function r(e,l,u){return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.calculationService.getAllRoutes(e,l,u));case 1:case"end":return a.stop()}},r,this)}));function n(r,e,l){return t.apply(this,arguments)}return n}()},{key:"calculateCompleteRouteWithModes",value:function(){var t=k()(b()().mark(function r(e){return b()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.calculationService.calculateCompleteRouteWithModes(e));case 1:case"end":return u.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"drawRoute",value:function(){var t=k()(b()().mark(function r(e,l,u){return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.drawingService.drawRoute(e,l,u));case 1:case"end":return a.stop()}},r,this)}));function n(r,e,l){return t.apply(this,arguments)}return n}()},{key:"drawCompleteRoute",value:function(n){this.drawingService.drawCompleteRoute(n)}},{key:"clearAllRoutes",value:function(){this.drawingService.clearAllRoutes()}},{key:"highlightSegment",value:function(n){this.drawingService.highlightSegment(n)}},{key:"resetSegmentHighlight",value:function(){this.drawingService.resetSegmentHighlight()}}]),f}(),o=p(52676),na=function(t){var n=t.value,r=n===void 0?"":n,e=t.onChange,l=t.onPlaceSelected,u=t.placeholder,i=u===void 0?"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22":u,a=t.city,c=a===void 0?"":a,s=(0,S.useState)(r),d=A()(s,2),h=d[0],g=d[1],v=(0,S.useState)([]),m=A()(v,2),C=m[0],P=m[1],w=(0,S.useState)(null),R=A()(w,2),F=R[0],D=R[1],j=(0,S.useState)(!1),M=A()(j,2),L=M[0],z=M[1],J=(0,S.useRef)(null);console.log("AMAP_KEY:",{NODE_ENV:"production",UMI_APP_AMAP_SECRET_KEY:"3e3153b7d6dec0cb487d2afde4795453",UMI_APP_AMAP_WEB_SERVICE_KEY:"ac47d45ec5e5e8ddf58b95e9e99ede62",UMI_APP_AMAP_JS_KEY:"c235c1e78c16464f41d866fe4c811c58",PUBLIC_PATH:"/TravelPlan/"}),(0,S.useEffect)(function(){g(r)},[r]);var y=function(X,re){var G=re.place;D(G),g(G.name),e==null||e(G.name),l(G)},B=function(){D(null),g(""),e==null||e(""),l(null)},be=function(X){if(g(X),e==null||e(X),!X.trim()){P([]);return}J.current&&window.clearTimeout(J.current),z(!0),J.current=window.setTimeout(k()(b()().mark(function re(){var G,ce;return b()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,Ve(X,c);case 2:G=Z.sent,ce=G.map(function(I){return{value:I.name,label:I.name,address:I.address,place:I}}),P(ce),z(!1);case 6:case"end":return Z.stop()}},re)})),300)};return(0,o.jsx)("div",{style:{width:"100%"},children:(0,o.jsxs)(Pe.Z,{allowClear:{clearIcon:(0,o.jsx)(Oe.Z,{})},value:h,options:C,onSelect:y,onSearch:be,onClear:B,placeholder:i,notFoundContent:L?"\u641C\u7D22\u4E2D...":"\u65E0\u5339\u914D\u7ED3\u679C",style:{width:"100%"},children:[C.map(function($){return(0,o.jsx)(Pe.Z.Option,{value:$.value,"data-place":$.place,children:(0,o.jsxs)("div",{className:"search-option",children:[(0,o.jsx)("div",{style:{fontWeight:"bold"},children:$.label}),(0,o.jsx)("div",{style:{fontSize:"12px",color:"#999"},children:$.address})]})},$.value)}),F&&(0,o.jsx)(We.Z,{color:"blue",closable:!0,onClose:B,style:{marginTop:8},children:F.name})]})})},ta=na,ra=p(41448),la=[{value:"zhejiang",label:"\u6D59\u6C5F",children:[{value:"hangzhou",label:"\u676D\u5DDE"},{value:"ningbo",label:"\u5B81\u6CE2"},{value:"wenzhou",label:"\u6E29\u5DDE"},{value:"shaoxing",label:"\u7ECD\u5174"},{value:"huzhou",label:"\u6E56\u5DDE"},{value:"jiaxing",label:"\u5609\u5174"},{value:"zhoushan",label:"\u821F\u5C71"},{value:"quzhou",label:"\u8862\u5DDE"},{value:"taizhou",label:"\u53F0\u5DDE"},{value:"lishui",label:"\u4E3D\u6C34"}]},{value:"jiangsu",label:"\u6C5F\u82CF",children:[{value:"nanjing",label:"\u5357\u4EAC"},{value:"suzhou",label:"\u82CF\u5DDE"},{value:"wuxi",label:"\u65E0\u9521"},{value:"changzhou",label:"\u5E38\u5DDE"},{value:"zhenjiang",label:"\u9547\u6C5F"},{value:"nantong",label:"\u5357\u901A"},{value:"yangzhou",label:"\u626C\u5DDE"},{value:"taizhou",label:"\u6CF0\u5DDE"},{value:"xuzhou",label:"\u5F90\u5DDE"},{value:"huai an",label:"\u6DEE\u5B89"},{value:"yancheng",label:"\u76D0\u57CE"},{value:"lianyungang",label:"\u8FDE\u4E91\u6E2F"},{value:"suqian",label:"\u5BBF\u8FC1"}]},{value:"beijing",label:"\u5317\u4EAC",children:[{value:"beijing",label:"\u5317\u4EAC"}]},{value:"shanghai",label:"\u4E0A\u6D77",children:[{value:"shanghai",label:"\u4E0A\u6D77"}]},{value:"guangdong",label:"\u5E7F\u4E1C",children:[{value:"guangzhou",label:"\u5E7F\u5DDE"},{value:"shenzhen",label:"\u6DF1\u5733"},{value:"zhuhai",label:"\u73E0\u6D77"},{value:"shantou",label:"\u6C55\u5934"},{value:"foshan",label:"\u4F5B\u5C71"},{value:"dongguan",label:"\u4E1C\u839E"},{value:"zhongshan",label:"\u4E2D\u5C71"},{value:"jiangmen",label:"\u6C5F\u95E8"},{value:"huizhou",label:"\u60E0\u5DDE"},{value:"maoming",label:"\u8302\u540D"},{value:"zhanjiang",label:"\u6E5B\u6C5F"},{value:"meizhou",label:"\u6885\u5DDE"},{value:"qingyuan",label:"\u6E05\u8FDC"},{value:"shaoguan",label:"\u97F6\u5173"},{value:"yunfu",label:"\u4E91\u6D6E"},{value:"chaozhou",label:"\u6F6E\u5DDE"},{value:"jieyang",label:"\u63ED\u9633"},{value:"heyuan",label:"\u6CB3\u6E90"}]},{value:"sichuan",label:"\u56DB\u5DDD",children:[{value:"chengdu",label:"\u6210\u90FD"},{value:"mianyang",label:"\u7EF5\u9633"},{value:"deyang",label:"\u5FB7\u9633"},{value:"nanchong",label:"\u5357\u5145"},{value:"ziyang",label:"\u8D44\u9633"},{value:"zigong",label:"\u81EA\u8D21"},{value:"panzhihua",label:"\u6500\u679D\u82B1"},{value:"luzhou",label:"\u6CF8\u5DDE"},{value:"dazhou",label:"\u8FBE\u5DDE"},{value:"guangyuan",label:"\u5E7F\u5143"},{value:"yibin",label:"\u5B9C\u5BBE"},{value:"neijiang",label:"\u5185\u6C5F"},{value:"leshan",label:"\u4E50\u5C71"},{value:"bazhong",label:"\u5DF4\u4E2D"},{value:"yaan",label:"\u96C5\u5B89"},{value:"ganzi",label:"\u7518\u5B5C"},{value:"liangshan",label:"\u51C9\u5C71"},{value:"abazhou",label:"\u963F\u575D"}]},{value:"yunnan",label:"\u4E91\u5357",children:[{value:"kunming",label:"\u6606\u660E"},{value:"dali",label:"\u5927\u7406"},{value:"lijiang",label:"\u4E3D\u6C5F"},{value:"xishuangbanna",label:"\u897F\u53CC\u7248\u7EB3"},{value:"baoshan",label:"\u4FDD\u5C71"},{value:"chuxiong",label:"\u695A\u96C4"},{value:"dehong",label:"\u5FB7\u5B8F"},{value:"nujiang",label:"\u6012\u6C5F"},{value:"diqing",label:"\u8FEA\u5E86"},{value:"zhaotong",label:"\u662D\u901A"},{value:"qujing",label:"\u66F2\u9756"},{value:"yuxi",label:"\u7389\u6EAA"},{value:"honghe",label:"\u7EA2\u6CB3"},{value:"wenchuan",label:"\u6587\u5C71"},{value:"puer",label:"\u666E\u6D31"},{value:"linfen",label:"\u4E34\u6CA7"}]},{value:"hainan",label:"\u6D77\u5357",children:[{value:"haikou",label:"\u6D77\u53E3"},{value:"sanya",label:"\u4E09\u4E9A"},{value:"danzhou",label:"\u510B\u5DDE"},{value:"wuzhishan",label:"\u4E94\u6307\u5C71"},{value:"qionghai",label:"\u743C\u6D77"},{value:"wanning",label:"\u4E07\u5B81"},{value:"wenchang",label:"\u6587\u660C"},{value:"dongfang",label:"\u4E1C\u65B9"}]},{value:"hunan",label:"\u6E56\u5357",children:[{value:"changsha",label:"\u957F\u6C99"},{value:"zhuzhou",label:"\u682A\u6D32"},{value:"xiangtan",label:"\u6E58\u6F6D"},{value:"hengyang",label:"\u8861\u9633"},{value:"shaoyang",label:"\u90B5\u9633"},{value:"yueyang",label:"\u5CB3\u9633"},{value:"changde",label:"\u5E38\u5FB7"},{value:"zhangjiajie",label:"\u5F20\u5BB6\u754C"},{value:"yiyang",label:"\u76CA\u9633"},{value:"chenzhou",label:"\u90F4\u5DDE"},{value:"yongzhou",label:"\u6C38\u5DDE"},{value:"huaihua",label:"\u6000\u5316"},{value:"loudi",label:"\u5A04\u5E95"},{value:"xiangxi",label:"\u6E58\u897F"}]},{value:"hubei",label:"\u6E56\u5317",children:[{value:"wuhan",label:"\u6B66\u6C49"},{value:"huangshi",label:"\u9EC4\u77F3"},{value:"shiyan",label:"\u5341\u5830"},{value:"yichang",label:"\u5B9C\u660C"},{value:"xiangyang",label:"\u8944\u9633"},{value:"ezhou",label:"\u9102\u5DDE"},{value:"jingmen",label:"\u8346\u95E8"},{value:"xiaogan",label:"\u5B5D\u611F"},{value:"jingzhou",label:"\u8346\u5DDE"},{value:"huanggang",label:"\u9EC4\u5188"},{value:"xianning",label:"\u54B8\u5B81"},{value:"suizhou",label:"\u968F\u5DDE"},{value:"enshi",label:"\u6069\u65BD"}]},{value:"shandong",label:"\u5C71\u4E1C",children:[{value:"jinan",label:"\u6D4E\u5357"},{value:"qingdao",label:"\u9752\u5C9B"},{value:"zibo",label:"\u6DC4\u535A"},{value:"zaozhuang",label:"\u67A3\u5E84"},{value:"dongying",label:"\u4E1C\u8425"},{value:"yantai",label:"\u70DF\u53F0"},{value:"weifang",label:"\u6F4D\u574A"},{value:"jining",label:"\u6D4E\u5B81"},{value:"taian",label:"\u6CF0\u5B89"},{value:"weihai",label:"\u5A01\u6D77"},{value:"rizhao",label:"\u65E5\u7167"},{value:"laiwu",label:"\u83B1\u829C"},{value:"linyi",label:"\u4E34\u6C82"},{value:"dezhou",label:"\u5FB7\u5DDE"},{value:"liaocheng",label:"\u804A\u57CE"},{value:"binzhou",label:"\u6EE8\u5DDE"},{value:"heze",label:"\u83CF\u6CFD"}]}],Re={\u676D\u5DDE:[120.153576,30.287459],\u5B81\u6CE2:[121.549792,29.870244],\u6E29\u5DDE:[120.699374,27.994207],\u7ECD\u5174:[120.580045,30.023551],\u6E56\u5DDE:[120.097547,30.872655],\u5609\u5174:[120.756608,30.750483],\u821F\u5C71:[122.207217,30.025551],\u8862\u5DDE:[118.876444,28.946588],\u53F0\u5DDE:[121.420711,28.656387],\u4E3D\u6C34:[119.921033,28.451379],\u5357\u4EAC:[118.767413,32.041544],\u82CF\u5DDE:[120.585316,31.29888],\u65E0\u9521:[120.299393,31.573885],\u5E38\u5DDE:[119.955045,31.795574],\u9547\u6C5F:[119.452783,32.204402],\u5357\u901A:[120.864688,32.016175],\u626C\u5DDE:[119.421009,32.393152],\u6CF0\u5DDE:[119.915173,32.484882],\u5F90\u5DDE:[117.184811,34.261792],\u6DEE\u5B89:[119.015305,33.581511],\u76D0\u57CE:[120.139998,33.377631],\u8FDE\u4E91\u6E2F:[119.221617,34.576476],\u5BBF\u8FC1:[118.276837,33.939688],\u5317\u4EAC:[116.397428,39.90923],\u4E0A\u6D77:[121.473701,31.230416],\u5E7F\u5DDE:[113.280637,23.125178],\u6DF1\u5733:[114.085947,22.547],\u73E0\u6D77:[113.576726,22.270703],\u6C55\u5934:[116.683828,23.355818],\u4F5B\u5C71:[113.122717,23.028595],\u4E1C\u839E:[113.75179,23.020748],\u4E2D\u5C71:[113.382333,22.521112],\u6C5F\u95E8:[113.094175,22.589016],\u60E0\u5DDE:[114.412605,23.07942],\u8302\u540D:[110.919231,21.659752],\u6E5B\u6C5F:[110.359377,21.270679],\u6885\u5DDE:[116.119268,24.299056],\u6E05\u8FDC:[113.04789,24.325153],\u97F6\u5173:[113.598407,24.809434],\u4E91\u6D6E:[112.044382,22.927393],\u6F6E\u5DDE:[116.632303,23.661951],\u63ED\u9633:[116.355529,23.543716],\u6CB3\u6E90:[114.697808,23.746275],\u6210\u90FD:[104.065735,30.659462],\u7EF5\u9633:[104.741657,31.455295],\u5FB7\u9633:[104.394943,31.128142],\u5357\u5145:[106.082976,30.795771],\u8D44\u9633:[104.641797,30.123222],\u81EA\u8D21:[104.778442,29.359089],\u6500\u679D\u82B1:[101.718636,26.582347],\u6CF8\u5DDE:[105.443737,28.878649],\u8FBE\u5DDE:[107.502627,31.209818],\u5E7F\u5143:[105.828737,32.433767],\u5B9C\u5BBE:[104.569279,28.763023],\u5185\u6C5F:[105.052014,29.582056],\u4E50\u5C71:[103.761017,29.563017],\u5DF4\u4E2D:[106.753537,31.857465],\u96C5\u5B89:[103.001858,29.98289],\u7518\u5B5C:[100.233394,30.050591],\u51C9\u5C71:[102.266365,27.902191],\u963F\u575D:[102.22435,31.898394],\u6606\u660E:[102.832892,24.880095],\u5927\u7406:[100.228445,25.616545],\u4E3D\u6C5F:[100.226146,26.864494],\u897F\u53CC\u7248\u7EB3:[100.799647,22.003307],\u4FDD\u5C71:[99.166606,25.111631],\u695A\u96C4:[101.543757,25.036331],\u5FB7\u5B8F:[98.577494,24.439671],\u6012\u6C5F:[98.854247,26.648914],\u8FEA\u5E86:[99.708255,27.825172],\u662D\u901A:[103.717158,27.318388],\u66F2\u9756:[103.797387,25.496423],\u7389\u6EAA:[102.539095,24.350431],\u7EA2\u6CB3:[102.818658,23.369552],\u6587\u5C71:[104.24427,23.369998],\u666E\u6D31:[100.973858,22.775479],\u4E34\u6CA7:[100.089039,23.885899],\u6D77\u53E3:[110.33119,20.031971],\u4E09\u4E9A:[109.731928,18.249575],\u510B\u5DDE:[109.340454,19.517126],\u4E94\u6307\u5C71:[109.517624,18.773724],\u743C\u6D77:[110.466989,19.256953],\u4E07\u5B81:[110.389319,18.798578],\u6587\u660C:[110.77781,19.810778],\u4E1C\u65B9:[108.653813,19.09708],\u957F\u6C99:[112.973895,28.196059],\u682A\u6D32:[113.132898,27.831873],\u6E58\u6F6D:[112.944048,27.829724],\u8861\u9633:[112.580162,26.898242],\u90B5\u9633:[111.467124,27.237843],\u5CB3\u9633:[113.089684,29.363969],\u5E38\u5FB7:[111.691585,29.030896],\u5F20\u5BB6\u754C:[110.479298,29.127356],\u76CA\u9633:[112.339719,28.567383],\u90F4\u5DDE:[113.032259,25.774173],\u6C38\u5DDE:[111.608017,26.430765],\u6000\u5316:[109.959052,27.537304],\u5A04\u5E95:[112.003673,27.728183],\u6E58\u897F:[109.739779,28.312699],\u6B66\u6C49:[114.298572,30.584355],\u9EC4\u77F3:[115.096794,30.185835],\u5341\u5830:[110.788111,32.646473],\u5B9C\u660C:[111.290804,30.693176],\u8944\u9633:[112.14414,32.042451],\u9102\u5DDE:[114.888993,30.390928],\u8346\u95E8:[112.203958,31.035758],\u5B5D\u611F:[113.917078,30.916557],\u8346\u5DDE:[112.239204,30.329688],\u9EC4\u5188:[114.879454,30.436752],\u54B8\u5B81:[113.868505,29.839171],\u968F\u5DDE:[113.364104,31.708469],\u6069\u65BD:[109.489134,30.274575],\u6D4E\u5357:[117.020048,36.667524],\u9752\u5C9B:[120.382602,36.064357],\u6DC4\u535A:[118.047644,36.788883],\u67A3\u5E84:[117.323134,34.818489],\u4E1C\u8425:[118.492963,37.461484],\u70DF\u53F0:[121.391446,37.539289],\u6F4D\u574A:[119.160833,36.649827],\u6D4E\u5B81:[116.587269,35.389439],\u6CF0\u5B89:[117.087156,36.184069],\u5A01\u6D77:[122.121559,37.51284],\u65E5\u7167:[119.477875,35.417796],\u83B1\u829C:[117.659763,36.211577],\u4E34\u6C82:[118.356384,35.065087],\u5FB7\u5DDE:[116.357594,37.455084],\u804A\u57CE:[115.975435,36.456405],\u6EE8\u5DDE:[117.971797,37.38421],\u83CF\u6CFD:[115.469381,35.246531],\u5168\u56FD:[104.195397,35.86166]},ia=function(t){var n=t.value,r=n===void 0?"":n,e=t.onChange;return(0,o.jsx)(ra.Z,{defaultValue:["\u6D59\u6C5F","\u676D\u5DDE"],options:la,onChange:e})},ua=ia,sa=function(t){var n=t.handleAddNewItem,r=t.isSubmitted,e=t.isModalOpen,l=t.handleOk,u=t.handleCancel,i=t.setCity,a=t.setSelectedPlace,c=t.selectedPlace,s=t.city,d=t.handleEdit,h=t.handleSubmit;return(0,o.jsxs)(O.Z,{justify:"space-between",style:{padding:"16px 0",flexShrink:0},children:[(0,o.jsx)(O.Z,{gap:"middle",children:(0,o.jsx)(V.ZP,{type:"primary",onClick:n,disabled:r,children:"\u65B0\u589E"})}),(0,o.jsxs)(he.Z,{title:"\u65B0\u589E",open:e,onOk:l,onCancel:u,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",zIndex:1e4,getContainer:function(){return document.body},children:[(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u57CE\u5E02\u8303\u56F4"}),(0,o.jsx)(ua,{onChange:function(v,m){if(m&&m.length>0){var C=m[m.length-1].label;i(C)}else i("\u676D\u5DDE")}})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{marginBottom:8,fontWeight:"bold"},children:"\u9009\u62E9\u666F\u70B9"}),(0,o.jsx)(ta,{onPlaceSelected:a,placeholder:"\u8F93\u5165\u666F\u70B9\u540D\u79F0\u641C\u7D22",city:s==="\u676D\u5DDE"?"":s},s),c&&(0,o.jsxs)("div",{style:{marginTop:8,padding:8,background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4},children:[(0,o.jsx)("div",{style:{fontWeight:"bold"},children:c.name}),(0,o.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:c.address})]})]})]}),(0,o.jsx)(O.Z,{gap:"middle",style:{marginRight:20},children:r?(0,o.jsx)(V.ZP,{onClick:d,children:"\u8FD4\u56DE\u7F16\u8F91"}):(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(V.ZP,{type:"primary",onClick:h,children:"\u63D0\u4EA4\u884C\u7A0B"})})})]})},oa=sa,ca=p(67825),da=p.n(ca),ha=p(49319),va=p(78434),ga=["data-row-key"],fa=function(t){var n=t["data-row-key"],r=da()(t,ga),e=(0,ie.nB)({id:n}),l=e.attributes,u=e.listeners,i=e.setNodeRef,a=e.transform,c=e.transition,s=e.isDragging,d=E()(E()({},r.style),{},{transform:va.ux.Translate.toString(a),transition:c,cursor:"move"},s?{position:"relative",zIndex:999,background:"#fafafa"}:{});return(0,o.jsx)("tr",E()(E()(E()(E()({},r),{},{ref:i,style:d},l),u),{},{"data-row-key":n}))},pa=function(t){var n=t.onDragEnd,r=t.sensors,e=t.dataSource,l=t.columns,u=t.isSubmitted,i=t.rowSelection;return(0,o.jsx)(ue.LB,{sensors:r,onDragEnd:n,children:(0,o.jsx)(ie.Fo,{items:e.map(function(a){return a.id}),strategy:ie.qw,children:(0,o.jsx)(ha.Z,{components:{body:{row:fa}},rowKey:"id",columns:l,dataSource:e,pagination:!1,scroll:{y:"calc(100vh - 260px)"},rowSelection:u?void 0:i,style:{background:"#fff",flex:1,position:"relative",zIndex:1},locale:{emptyText:(0,o.jsxs)("div",{style:{padding:"60px 20px",textAlign:"center",color:"#999"},children:[(0,o.jsx)("div",{style:{fontSize:"16px",marginBottom:"8px"},children:"\u6682\u65E0\u666F\u70B9\u6570\u636E"}),(0,o.jsx)("div",{style:{fontSize:"14px"},children:'\u70B9\u51FB\u4E0B\u65B9"\u65B0\u589E\u666F\u70B9"\u6309\u94AE\u6DFB\u52A0\u60A8\u60F3\u53BB\u7684\u5730\u65B9'})]})}})})})},ma=pa,ee=p(11778),ae={orderNumber:"orderNumber___UuufS",startPoint:"startPoint___tPvL9",endPoint:"endPoint___GqI3G",location:"location___s6Y6N",selectionStatus:"selectionStatus___weOuT"},ya=function(t,n,r,e,l,u){return[{title:r?"\u884C\u7A0B\u987A\u5E8F":"\u666F\u70B9",dataIndex:"name",width:200,render:function(a,c,s){return(0,o.jsxs)(O.Z,{gap:"middle",align:"center",children:[r&&c.checked&&(0,o.jsx)("div",{className:ae.orderNumber,children:t.filter(function(d){return d.checked}).findIndex(function(d){return d.id===c.id})+1}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{fontWeight:c.isStart||c.isEnd?"bold":"normal"},children:[c.isStart&&(0,o.jsx)("span",{className:ae.startPoint,children:"[\u8D77\u70B9]"}),c.isEnd&&(0,o.jsx)("span",{className:ae.endPoint,children:"[\u7EC8\u70B9]"}),a]}),(0,o.jsx)("div",{className:ae.location,children:c.location})]})]})}},{title:"\u51FA\u884C\u65B9\u5F0F",dataIndex:"mode",width:100,render:function(a,c){return(0,o.jsxs)(ee.default,{value:a,style:{width:70},disabled:r,onChange:function(d){n(function(h){return h.map(function(g){return g.id===c.id?E()(E()({},g),{},{mode:d}):g})})},children:[(0,o.jsx)(ee.default.Option,{value:"driving",children:"\u9A7E\u8F66"}),(0,o.jsx)(ee.default.Option,{value:"walking",children:"\u6B65\u884C"}),(0,o.jsx)(ee.default.Option,{value:"riding",children:"\u9A91\u884C"}),(0,o.jsx)(ee.default.Option,{value:"transfer",children:"\u516C\u4EA4"})]})}},{title:"\u64CD\u4F5C",key:"action",width:150,render:function(a,c){return(0,o.jsxs)(O.Z,{gap:4,wrap:!0,children:[!r&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(V.ZP,{size:"small",type:c.isStart?"primary":"default",onClick:function(){return l(c.id)},children:c.isStart?"\u8D77\u70B9":"\u8BBE\u4E3A\u8D77\u70B9"}),(0,o.jsx)(V.ZP,{size:"small",type:c.isEnd?"primary":"default",onClick:function(){return u(c.id)},children:c.isEnd?"\u7EC8\u70B9":"\u8BBE\u4E3A\u7EC8\u70B9"}),(0,o.jsx)(V.ZP,{size:"small",variant:"link",color:"danger",onClick:function(){return e(c.id)},children:"\u5220\u9664"})]}),r&&(0,o.jsx)("div",{className:ae.selectionStatus,children:c.checked?"\u5DF2\u9009\u62E9":"\u672A\u9009\u62E9"})]})}}]},ba=p(73648),Sa=function(t,n,r){return{type:"checkbox",selectedRowKeys:t.filter(function(e){return e.checked}).map(function(e){return e.id}),onChange:function(l){n(t.map(function(u){return E()(E()({},u),{},{checked:l.includes(u.id)})}))},onSelect:function(l,u){n(t.map(function(i){return i.id===l.id?E()(E()({},i),{},{checked:u}):i}))},onSelectAll:function(l){n(t.map(function(u){return E()(E()({},u),{},{checked:l})}))},getCheckboxProps:function(l){return{disabled:r,name:l.name}},columnTitle:r?"\u9009\u62E9\u72B6\u6001":(0,o.jsx)(ba.Z,{indeterminate:t.some(function(e){return e.checked})&&!t.every(function(e){return e.checked}),checked:t.length>0&&t.every(function(e){return e.checked}),disabled:r||t.length===0,onChange:function(l){var u=l.target.checked;n(t.map(function(i){return E()(E()({},i),{},{checked:u})}))}}),columnWidth:60}},wa=function(t){var n=t.items,r=t.setItems,e=t.isSubmitted,l=e===void 0?!1:e,u=t.onSubmit,i=t.onEdit,a=(0,S.useState)(n),c=A()(a,2),s=c[0],d=c[1],h=(0,S.useState)(!1),g=A()(h,2),v=g[0],m=g[1],C=(0,S.useState)(null),P=A()(C,2),w=P[0],R=P[1],F=(0,S.useState)("\u676D\u5DDE"),D=A()(F,2),j=D[0],M=D[1],L=Sa(n,r,l);S.useEffect(function(){d(n)},[n]);var z=(0,ue.Dy)((0,ue.VT)(ue.we,{activationConstraint:{distance:5}})),J=function(I){var K=I.active,T=I.over;if(K.id!==(T==null?void 0:T.id)){var wn=s.findIndex(function(Se){return Se.id===K.id}),Cn=s.findIndex(function(Se){return Se.id===T.id}),je=(0,ie.Rp)(s,wn,Cn);d(je),r(je)}},y=(0,S.useCallback)(function(){var Z=n.filter(function(I){return I.checked});if(Z.length<2){he.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u81F3\u5C11\u9009\u62E92\u4E2A\u666F\u70B9\u624D\u80FD\u63D0\u4EA4\u884C\u7A0B"});return}u==null||u()},[n,u]),B=function(){i==null||i()},be=function(I){r(function(K){return K.map(function(T){return E()(E()({},T),{},{isStart:T.id===I,isEnd:T.isEnd&&T.id!==I})})})},$=function(I){r(function(K){return K.map(function(T){return E()(E()({},T),{},{isEnd:T.id===I,isStart:T.isStart&&T.id!==I})})})},X=function(I){r(function(K){return K.filter(function(T){return T.id!==I})})},re=(0,S.useCallback)(function(){R(null),m(!0),M("\u676D\u5DDE")},[]),G=function(){if(!w){he.Z.warning({title:"\u63D0\u793A",content:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u666F\u70B9"});return}var I={id:"pois-".concat(Date.now()),name:w.name,location:w.address,region:w.cityname||j,lat:w==null?void 0:w.location.lat,lng:w==null?void 0:w.location.lng,isStart:!1,isEnd:!1,mode:"driving",checked:!1};r(function(K){return[].concat(de()(K),[I])}),m(!1),R(null)},ce=function(){m(!1),R(null)},Fe=ya(n,r,l,X,be,$);return(0,o.jsxs)(O.Z,{vertical:!0,style:{height:"100%"},children:[(0,o.jsx)(ma,{onDragEnd:J,sensors:z,dataSource:s,columns:Fe,isSubmitted:l,rowSelection:l?void 0:L}),(0,o.jsx)(oa,{handleAddNewItem:re,isModalOpen:v,isSubmitted:l,handleOk:G,handleCancel:ce,setCity:M,setSelectedPlace:R,selectedPlace:w,city:j,handleSubmit:y,handleEdit:B})]})},Ca=wa,ka={mapContainer:"mapContainer___vtLAG"},Pa=function(t){var n=t.mapContainerRef;return(0,o.jsx)("div",{ref:n,className:ka.mapContainer})},Ra=Pa,ge=p(87263),se=p(62826),Aa=p(87056),xa=p(86422),Ae=p(8520),xe=function(t,n,r){if(!r||!n)return"";var e=t.filter(function(u){return u.checked}),l=`\u65C5\u884C\u884C\u7A0B\u8BA1\u5212
`;return l+="\u751F\u6210\u65F6\u95F4: ".concat(new Date().toLocaleString(),`
`),l+=`=====================================

`,l+=`\u884C\u7A0B\u6982\u89C8:
`,l+="\u666F\u70B9\u6570\u91CF: ".concat(e.length,`\u4E2A
`),l+="\u8DEF\u6BB5\u6570\u91CF: ".concat(n.segments.length,`\u6BB5
`),l+="\u603B\u8DDD\u79BB: ".concat((n.totalDistance/1e3).toFixed(1),`km
`),l+="\u603B\u65F6\u95F4: ".concat(Math.ceil(n.totalDuration/60),`\u5206\u949F
`),l+="\u6210\u529F\u8DEF\u6BB5: ".concat(n.segments.filter(function(u){return u.success}).length,"/").concat(n.segments.length,`\u6BB5

`),l+=`\u666F\u70B9\u5217\u8868:
`,e.forEach(function(u,i){l+="".concat(i+1,". ").concat(u.name,`
`),l+="   \u4F4D\u7F6E: ".concat(u.location,`
`),l+="   \u5750\u6807: ".concat(u.lat,", ").concat(u.lng,`
`),l+="   \u51FA\u884C\u65B9\u5F0F: ".concat(N[u.mode],`

`)}),l+=`\u8DEF\u7EBF\u8BE6\u60C5:
`,n.segments.forEach(function(u,i){l+="\u8DEF\u6BB5 ".concat(i+1,": ").concat(u.startPoint.name," \u2192 ").concat(u.endPoint.name,`
`),u.success?(l+="   \u8DDD\u79BB: ".concat((u.distance/1e3).toFixed(1),`km
`),l+="   \u65F6\u95F4: ".concat(Math.ceil(u.duration/60),`\u5206\u949F
`),l+="   \u65B9\u5F0F: ".concat(N[u.mode],`
`)):l+="   \u72B6\u6001: \u8BA1\u7B97\u5931\u8D25 - ".concat(u.error,`
`),l+=`
`}),l},Ea=function(t,n,r){try{var e=xe(t,n,r),l=new Blob([e],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(l),i=document.createElement("a");i.href=u,i.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u),x.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6")}catch(a){console.error("\u5BFC\u51FA\u6587\u672C\u6587\u4EF6\u5931\u8D25:",a),x.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},Da=function(t,n){try{var r=t.filter(function(a){return a.checked}),e={metadata:{title:"\u65C5\u884C\u884C\u7A0B\u8BA1\u5212",exportTime:new Date().toISOString(),version:"1.0"},summary:{totalSpots:r.length,totalSegments:(n==null?void 0:n.segments.length)||0,totalDistance:(n==null?void 0:n.totalDistance)||0,totalDuration:(n==null?void 0:n.totalDuration)||0,successSegments:(n==null?void 0:n.segments.filter(function(a){return a.success}).length)||0},spots:r.map(function(a,c){return{order:c+1,id:a.id,name:a.name,location:a.location,region:a.region,coordinates:{latitude:a.lat,longitude:a.lng},transportMode:a.mode,transportModeName:N[a.mode]}}),routes:(n==null?void 0:n.segments.map(function(a,c){var s;return{segmentId:a.id,order:c+1,from:{name:a.startPoint.name,coordinates:a.startPoint.position},to:{name:a.endPoint.name,coordinates:a.endPoint.position},distance:a.distance,duration:a.duration,mode:a.mode,modeName:N[a.mode],success:a.success,error:a.error,polylinePoints:((s=a.polyline)===null||s===void 0?void 0:s.length)||0}}))||[]},l=new Blob([JSON.stringify(e,null,2)],{type:"application/json;charset=utf-8"}),u=URL.createObjectURL(l),i=document.createElement("a");i.href=u,i.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u),x.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6")}catch(a){console.error("\u5BFC\u51FAJSON\u6587\u4EF6\u5931\u8D25:",a),x.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},Ma=function(t,n){try{var r=t.filter(function(a){return a.checked}),e="\uFEFF";e+=`\u5E8F\u53F7,\u666F\u70B9\u540D\u79F0,\u4F4D\u7F6E,\u5730\u533A,\u7EAC\u5EA6,\u7ECF\u5EA6,\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0
`,r.forEach(function(a,c){e+="".concat(c+1,',"').concat(a.name,'","').concat(a.location,'","').concat(a.region,'",').concat(a.lat,",").concat(a.lng,',"').concat(a.mode,'","').concat(N[a.mode],`"
`)}),n&&n.segments.length>0&&(e+=`
\u8DEF\u6BB5\u5E8F\u53F7,\u8D77\u70B9,\u7EC8\u70B9,\u8DDD\u79BB(\u7C73),\u65F6\u95F4(\u79D2),\u51FA\u884C\u65B9\u5F0F,\u51FA\u884C\u65B9\u5F0F\u540D\u79F0,\u72B6\u6001,\u9519\u8BEF\u4FE1\u606F
`,n.segments.forEach(function(a,c){e+="".concat(c+1,',"').concat(a.startPoint.name,'","').concat(a.endPoint.name,'",').concat(a.distance,",").concat(a.duration,',"').concat(a.mode,'","').concat(N[a.mode],'","').concat(a.success?"\u6210\u529F":"\u5931\u8D25",'","').concat(a.error||"",`"
`)}));var l=new Blob([e],{type:"text/csv;charset=utf-8"}),u=URL.createObjectURL(l),i=document.createElement("a");i.href=u,i.download="\u65C5\u884C\u884C\u7A0B\u8BA1\u5212_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u),x.ZP.success("\u884C\u7A0B\u5DF2\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6")}catch(a){console.error("\u5BFC\u51FACSV\u6587\u4EF6\u5931\u8D25:",a),x.ZP.error("\u5BFC\u51FA\u5931\u8D25")}},Ba=function(t){var n=S.useRef(null),r=function(){var u;(u=n.current)===null||u===void 0||u.click()},e=function(u){var i,a=(i=u.target.files)===null||i===void 0?void 0:i[0];if(a){var c=new FileReader;c.onload=function(s){try{var d,h=JSON.parse((d=s.target)===null||d===void 0?void 0:d.result);if(h.spots&&Array.isArray(h.spots)){var g=h.spots.map(function(v,m){var C,P;return{id:"imported-".concat(Date.now(),"-").concat(m),name:v.name,location:v.location||v.name,region:v.region||"\u672A\u77E5",lat:((C=v.coordinates)===null||C===void 0?void 0:C.latitude)||v.lat,lng:((P=v.coordinates)===null||P===void 0?void 0:P.longitude)||v.lng,isStart:m===0,isEnd:m===h.spots.length-1,mode:v.transportMode||v.mode||"driving",checked:!0}});t?(t(g),x.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(g.length," \u4E2A\u666F\u70B9"))):x.ZP.error("\u5BFC\u5165\u529F\u80FD\u4E0D\u53EF\u7528")}else x.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u9009\u62E9\u6B63\u786E\u7684JSON\u6587\u4EF6")}catch(v){console.error("\u5BFC\u5165\u6587\u4EF6\u89E3\u6790\u5931\u8D25:",v),x.ZP.error("\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u68C0\u67E5JSON\u683C\u5F0F")}},c.readAsText(a)}};return{fileInputRef:n,handleImport:r,handleChange:e}},Fa=function(t){var n=t.planItems,r=t.completeRoute,e=t.isSubmitted,l=t.onImportData,u=Ba(l),i=u.handleImport,a=u.fileInputRef,c=u.handleChange,s=function(){var v=k()(b()().mark(function m(){var C;return b()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,C=xe(n,r,e),w.next=4,navigator.clipboard.writeText(C);case 4:x.ZP.success("\u884C\u7A0B\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"),w.next=10;break;case 7:w.prev=7,w.t0=w.catch(0),x.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236");case 10:case"end":return w.stop()}},m,null,[[0,7]])}));return function(){return v.apply(this,arguments)}}(),d=function(){try{var m=n.filter(function(R){return R.checked}),C={spots:m.map(function(R){return{name:R.name,lat:R.lat,lng:R.lng,mode:R.mode}})},P=encodeURIComponent(JSON.stringify(C)),w="".concat(window.location.origin).concat(window.location.pathname,"?share=").concat(P);navigator.clipboard.writeText(w),x.ZP.success("\u5206\u4EAB\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch(R){x.ZP.error("\u751F\u6210\u5206\u4EAB\u94FE\u63A5\u5931\u8D25")}},h=function(m){switch(m.key){case"import":i();break;case"txt":Ea(n,r,e);break;case"json":Da(n,r);break;case"csv":Ma(n,r);break;case"copy":s();break;case"share":d();break;default:break}},g=[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,o.jsx)(ge.Z,{})},{key:"txt",label:"\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6",icon:(0,o.jsx)(se.Z,{})},{key:"json",label:"\u5BFC\u51FA\u4E3AJSON\u6587\u4EF6",icon:(0,o.jsx)(se.Z,{})},{key:"csv",label:"\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6",icon:(0,o.jsx)(Aa.Z,{})},{key:"copy",label:"\u590D\u5236\u5230\u526A\u8D34\u677F",icon:(0,o.jsx)(se.Z,{})},{key:"share",label:"\u751F\u6210\u5206\u4EAB\u94FE\u63A5",icon:(0,o.jsx)(se.Z,{})}];return!e||!r||r.segments.length===0?(0,o.jsx)(Ae.Z,{menu:{items:[{key:"import",label:"\u4ECE\u6587\u4EF6\u5BFC\u5165",icon:(0,o.jsx)(ge.Z,{})}],onClick:h},placement:"bottomRight",trigger:["click"],children:(0,o.jsx)(V.ZP,{type:"primary",size:"small",icon:(0,o.jsx)(ge.Z,{}),children:"\u5BFC\u5165"})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"file",accept:".json",style:{display:"none"},ref:a,onChange:c}),(0,o.jsx)(Ae.Z,{menu:{items:g,onClick:h},placement:"bottomRight",trigger:["click"],children:(0,o.jsx)(V.ZP,{type:"primary",size:"small",icon:(0,o.jsx)(xa.Z,{}),children:"\u5BFC\u51FA"})})]})},ja=Fa,ne={mapHeader:"mapHeader___ZfXdw",headerTitle:"headerTitle___iBoRP",selectedMode:"selectedMode___VlGSk",routeInfo:"routeInfo___UvkLb",routeDetails:"routeDetails___IVH1j"},Ia=function(t){var n=t.planItems,r=t.routes,e=t.completeRoute,l=t.isSubmitted,u=t.selectedMode,i=t.routeDrawing,a=t.loading,c=t.mapLoading,s=t.onImportData;return(0,o.jsx)("div",{className:ne.mapHeader,children:(0,o.jsxs)("div",{className:ne.headerTitle,children:[(0,o.jsxs)("div",{children:[c?"\u5730\u56FE\u52A0\u8F7D\u4E2D...":a?l?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u8DEF\u7EBF\u4E2D...":i?"\u6B63\u5728\u7ED8\u5236".concat(N[u],"\u8DEF\u7EBF..."):l?e&&e.success?"\u5B8C\u6574\u884C\u7A0B\u8DEF\u7EBF (".concat(e.segments.filter(function(d){return d.success}).length,"/").concat(e.segments.length," \u6BB5\u6210\u529F)"):"\u5B8C\u6574\u8DEF\u5F84\u8BA1\u7B97":r.length>0?"\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4 (".concat(r.filter(function(d){return d.success}).length,"/").concat(r.length," \u79CD\u53EF\u7528)"):"\u8DEF\u7EBF\u9884\u89C8",(l?e:r.length>0)&&!a&&(0,o.jsxs)("div",{className:ne.routeInfo,children:["\u5F53\u524D\u663E\u793A: ",(0,o.jsx)("span",{style:{color:W[u]},className:ne.selectedMode,children:N[u]||u})," \u8DEF\u7EBF",l&&e&&(0,o.jsxs)("span",{className:ne.routeDetails,children:["\u603B\u8DDD\u79BB: ",(e.totalDistance/1e3).toFixed(1),"km | \u603B\u65F6\u95F4: ",Math.ceil(e.totalDuration/60),"\u5206\u949F"]})]})]}),(0,o.jsx)(ja,{planItems:n,completeRoute:e,isSubmitted:l,onImportData:s})]})})},Ta=Ia,La=p(35937),fe={spin:"spin___H6Z9A",detailContainer:"detailContainer___UnJZd",emptyState:"emptyState___GJe_C"},za=function(t){var n=t.loading,r=t.mapLoading,e=t.isSubmitted,l=t.completeRoute,u=t.routes,i=le.Z.useToken(),a=i.token;return n||r||e&&l||!e&&u.length>0?null:(0,o.jsx)("div",{className:fe.emptyState,style:{color:a.colorTextDescription},children:e?"\u8BF7\u9009\u62E9\u81F3\u5C112\u4E2A\u666F\u70B9\u8BA1\u7B97\u8DEF\u5F84":"\u8BF7\u8BBE\u7F6E\u8D77\u70B9\u548C\u7EC8\u70B9\u67E5\u770B\u8DEF\u7EBF"})},Za=za,Ee=p(72504),te=p(60980),De=p(4422),Na=function(t){var n=t.isSubmitted,r=t.loading,e=t.routes,l=t.selectedMode,u=t.routeDrawing,i=t.handleModeChange,a=le.Z.useToken(),c=a.token,s=Ee.Z.Text;return n||r||e.length<=0?null:(0,o.jsxs)(O.Z,{vertical:!0,gap:"small",children:[(0,o.jsx)(s,{strong:!0,style:{fontSize:"13px",marginTop:"8px"},children:"\u51FA\u884C\u65B9\u5F0F\u5BF9\u6BD4\uFF1A"}),(0,o.jsx)(te.Z,{size:"small",dataSource:e,split:!1,renderItem:function(h){return(0,o.jsx)(te.Z.Item,{onClick:function(){return h.success&&!u&&i(h.mode)},style:{background:h.success?l===h.mode?c.colorInfoBg:"#f5f5f5":c.colorErrorBg,border:"none",borderRadius:c.borderRadiusSM,cursor:h.success?"pointer":"not-allowed",opacity:h.success?1:.6,transition:"all 0.3s ease",padding:"6px 12px",marginBottom:"5px",alignItems:"center",boxShadow:l===h.mode?"0 0 0 1px ".concat(W[h.mode],"40"):"none"},children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,o.jsx)(De.Z,{dot:!0,offset:[-2,8],style:{backgroundColor:W[h.mode],boxShadow:l===h.mode&&h.success?"0 0 0 2px ".concat(W[h.mode],"40"):"none",marginRight:8}}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:(0,o.jsxs)(O.Z,{align:"center",gap:8,children:[(0,o.jsxs)(s,{strong:!0,style:{fontSize:c.fontSizeSM,color:l===h.mode&&h.success?W[h.mode]:void 0},children:[N[h.mode],l===h.mode&&h.success]}),h.success?(0,o.jsxs)(s,{type:"secondary",style:{fontSize:"11px"},children:["\u8DDD\u79BB: ",(h.distance/1e3).toFixed(1),"km | \u65F6\u95F4:"," ",Math.ceil(h.duration/60),"\u5206\u949F",h.mode==="transfer"&&" | \u542B\u6362\u4E58"]}):(0,o.jsx)(s,{type:"danger",style:{fontSize:"11px"},children:h.error||"\u8DEF\u7EBF\u4E0D\u53EF\u7528"})]})})]})},h.mode)}})]})},Wa=Na,Oa=p(96761),$a=function(t){var n=t.isSubmitted,r=t.completeRoute,e=t.selectedSegment,l=t.handleSegmentClick,u=le.Z.useToken(),i=u.token,a=Ee.Z.Text;return!n||!r?null:(0,o.jsxs)(O.Z,{vertical:!0,gap:"small",children:[(0,o.jsx)(a,{strong:!0,style:{fontSize:"13px",marginTop:"8px"},children:"\u884C\u7A0B\u8DEF\u7EBF\u8BE6\u60C5:"}),(0,o.jsx)(te.Z,{size:"small",dataSource:r.segments,split:!1,renderItem:function(s){return(0,o.jsx)(te.Z.Item,{onClick:function(){return s.success&&l(s.id)},style:{background:s.success?e===s.id?i.colorInfoBg:"#f5f5f5":i.colorErrorBg,border:"none",borderRadius:i.borderRadiusSM,cursor:s.success?"pointer":"not-allowed",opacity:s.success?1:.6,transition:"all 0.3s ease",padding:"0px 0px 0px 5px",marginBottom:"5px",boxShadow:e===s.id?"0 0 0 1px ".concat(W[s.mode],"40"):"none"},children:(0,o.jsx)(te.Z.Item.Meta,{avatar:(0,o.jsx)(De.Z,{dot:!0,offset:[8,5],style:{backgroundColor:W[s.mode],boxShadow:e===s.id?"0 0 0 2px ".concat(W[s.mode],"40"):"none"}}),title:(0,o.jsxs)(a,{strong:!0,style:{fontSize:i.fontSizeSM,color:e===s.id?W[s.mode]:void 0},children:[s.startPoint.name," \u2192 ",s.endPoint.name,e===s.id]}),description:s.success?(0,o.jsxs)(a,{type:"secondary",style:{fontSize:i.fontSizeSM},children:["\u8DDD\u79BB: ",(s.distance/1e3).toFixed(1),"km | \u65F6\u95F4:"," ",Math.ceil(s.duration/60),"\u5206\u949F | \u65B9\u5F0F:"," ",N[s.mode]]}):(0,o.jsx)(a,{type:"danger",style:{fontSize:i.fontSizeSM},children:s.error})})},s.id)}}),r.segments.some(function(c){return c.success})&&(0,o.jsxs)(Oa.Z,{type:"inner",size:"small",style:{fontSize:i.fontSizeSM,background:i.colorInfoBg,borderColor:i.colorInfoBorder},children:[(0,o.jsx)(a,{style:{fontSize:i.fontSizeSM},strong:!0,children:"\u603B\u8BA1\uFF1A"}),(0,o.jsxs)("span",{children:["\u8DDD\u79BB ",(r.totalDistance/1e3).toFixed(1),"km | \u65F6\u95F4"," ",Math.ceil(r.totalDuration/60),"\u5206\u949F"]})]})]})},Ka=$a,Va=function(t){var n=t.loading,r=t.isSubmitted,e=t.completeRoute,l=t.routes,u=t.selectedMode,i=t.selectedSegment,a=t.routeDrawing,c=t.mapLoading,s=t.handleSegmentClick,d=t.handleModeChange;return n?(0,o.jsxs)("div",{children:[(0,o.jsx)(La.Z,{size:"small",className:fe.spin})," ",r?"\u8BA1\u7B97\u5B8C\u6574\u8DEF\u5F84\u4E2D...":"\u67E5\u8BE2\u591A\u79CD\u51FA\u884C\u65B9\u5F0F\u4E2D..."]}):(0,o.jsxs)("div",{className:fe.detailContainer,children:[(0,o.jsx)(Ka,{isSubmitted:r,completeRoute:e,selectedSegment:i,handleSegmentClick:s}),(0,o.jsx)(Wa,{isSubmitted:r,loading:n,routes:l,selectedMode:u,routeDrawing:a,handleModeChange:d}),(0,o.jsx)(Za,{loading:n,mapLoading:c,isSubmitted:r,completeRoute:e,routes:l})]})},Ha=Va,Ua="c235c1e78c16464f41d866fe4c811c58",Ja="3e3153b7d6dec0cb487d2afde4795453",Ga=function(){return new Promise(function(t,n){if(window.AMap){t();return}window._AMapSecurityConfig={securityJsCode:Ja};var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.defer=!0,r.src="https://webapi.amap.com/maps?v=2.0&key=".concat(Ua),r.onload=function(){console.log("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u6210\u529F"),t()},r.onerror=function(e){console.error("\u9AD8\u5FB7\u5730\u56FE\u811A\u672C\u52A0\u8F7D\u5931\u8D25:",e),n(e)},document.head.appendChild(r)})},Ya=function(t){var n=(0,S.useRef)(null),r=(0,S.useRef)(null),e=(0,S.useRef)(null),l=(0,S.useState)(!0),u=A()(l,2),i=u[0],a=u[1];return(0,S.useEffect)(function(){var c=function(){var s=k()(b()().mark(function d(){var h;return b()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(n.current){v.next=2;break}return v.abrupt("return");case 2:return v.prev=2,v.next=5,Ga();case 5:return h=Re[t]||Re.\u676D\u5DDE,r.current=new window.AMap.Map(n.current,{zoom:t==="\u676D\u5DDE"?4:11,center:h,mapStyle:"amap://styles/normal",showLabel:!0,showBuildingBlock:!0,viewMode:"2D",pitch:0,skyColor:"#ffffff",features:["bg","point","road","building"],resizeEnable:!0,rotateEnable:!0,pitchEnable:!0,zoomEnable:!0,dragEnable:!0,keyboardEnable:!0,doubleClickZoom:!0,scrollWheel:!0,touchZoom:!0,touchZoomCenter:1,animateEnable:!0}),e.current=new aa(r.current),v.prev=8,v.next=11,new Promise(function(m){window.AMap.plugin(["AMap.Scale","AMap.ToolBar","AMap.ControlBar"],function(){window.AMap.Scale&&r.current.addControl(new window.AMap.Scale({position:"LB"})),window.AMap.ToolBar&&r.current.addControl(new window.AMap.ToolBar({locate:!0,position:"LT",direction:!0,autoPosition:!1,locationMarker:!0,useNative:!0})),window.AMap.ControlBar&&r.current.addControl(new window.AMap.ControlBar({position:"RT"})),m()})});case 11:v.next=16;break;case 13:v.prev=13,v.t0=v.catch(8),console.warn("\u5730\u56FE\u63A7\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u4F46\u4E0D\u5F71\u54CD\u4E3B\u8981\u529F\u80FD:",v.t0);case 16:a(!1),v.next=23;break;case 19:v.prev=19,v.t1=v.catch(2),console.error("\u5730\u56FE\u521D\u59CB\u5316\u5931\u8D25:",v.t1),a(!1);case 23:case"end":return v.stop()}},d,null,[[2,19],[8,13]])}));return function(){return s.apply(this,arguments)}}();return c(),function(){r.current&&(r.current.destroy(),r.current=null)}},[t]),{mapContainerRef:n,mapInstanceRef:r,mapLoading:i,routeServiceRef:e}},Xa=function(t,n,r){(0,S.useEffect)(function(){if(!(!t.current||n.length===0)){var e=t.current.getAllOverlays("marker");e.forEach(function(u){t.current.remove(u)});var l=[];n.forEach(function(u,i){if(!(!u.lat||!u.lng)){var a="";if(r&&u.checked){var c=n.filter(function(h){return h.checked}),s=c.findIndex(function(h){return h.id===u.id});a='<div style="background: #1890ff; color: white; padding: 6px 10px; border-radius: 50%; font-size: 14px; font-weight: bold; min-width: 28px; text-align: center;">'.concat(s+1,"</div>")}else u.isStart?a='<div style="background: #52c41a; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u8D77\u70B9</div>':u.isEnd?a='<div style="background: #ff4d4f; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\u7EC8\u70B9</div>':a='<div style="background: #1890ff; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">'.concat(i+1,"</div>");var d=new window.AMap.Marker({position:[u.lng,u.lat],content:a,title:u.name,anchor:"center",offset:new window.AMap.Pixel(0,-15),label:{content:u.name,direction:"top",offset:new window.AMap.Pixel(0,-10),style:{background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"}}});l.push(d),t.current.add(d)}}),l.length>0&&t.current.setFitView(l,!1,[20,20,20,20])}},[t,n,r])},Qa=function(t,n,r,e,l){var u=(0,S.useState)([]),i=A()(u,2),a=i[0],c=i[1],s=(0,S.useState)(null),d=A()(s,2),h=d[0],g=d[1],v=(0,S.useState)(!1),m=A()(v,2),C=m[0],P=m[1];return(0,S.useEffect)(function(){var w=function(){var R=k()(b()().mark(function F(){var D,j,M,L,z;return b()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!t.current||l)){y.next=2;break}return y.abrupt("return");case 2:if(P(!0),y.prev=3,!r){y.next=16;break}if(D=n.filter(function(B){return B.checked}),!(D.length<2)){y.next=9;break}return g(null),y.abrupt("return");case 9:return y.next=11,t.current.calculateCompleteRouteWithModes(D);case 11:j=y.sent,g(j),j.success&&j.segments.length>0&&t.current.drawCompleteRoute(j),y.next=25;break;case 16:if(M=n.find(function(B){return B.isStart}),L=n.find(function(B){return B.isEnd}),!(!M||!L)){y.next=21;break}return c([]),y.abrupt("return");case 21:return y.next=23,t.current.getAllRoutes([M.lng,M.lat],[L.lng,L.lat],e);case 23:z=y.sent,c(z);case 25:y.next=31;break;case 27:y.prev=27,y.t0=y.catch(3),console.error("\u8DEF\u7EBF\u8BA1\u7B97\u5931\u8D25:",y.t0),r?g(null):c([]);case 31:return y.prev=31,P(!1),y.finish(31);case 34:case"end":return y.stop()}},F,null,[[3,27,31,34]])}));return function(){return R.apply(this,arguments)}}();w()},[n,r,e,l,t]),{routes:a,completeRoute:h,loading:C,setRoutes:c,setCompleteRoute:g}},qa=function(t,n,r,e){var l=(0,S.useState)("driving"),u=A()(l,2),i=u[0],a=u[1],c=(0,S.useState)(null),s=A()(c,2),d=s[0],h=s[1],g=(0,S.useState)(!1),v=A()(g,2),m=v[0],C=v[1],P=function(){var R=k()(b()().mark(function F(D){var j,M,L,z;return b()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!t.current||m||e)){y.next=2;break}return y.abrupt("return");case 2:if(j=r.find(function(B){return B.isStart}),M=r.find(function(B){return B.isEnd}),!(!j||!M)){y.next=6;break}return y.abrupt("return");case 6:if(L=n.find(function(B){return B.mode===D}),!(!L||!L.success)){y.next=9;break}return y.abrupt("return");case 9:return C(!0),a(D),y.prev=11,y.next=14,t.current.drawRoute([j.lng,j.lat],[M.lng,M.lat],D);case 14:z=y.sent,z||x.ZP.error("".concat(N[D],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25")),y.next=22;break;case 18:y.prev=18,y.t0=y.catch(11),console.error("\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25:",y.t0),x.ZP.error("".concat(N[D],"\u8DEF\u7EBF\u7ED8\u5236\u5931\u8D25"));case 22:return y.prev=22,C(!1),y.finish(22);case 25:case"end":return y.stop()}},F,null,[[11,18,22,25]])}));return function(D){return R.apply(this,arguments)}}(),w=function(F){if(!t.current){console.error("routeService \u672A\u521D\u59CB\u5316");return}d===F?(h(null),t.current.resetSegmentHighlight()):(h(F),t.current.highlightSegment(F))};return{selectedMode:i,selectedSegment:d,routeDrawing:m,handleModeChange:P,handleSegmentClick:w,setSelectedMode:a}},_a=function(t){var n=t.planItems,r=t.isSubmitted,e=r===void 0?!1:r,l=t.city,u=l===void 0?"\u676D\u5DDE":l,i=t.onImportData,a=Ya(u),c=a.mapContainerRef,s=a.mapInstanceRef,d=a.mapLoading,h=a.routeServiceRef;Xa(s,n,e);var g=Qa(h,n,e,u,d),v=g.routes,m=g.completeRoute,C=g.loading,P=qa(h,v,n,e),w=P.selectedMode,R=P.selectedSegment,F=P.routeDrawing,D=P.handleModeChange,j=P.handleSegmentClick,M=function(z){i==null||i(z)};return(0,o.jsxs)(O.Z,{vertical:!0,style:{height:"100%",overflow:"auto",border:"1px solid #f0f0f0",borderRadius:8},children:[(0,o.jsx)(Ta,{planItems:n,routes:v,completeRoute:m,isSubmitted:e,selectedMode:w,routeDrawing:F,loading:C,mapLoading:d,onImportData:M}),(0,o.jsx)("div",{style:{flex:1,minHeight:"40vh"},children:(0,o.jsx)(Ra,{mapContainerRef:c})}),(0,o.jsx)(Ha,{loading:C,isSubmitted:e,completeRoute:m,routes:v,selectedMode:w,selectedSegment:R,routeDrawing:F,mapLoading:d,handleSegmentClick:j,handleModeChange:D})]})},Me=_a,en=function(t){var n=t.planItems,r=t.setPlanItems,e=t.isSubmitted,l=t.onImportData,u=t.onSubmit,i=t.onEdit;return(0,o.jsxs)(Te.Z,{gutter:[16,16],style:{height:"100%"},children:[(0,o.jsx)(ke.Z,{xs:24,lg:14,style:{height:"100%"},children:(0,o.jsx)(Ca,{items:n,setItems:r,isSubmitted:e,onSubmit:u,onEdit:i})}),(0,o.jsx)(ke.Z,{xs:24,lg:10,style:{height:"100%"},children:(0,o.jsx)(Me,{planItems:n,isSubmitted:e,city:n.length>0?n[0].region:"\u676D\u5DDE",onImportData:l})})]})},an=en,pe={layout:"layout___F0kCh",contentContainer:"contentContainer___G9f2i",content:"content___nGCOl"},nn=p(43559),Q={header:"header___gCFwP",logo:"logo___aO8oL",menu:"menu___n76AM",planInfo:"planInfo___Bb004",clearButton:"clearButton___VhSxa",planCount:"planCount___N3KCR"},tn=p(57705),rn=p(38913),ln=function(t){var n=t.selectedKey,r=t.planItems,e=t.onMenuSelect,l=t.onClearAll,u=function(a){var c=a.key;e(c)};return(0,o.jsxs)(nn.h4,{className:Q.header,children:[(0,o.jsx)("div",{className:Q.logo,children:"\u81EA\u5B9A\u4E49\u65C5\u884C\u8BA1\u5212"}),(0,o.jsx)(tn.Z,{theme:"dark",mode:"horizontal",selectedKeys:[n],onClick:u,items:[{key:"1",label:"\u613F\u671B\u666F\u70B9\u5355"},{key:"2",label:"\u5728\u7EBF\u8BB0\u4E8B\u672C"}],className:Q.menu}),r.length>0&&(0,o.jsxs)("div",{className:Q.planInfo,children:[(0,o.jsxs)("span",{className:Q.planCount,children:["\u5DF2\u4FDD\u5B58 ",r.length," \u4E2A\u666F\u70B9"]}),(0,o.jsx)(V.ZP,{type:"text",size:"small",icon:(0,o.jsx)(rn.Z,{}),onClick:l,className:Q.clearButton,title:"\u6E05\u9664\u6240\u6709\u6570\u636E",children:"\u6E05\u9664"})]})]})},un=ln,me="travel_plan_items",ye="travel_plan_submitted",sn=function(t,n){try{localStorage.setItem(me,JSON.stringify(t)),localStorage.setItem(ye,JSON.stringify(n)),console.log("\u6570\u636E\u5DF2\u4FDD\u5B58\u5230localStorage")}catch(r){console.error("\u4FDD\u5B58\u5230localStorage\u5931\u8D25:",r)}},on=function(){try{var t=localStorage.getItem(me),n=localStorage.getItem(ye),r=t?JSON.parse(t):[],e=n?JSON.parse(n):!1;return console.log("\u4ECElocalStorage\u52A0\u8F7D\u6570\u636E:",{planItems:r.length,isSubmitted:e}),{planItems:r,isSubmitted:e}}catch(l){return console.error("\u4ECElocalStorage\u52A0\u8F7D\u5931\u8D25:",l),{planItems:[],isSubmitted:!1}}},cn=function(){try{localStorage.removeItem(me),localStorage.removeItem(ye),console.log("localStorage\u5DF2\u6E05\u9664")}catch(t){console.error("\u6E05\u9664localStorage\u5931\u8D25:",t)}},dn=function(t,n,r){(0,S.useEffect)(function(){var e=new URLSearchParams(window.location.search),l=e.get("share");if(l)try{var u=JSON.parse(decodeURIComponent(l));if(u.spots&&Array.isArray(u.spots)){var i=u.spots.map(function(a,c){return{id:"shared-".concat(Date.now(),"-").concat(c),name:a.name,location:a.name,region:"\u672A\u77E5",lat:a.lat,lng:a.lng,isStart:c===0,isEnd:c===u.spots.length-1,mode:a.mode||"driving",checked:!0}});t(i),n("2"),r(!0),x.ZP.success("\u5DF2\u5BFC\u5165\u5206\u4EAB\u7684\u884C\u7A0B\u8BA1\u5212"),window.history.replaceState({},document.title,window.location.pathname)}}catch(a){console.error("\u89E3\u6790\u5206\u4EAB\u94FE\u63A5\u5931\u8D25:",a),x.ZP.error("\u5206\u4EAB\u94FE\u63A5\u683C\u5F0F\u4E0D\u6B63\u786E")}},[])},hn=p(92275),vn=p.n(hn),Pn=p(56628);function gn(){var f=(0,S.useState)(""),t=A()(f,2),n=t[0],r=t[1],e={toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]};return(0,o.jsx)(vn(),{theme:"snow",value:n,onChange:r,modules:e,placeholder:"\u5F00\u59CB\u8BB0\u5F55\u4F60\u7684\u65C5\u6E38\u7B14\u8BB0\u5427~"})}var fn=gn,Be=p(49418),oe={label:"label___e_oPN",children:"children___BnC17",collapseItems:"collapseItems___Ohcid"},pn=function(t){var n=t.planItems,r=t.isSubmitted,e=t.activeKeys,l=t.onActiveKeysChange,u=t.onImportData,i=n.length>0?n[0].region:"\u676D\u5DDE",a=[{key:"note",label:(0,o.jsx)("span",{className:oe.label,children:"\u{1F4DD} \u65C5\u884C\u7B14\u8BB0"}),children:(0,o.jsx)(fn,{})},{key:"map",label:(0,o.jsx)("span",{className:oe.label,children:"\u{1F5FA}\uFE0F \u65C5\u884C\u5730\u56FE"}),children:(0,o.jsx)("div",{className:oe.children,children:(0,o.jsx)(Me,{planItems:n,isSubmitted:r,city:i,onImportData:u})})}];return(0,o.jsx)(O.Z,{gap:"middle",vertical:!0,children:(0,o.jsx)(Be.Z,{activeKey:e,onChange:function(s){return l(s)},bordered:!1,expandIconPosition:"end",className:oe.collapseItems,collapsible:"header",children:a.map(function(c){return(0,o.jsx)(Be.Z.Panel,{header:c.label,children:c.children},String(c.key))})})})},mn=pn,yn=Ce.Z.Content,bn=function(){var t=(0,S.useState)([]),n=A()(t,2),r=n[0],e=n[1],l=(0,S.useState)("1"),u=A()(l,2),i=u[0],a=u[1],c=(0,S.useState)(!1),s=A()(c,2),d=s[0],h=s[1],g=(0,S.useState)(["map"]),v=A()(g,2),m=v[0],C=v[1],P=le.Z.useToken(),w=P.token,R=w.colorBgContainer,F=w.borderRadiusLG;dn(e,a,h),(0,S.useEffect)(function(){var y=on();y.planItems.length>0&&(e(y.planItems),h(y.isSubmitted),x.ZP.success("\u5DF2\u6062\u590D ".concat(y.planItems.length," \u4E2A\u666F\u70B9\u7684\u65C5\u884C\u8BA1\u5212")))},[]),(0,S.useEffect)(function(){r.length>0&&sn(r,d)},[r,d]);var D=function(){e([]),h(!1),cn(),x.ZP.success("\u5DF2\u6E05\u9664\u6240\u6709\u6570\u636E")},j=function(B){a(B)},M=function(B){e(B),h(!1),a("2")},L=function(){h(!0)},z=function(){h(!1)},J=function(){switch(i){case"1":return(0,o.jsx)(an,{planItems:r,setPlanItems:e,isSubmitted:d,onSubmit:L,onEdit:z,onImportData:M});case"2":return(0,o.jsx)(mn,{planItems:r,isSubmitted:d,activeKeys:m,onActiveKeysChange:C,onImportData:M});default:return null}};return(0,o.jsxs)(Ce.Z,{className:pe.layout,children:[(0,o.jsx)(un,{selectedKey:i,planItems:r,onMenuSelect:j,onClearAll:D}),(0,o.jsx)(yn,{className:pe.contentContainer,children:(0,o.jsx)("div",{className:pe.content,style:{backgroundColor:R,borderRadius:F},children:J()})})]})},Sn=bn}}]);
